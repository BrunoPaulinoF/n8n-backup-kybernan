{
  "updatedAt": "2025-12-16T10:40:18.108Z",
  "createdAt": "2025-11-26T10:17:15.840Z",
  "id": "xbiM1JT5KjJBCrxu",
  "name": "PRINCIPAL - ARQUIVADOR",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "6ff257a0-6494-492b-af31-5214a9bd20a1",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -4560,
        128
      ],
      "id": "02e65664-256c-4dbb-9aca-7f8cb2fe9832",
      "name": "Webhook",
      "webhookId": "6ff257a0-6494-492b-af31-5214a9bd20a1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "16ffaaef-fe33-426d-a0ff-e2dac2b106e9",
              "leftValue": "={{ $json.body.message.isGroup }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3872,
        144
      ],
      "id": "27f5f0f3-677b-404d-b04a-fd415490c8e0",
      "name": "isGroup",
      "executeOnce": true
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1d8f7b82-de27-4f28-afe4-9f073754da5b",
                    "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                    "rightValue": "ExtendedTextMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ExtendedTextMessage"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8e75be5f-38f7-4db9-8ebe-c2f0e4580de1",
                    "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                    "rightValue": "=Conversation",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Conversation"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                    "rightValue": "AudioMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e9de78c4-def0-4385-92ae-f3d8db4668ef"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "AudioMessage"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6dc571f3-1d8c-4784-8cfa-d29f807666f7",
                    "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                    "rightValue": "ImageMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ImageMessage"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7a88511a-7a3c-442d-bad5-fc9aa48d5a18",
                    "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                    "rightValue": "DocumentMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "DocumentMessage"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -2560,
        64
      ],
      "id": "271e1181-ddcd-4143-a6a6-79e35c53c17b",
      "name": "tipoMsg"
    },
    {
      "parameters": {
        "operation": "rowNotExists",
        "dataTableId": {
          "__rl": true,
          "value": "TvERETBAGi000bZb",
          "mode": "list",
          "cachedResultName": "DadosClienteKybernan",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "IdGroup",
              "keyValue": "={{ $json.body.message.chatid }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -3392,
        -192
      ],
      "id": "e7150fda-84b5-4a1d-ace4-d2d974f070a7",
      "name": "ExisteGrupoTabela False",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "TvERETBAGi000bZb",
          "mode": "list",
          "cachedResultName": "DadosClienteKybernan",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "IdGroup",
              "keyValue": "={{ $('Dados de Entrada').item.json.body.message.chatid }}"
            }
          ]
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -3392,
        16
      ],
      "id": "c4e81850-1e79-4f18-89b6-c46f34c3aaa3",
      "name": "Get row(s)"
    },
    {
      "parameters": {
        "dataTableId": {
          "__rl": true,
          "value": "TvERETBAGi000bZb",
          "mode": "list",
          "cachedResultName": "DadosClienteKybernan",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "IdGroup": "={{ $('Dados de Entrada').item.json.body.message.chatid }}",
            "NomeGrupo": "={{ $('Dados de Entrada').item.json.Nome }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "NomeGrupo",
              "displayName": "NomeGrupo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "IdGroup",
              "displayName": "IdGroup",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "phone1",
              "displayName": "phone1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "phone2",
              "displayName": "phone2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "phone3",
              "displayName": "phone3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Folder",
              "displayName": "Folder",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "apiERP",
              "displayName": "apiERP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "ERP",
              "displayName": "ERP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -3200,
        -192
      ],
      "id": "fbb4a44a-71e6-4f63-a7f9-95e9c4c308e6",
      "name": "Insere Novo Row"
    },
    {
      "parameters": {
        "content": "## BANCO DE DADOS\n\ntratamento de BD para identificar usuário e pasta correta, etc..\n",
        "height": 480,
        "width": 656,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3456,
        -320
      ],
      "id": "e2b4180f-4460-443c-a34d-979ffd64ab8b",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c9d48431-6205-4d71-9d24-346dfe880a25",
              "name": "IdGroup",
              "value": "={{ $json.IdGroup }}",
              "type": "string"
            },
            {
              "id": "46b09227-842e-44df-95f7-4819cc47f958",
              "name": "phone1",
              "value": "={{ $json.phone1 }}",
              "type": "string"
            },
            {
              "id": "91d9c47f-3e9a-4344-86e6-f5124490957f",
              "name": "phone2",
              "value": "={{ $json.phone2 }}",
              "type": "string"
            },
            {
              "id": "0c9bc12c-ca1e-4f6c-ba7b-c33a6fa84fe6",
              "name": "phone3",
              "value": "={{ $json.phone3 }}",
              "type": "string"
            },
            {
              "id": "4b1803fd-3a6e-463d-b63e-8b37605cdc9e",
              "name": "email",
              "value": "={{ $json.email }}",
              "type": "string"
            },
            {
              "id": "a8310a6c-4a6f-4151-878f-edf87ef8f06e",
              "name": "Folder",
              "value": "={{ $json.Folder }}",
              "type": "string"
            },
            {
              "id": "f6f759e7-b7cf-4081-93d3-362cf3b2ffd8",
              "name": "apiERP",
              "value": "={{ $json.apiERP }}",
              "type": "string"
            },
            {
              "id": "61b97bff-04e1-4870-8c6e-0286ac545ed1",
              "name": "ERP",
              "value": "={{ $json.ERP }}",
              "type": "string"
            },
            {
              "id": "630f0159-3b5e-48c4-aa49-4eeb0af3b2de",
              "name": "NomeGrupo",
              "value": "={{ $json.NomeGrupo }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3184,
        16
      ],
      "id": "c7008e17-9448-4747-8b4e-a3e3692e6e56",
      "name": "DADOS USUÁRIO"
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1.1,
      "position": [
        -640,
        1328
      ],
      "id": "1d71cb53-dd9b-475e-9230-5a186ec0a31d",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kybernan.uazapi.com/message/download",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "token",
              "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "id",
              "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            {
              "name": "return_base64",
              "value": "true"
            },
            {
              "name": "generate_mp3",
              "value": "false"
            },
            {
              "name": "transcribe",
              "value": "false"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2080,
        32
      ],
      "id": "023fa18a-cac6-4e2a-8dc2-78bd53dc51be",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64Data",
        "options": {
          "mimeType": "={{ $json.mimetype }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -1872,
        32
      ],
      "id": "2351b7f9-ae4d-456f-a70d-6c9e8c67460b",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kybernan.uazapi.com/message/download",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "token",
              "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "id",
              "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            {
              "name": "return_base64",
              "value": "true"
            },
            {
              "name": "generate_mp3",
              "value": "false"
            },
            {
              "name": "transcribe",
              "value": "false"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2080,
        528
      ],
      "id": "da62ecd9-2e16-42b7-b050-ef61e44eb982",
      "name": "HTTP Request3"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64Data",
        "options": {
          "mimeType": "={{ $json.mimetype }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -1872,
        544
      ],
      "id": "f548f8d3-b350-4c20-a701-1b74efd7c4ff",
      "name": "Convert to File2"
    },
    {
      "parameters": {
        "inputText": "={{ $json.output }}",
        "categories": {
          "categories": [
            {
              "category": "Boletos-Guias",
              "description": "Selecione esta opção se o texto contiver instrumentos de cobrança ou pagamento. Procure por \"Linha digitável\", \"Código de barras\", \"Boleto bancário\", \"Vencimento\", \"Pix copia e cola\", \"qr code\" ou \"Valor do documento\", não precisa ter todas estas informações, são apenas dicas de como entender que é um boleto ou guia. O objetivo principal é classificar boletos bancários ou guias como Boletos-Guias"
            },
            {
              "category": "Nota-Fiscal",
              "description": "Selecione esta opção se o texto contiver dados de uma Nota Fiscal, DANFE, Cupom ou NFS-e. Procure por termos como \"Chave de Acesso\", \"Natureza da Operação\", \"DANFE\", \"Conhecimento de Transporte Eletrônico (CT-e) – Modal Rodoviário\" ou detalhes de produtos e impostos. Marque como verdadeiro mesmo que haja um boleto junto."
            },
            {
              "category": "holerites",
              "description": "HOLERITES "
            },
            {
              "category": "recibos",
              "description": "RECIBOS"
            },
            {
              "category": "comprovantePagamento",
              "description": "comprovante de pagamento de boletos ou comprovantes de agendamento"
            },
            {
              "category": "cheque",
              "description": "CHEQUES"
            },
            {
              "category": "comprovantePixTransferencia",
              "description": "comprovante de transferência ou pix ou comprovante de agendamento de pix e ted"
            },
            {
              "category": "pedidoDeCompra",
              "description": "Pedido de compra"
            },
            {
              "category": "relatórioDiversasContasAPagar",
              "description": "Relatório de contas a pagar, não uma conta específica mas um relatório completo."
            }
          ]
        },
        "options": {
          "multiClass": true,
          "fallback": "other",
          "systemPromptTemplate": "=# Role\nVocê é um classificador especialista em triagem de documentos financeiros e contábeis. Sua prioridade é identificar corretamente instrumentos de cobrança e fiscais.\n\n# Input Analysis\nO texto de entrada é um resumo extraído de documentos via OCR.\nO input pode conter:\n1. Um único documento isolado.\n2. Múltiplos documentos concatenados (ex: Uma Nota Fiscal seguida do seu Boleto bancário).\n\n# Rules for Classification\n\n1. **REGRA DE OURO (BOLETOS):**\n   - Se o texto contiver a frase \"Boleto bancário\", \"Linha digitável\", \"Código de barras\" OU \"Nosso número\", classifique AUTOMATICAMENTE como \"Boletos-Guias\".\n   - **Atenção:** Não exija a presença de \"Pix\" ou \"QR Code\". Se tiver apenas a linha digitável, JÁ É um boleto.\n\n2. **DIFERENÇA CRÍTICA (A PAGAR vs PAGO):**\n   - Se tem \"Vencimento\" e é uma cobrança -> Classifique como \"Boletos-Guias\".\n   - Se tem \"Autenticação\", \"Comprovante de Operação\" ou \"Pagamento efetuado\" -> Classifique como \"comprovantePagamento\".\n\n3. **REGRA DO COMBO (MULTI-CLASS):**\n   - Se o texto contiver dados de Nota Fiscal (DANFE, Chave de acesso) **E** dados de Boleto (Linha digitável), você **DEVE** marcar AMBAS as categorias (\"Nota-Fiscal\" E \"Boletos-Guias\") como verdadeiras.\n   - Não escolha apenas um se os dois existirem no texto.\n\n4. **EVITAR \"OUTROS\":**\n   - Use a categoria \"Outros\" APENAS se o documento for ilegível ou não tiver nenhuma relação com finanças/contabilidade. Na dúvida entre \"Outros\" e \"Boletos-Guias\", escolha \"Boletos-Guias\".\n\n# Step-by-Step Thinking\n1. O texto diz explicitamente \"Tipo de documento: Boleto bancário\"? Se SIM -> Marque \"Boletos-Guias\" imediatamente.\n2. O texto possui uma linha digitável numérica longa? Se SIM -> Marque \"Boletos-Guias\".\n3. O texto possui chave de acesso de 44 dígitos ou diz \"DANFE\"? Se SIM -> Marque \"Nota-Fiscal\".\n4. Verificação final: É apenas um comprovante de que a conta já foi paga (tem autenticação bancária)? Se SIM, classifique como \"comprovantePagamento\" e ignore \"Boletos-Guias\". Se for a conta original para pagar, mantenha \"Boletos-Guias\".\n5. Se o tipo de documento for Boleto bancário, classifique como \"Boletos-Guias\"",
          "enableAutoFixing": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1.1,
      "position": [
        864,
        1120
      ],
      "id": "9e05b0c8-d3f2-49a0-a84c-bace19459f3e",
      "name": "Text Classifier"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cc623d92-90a9-4c53-a977-960b80305e27",
              "name": "text",
              "value": "={{ $json.text || $json['0'].content[0].text || $json['0'].content[0].text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -224,
        1168
      ],
      "id": "4ba8a991-1a84-40c6-aacd-10b6f73f032b",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "name": "arquivo",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0",
          "mode": "list",
          "cachedResultName": "ARQUIVOS RECEBIDOS KYBERNAN TESTE",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -624,
        1120
      ],
      "id": "9bc951fe-d887-4954-b199-363c66a2d85b",
      "name": "Upload file2",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('AI Agent1').item.json.output }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=Analise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE o seguinte JSON:\n\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n1. Em \"NOME_ARQUIVO\", use o número do mês (ex: 01, 02) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n2. Priorize a data de VENCIMENTO encontrada.\n3. Não inclua markdown, apenas o JSON puro.\n4. Exemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico)\n5. Se tiver nota fiscal com boletos, ignore a nota fiscal e extraia os dados apenas dos boletos\n6. Se a data de vencimento for a mesma, não extrair mais de uma vez os dados, extrair 1 vez apenas e neste caso o nome do arquivo coloque \"DD.MM - DIVERSOS FORNECEDORES\" se houver mais de um na mesma data.\n7. Sempre que houver código de barras de um determinado boleto, também extraia o valor, só números, tenha certeza de que está informando o código inteiro e o número está correto.\n\nAnalise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE um ARRAY JSON contendo um ou mais objetos, no seguinte formato.\n\nSe for encontrada apenas UMA data de vencimento/pagamento (indicando um único boleto ou conta), o retorno DEVE ser um array contendo um único objeto.\nSe for encontrada MAIS DE UMA data de vencimento/pagamento (indicando múltiplos boletos ou contas), o retorno DEVE ser um array JSON contendo um objeto para cada boleto/conta individual.\n\nEstrutura do Objeto (dentro do Array):\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS_NUMÉRICO - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n\nEm \"NOME_ARQUIVO\", use o número do mês com dois dígitos (ex: 01, 02, ..., 12) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n\nPriorize a data de VENCIMENTO encontrada.\n\nExemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico).\n\nExemplo de Saída (Múltiplos Boletos):\n[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\nExemplo de Saída (Boleto Único):\n[\n{\n\"DATA\": \"15\",\n\"MES\": \"SET\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"15.09 - AGUA_LIMPA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\n## RULES\n- NUNCA, JAMAIS, erre informações, tenha certeza das datas, dia, mês e ANO\n- Se houver documentos que não sejam boletos ou contas a pagar, ignore, apenas siga com a extração de informações para contas a pagar, boletos, etc...\n- O nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE, utilize este nome para nomear o arquivo."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1696,
        752
      ],
      "id": "fee0a4a4-dc7a-4c9d-8313-2cb40fef7eb0",
      "name": "AI Agent",
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5.1",
          "mode": "list",
          "cachedResultName": "gpt-5.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1680,
        992
      ],
      "id": "2eebaf89-ee86-4e10-afb7-6fd57143d3d4",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1888,
        928
      ],
      "id": "918eadd9-256b-4061-b8cc-0061a3cd26cb",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        0,
        1056
      ],
      "id": "c4438367-3efd-4b04-ae7a-a1dd06e1d31f",
      "name": "Merge1",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1.1,
      "position": [
        -608,
        224
      ],
      "id": "feeecb04-34b4-4e4a-b886-013d8a5c4fce",
      "name": "Extract from File1",
      "alwaysOutputData": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "content": "## Imagem para PDF",
        "height": 304,
        "width": 688,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2160,
        -80
      ],
      "id": "6bd77148-c4c2-4a94-9b49-c1bd6853e36f",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b6a152ef-f1f0-47ca-bd32-db9737dff1ae",
              "leftValue": "={{ $json.Folder }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2944,
        16
      ],
      "id": "4d4f66fe-732f-4ec1-ba67-e849af83f79b",
      "name": "temPasta"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d0250d2a-d792-4061-a12e-e16b7a22cb47",
              "name": "Nome",
              "value": "={{ $json.body.chat.name }}",
              "type": "string"
            },
            {
              "id": "ad1db2aa-736d-4164-9683-87654e150161",
              "name": "body.message.senderName",
              "value": "={{ $json.body.message.senderName }}",
              "type": "string"
            },
            {
              "id": "9c67e34d-811b-4ff2-87ad-6075a508463b",
              "name": "TipoDeMensagem",
              "value": "={{ $json.body.message.messageType }}",
              "type": "string"
            },
            {
              "id": "cb9a1539-beeb-407b-a17d-23985944eed0",
              "name": "body.message.content.URL",
              "value": "={{ $json.body.message.content.URL }}",
              "type": "string"
            },
            {
              "id": "1d589f28-545f-455a-995b-15fe80092f32",
              "name": "body.message.isGroup",
              "value": "={{ $json.body.message.isGroup }}",
              "type": "boolean"
            },
            {
              "id": "2fcecf85-6540-41a7-987f-bd25c45a5a8f",
              "name": "body.message.sender_pn",
              "value": "={{ $json.body.message.sender_pn ? $json.body.message.sender_pn.replace(/[^0-9]/g, '').slice(2) : null }}",
              "type": "string"
            },
            {
              "id": "2d522b05-d083-432a-af3e-292a2baf080a",
              "name": "body.message.text",
              "value": "={{ $json.body.message.text }}",
              "type": "string"
            },
            {
              "id": "4159e7cd-a733-47b5-8a3d-0786c19be8cd",
              "name": "body.message.chatid",
              "value": "={{ $json.body.message.chatid }}",
              "type": "string"
            },
            {
              "id": "b9b4a916-acb6-4032-be80-0bdd78b1033f",
              "name": "body.message.messageid",
              "value": "={{ $json.body.message.messageid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4272,
        128
      ],
      "id": "58174c50-92b5-4c4d-98bc-9adaa7f9448b",
      "name": "Dados de Entrada"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "PEDIDO COMPRA"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        2048
      ],
      "id": "a788e0f5-192b-469f-8839-d77e39419903",
      "name": "PEDIDO COMPRA",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "HOLERITES"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1248
      ],
      "id": "bec0d12d-bb21-4e3a-827f-96a9d72e2783",
      "name": "HOLERITES",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "RECIBOS"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1392
      ],
      "id": "4f58faf7-9116-4eaf-9a0b-d2908cc31675",
      "name": "RECIBOS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "COMPROVANTE PAGAMENTO"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1536
      ],
      "id": "0128b1d7-95e2-4dd8-be43-f97c951e6e64",
      "name": "COMPROVANTE PAGAMENTO",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "CHEQUES"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1712
      ],
      "id": "f6e8c582-1a4d-4cbd-a7f4-d5b8f73075f6",
      "name": "CHEQUES",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "TRANSFERENCIA PIX"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "MOTIVO DO ERRO",
              "displayName": "MOTIVO DO ERRO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CORRIGIDO",
              "displayName": "CORRIGIDO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1872
      ],
      "id": "3eef9de4-a311-4090-b780-1e642fca1f2f",
      "name": "TRANSFERENCIA PIX",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "NÃO IDENTIFICADO"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        2384
      ],
      "id": "1a0c29e1-8240-41e5-a7e4-f0979f4eac02",
      "name": "OUTROS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0ca53349-4a2f-410c-9b0f-d37dbd8379fa",
              "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
              "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "d05a2206-6355-43ae-9547-75bfa0b9be41",
              "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
              "rightValue": "application/vnd.ms-excel",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1632,
        464
      ],
      "id": "7fc622cc-02c9-4fc9-86a5-fea2e1727f78",
      "name": "excel?"
    },
    {
      "parameters": {
        "content": "## É excel?\n",
        "height": 240,
        "width": 624
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2128,
        448
      ],
      "id": "7157356b-c417-48a6-91ba-6df915f79b96",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Excel para PDF\n",
        "height": 288,
        "width": 272,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1200,
        416
      ],
      "id": "9f458b65-0915-4ac1-b27b-39fb7f3e3d9d",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## Puxa o texto e vê quantidade caracteres",
        "height": 304,
        "width": 448
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -656,
        64
      ],
      "id": "c364bf06-b91a-4fd7-82d0-95954a009f45",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {
          "includeBinaries": true
        }
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -592,
        752
      ],
      "id": "23d5b8ff-9511-48fe-9440-c67dc1dfc963",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "content": "## ARQUIVO PDF FINAL",
        "height": 224,
        "width": 400
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -656,
        688
      ],
      "id": "87ac175d-99db-461d-82d5-f2a376386816",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kybernan.uazapi.com/message/download",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "token",
              "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "id",
              "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            {
              "name": "return_base64",
              "value": "true"
            },
            {
              "name": "generate_mp3",
              "value": "false"
            },
            {
              "name": "transcribe",
              "value": "false"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -592,
        464
      ],
      "id": "deff2226-0703-40bb-b934-2c8334254ec5",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64Data",
        "options": {
          "mimeType": "={{ $json.mimetype }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -384,
        464
      ],
      "id": "c3e60bc5-4d76-47b7-a178-b15e257b837c",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "content": "## PDF com padrão OCR",
        "height": 224,
        "width": 672
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -656,
        400
      ],
      "id": "f250a6f8-4a7f-4e30-8601-34eec3ff019c",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "## Junta texto, arquivo e dados",
        "height": 528,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -704,
        992
      ],
      "id": "bbbacf82-a592-42d0-bb59-d43ce181a372",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "content": "## Classificador",
        "height": 1504,
        "width": 752
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        816,
        1040
      ],
      "id": "65f438e5-747a-4e11-a0a6-0b3f8dab987f",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "content": "## Boletos",
        "height": 544,
        "width": 1184
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1632,
        640
      ],
      "id": "a04f1d7a-762b-4f4f-9010-783f4131bd8d",
      "name": "Sticky Note10"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1888,
        1056
      ],
      "id": "d3cd5c1f-6e1a-4a3d-a37b-1849ef108daa",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "output",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2304,
        672
      ],
      "id": "efbc1974-6b5e-4797-9ab2-394a1942c724",
      "name": "Split Out"
    },
    {
      "parameters": {
        "operation": "copy",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Upload file2').item.json.id }}",
          "mode": "id"
        },
        "name": "={{ (new Date()).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }).replace(/\\//g, '.') }} - {{ $('Dados de Entrada').item.json.Nome }} - (SALVADO POR IA)",
        "sameFolder": false,
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "=12JepBiCyidTjZknzUgb8yVOFHZF-Q6Ro",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1888,
        1536
      ],
      "id": "84a0ba27-92bb-4c18-b81d-ab7a3bbaa9ed",
      "name": "Copy file1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2560,
        672
      ],
      "id": "0aea1eea-ccb4-4ac0-a8df-5ff069084138",
      "name": "Merge2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://kybernan_gotenberg:3000/forms/libreoffice/convert",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "landscape",
              "value": "true"
            },
            {
              "parameterType": "formBinaryData",
              "name": "files",
              "inputDataFieldName": "data"
            },
            {
              "name": "addOriginalDocumentAsStream",
              "value": "false"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1104,
        528
      ],
      "id": "1a00927b-11cf-44c2-9d1c-da346e0bc0ec",
      "name": "HTTP Request5"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4O"
        },
        "text": "Transcreva o que tem nesta imagem, tudo o que exatamente está escrito nela de forma organizada.",
        "inputType": "base64",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -336,
        1664
      ],
      "id": "ece7a3fb-81d7-497f-b483-f69cac4c79a1",
      "name": "Analyze image",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "content": "## Se fizer OCR e tiver sem texto",
        "height": 208,
        "width": 528
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -720,
        1600
      ],
      "id": "91beb6ad-6576-4e6c-914f-1023277a46f0",
      "name": "Sticky Note12"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kybernan.uazapi.com/message/download",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "token",
              "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "id",
              "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            {
              "name": "return_base64",
              "value": "true"
            },
            {
              "name": "generate_mp3",
              "value": "false"
            },
            {
              "name": "transcribe",
              "value": "false"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -688,
        1680
      ],
      "id": "da57fbe7-a982-400e-8874-66b836589420",
      "name": "HTTP Request6"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64Data",
        "options": {
          "mimeType": "={{ $json.mimetype }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -512,
        1680
      ],
      "id": "66f8b565-7646-4207-a74e-1b6bce6054bc",
      "name": "Convert to File4"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "TIPO DE ARQUIVO": "NOTA FISCAL",
            "CAMINHO QUE FOI SALVO": "=PASTA DE NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        1104
      ],
      "id": "663cb474-45c6-4261-9f2c-a58136864172",
      "name": "NOTA FISCAL",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
              "leftValue": "={{ Number($json.text.length) }}",
              "rightValue": 20,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -416,
        112
      ],
      "id": "04f93ae5-335a-4881-b2b2-74007cddfc3d",
      "name": "Menos que 20 caracteres"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
              "leftValue": "={{ Number($json.text.length) }}",
              "rightValue": 20,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -496,
        1344
      ],
      "id": "2b625636-5b90-42e9-95de-072ff02a2623",
      "name": "Menos que 20 caracteres1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -3840,
        704
      ],
      "id": "acddbb94-728b-4409-a75f-1097a677dfad",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "TvERETBAGi000bZb",
          "mode": "list",
          "cachedResultName": "DadosClienteKybernan",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "IdGroup",
              "keyValue": "={{ $('Dados de Entrada').item.json.body.message.chatid }}"
            },
            {
              "keyName": "phone1",
              "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
            },
            {
              "keyName": "phone2",
              "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
            },
            {
              "keyName": "phone3",
              "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
            }
          ]
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -3632,
        736
      ],
      "id": "6465a5b5-be23-4e89-8776-4a474aa9a1f6",
      "name": "Get row(s)1",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "jsCode": "// O código deve retornar um array de itens.\n// Como precisamos de 2 saídas, retornaremos um array com 2 objetos de item.\n\n// 1. Obter o número de telefone de entrada\n// A entrada está no formato do primeiro item (index 0)\nconst numeroCompleto = $input.first().json.body.message.sender_pn;\n\n// 2. Definir o DDD (os primeiros 2 dígitos)\nconst ddd = numeroCompleto.substring(0, 2);\n\n// 3. Definir o número original sem o DDD\nconst numeroSemDdd = numeroCompleto.substring(2);\n\n// 4. Inicializar as variáveis para as saídas\nlet numero10Digitos;\nlet numero11Digitos;\n\n// 5. Normalizar o número\nif (numeroSemDdd.length === 8) {\n    // Caso de entrada com 10 dígitos (Ex: 1188888888)\n    // Saída de 10 dígitos: Mantém como está\n    numero10Digitos = ddd + numeroSemDdd;\n    \n    // Saída de 11 dígitos: Adiciona o '9' após o DDD\n    numero11Digitos = ddd + '9' + numeroSemDdd;\n    \n} else if (numeroSemDdd.length === 9) {\n    // Caso de entrada com 11 dígitos (Ex: 11988888888)\n    // Saída de 11 dígitos: Mantém como está\n    numero11Digitos = ddd + numeroSemDdd;\n    \n    // Saída de 10 dígitos: Remove o primeiro dígito do número (que deve ser o '9')\n    // Usamos `slice(1)` para remover o primeiro caractere da string.\n    const numeroSemNove = numeroSemDdd.slice(1);\n    numero10Digitos = ddd + numeroSemNove;\n    \n} else {\n    // Caso de erro ou formato inesperado\n    console.error(\"Número de telefone com formato inesperado:\", numeroCompleto);\n    // Para evitar que o workflow pare, vamos apenas usar o número original em ambas as saídas\n    numero10Digitos = numeroCompleto;\n    numero11Digitos = numeroCompleto;\n}\n\n// 6. Criar os dois itens de output\nconst outputItem1 = {\n    json: {\n        telefone_10_digitos: numero10Digitos\n    }\n};\n\nconst outputItem2 = {\n    json: {\n        telefone_11_digitos: numero11Digitos\n    }\n};\n\n// 7. Retornar o array de itens\nreturn [outputItem1, outputItem2];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3840,
        480
      ],
      "id": "939bacb5-4fc1-408b-8b14-e76b13dea785",
      "name": "normalizaNumero"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "7fa82878-e3a3-4b6f-9533-8352ea7d4ea0",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3456,
        736
      ],
      "id": "038c3e36-bc0f-4db3-9170-cec274ccad28",
      "name": "seNumeroExisteSegue"
    },
    {
      "parameters": {
        "content": "## Normaliza numero 10 ou 11 digitos, tenta encontrar com ambos no banco de dados",
        "height": 560,
        "width": 592
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3904,
        384
      ],
      "id": "5e686850-6293-41e6-8d9b-12f758a69e63",
      "name": "Sticky Note11"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        880,
        1600
      ],
      "id": "3beb4822-f5df-4b4d-841d-6041c9035b66",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a5fc9645-25d9-4077-988f-beeb8aff47c3",
              "leftValue": "={{ $json.body.message.sender_pn }}",
              "rightValue": "19989413439",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4048,
        128
      ],
      "id": "f1cd29ad-a0f3-47e8-833b-d28f3e96aee8",
      "name": "Ana?"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -3824,
        -16
      ],
      "id": "df4684bc-bee0-4a97-b224-5c276aa4054e",
      "name": "No Operation, do nothing1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0ca53349-4a2f-410c-9b0f-d37dbd8379fa",
              "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
              "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "d05a2206-6355-43ae-9547-75bfa0b9be41",
              "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
              "rightValue": "application/vnd.ms-excel",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -176,
        464
      ],
      "id": "053e7e9a-37b9-49a8-b3c0-d8332cb3acc7",
      "name": "excel?2"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.text }}",
        "needsFallback": true,
        "options": {
          "systemMessage": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber informações de algum tipo de documento financeiro, ou mais de 1 documento também, às vezes informações de vários documentos.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1 com o tipo de documento e informações relevantes\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar\n- Apenas informações mais relevantes, resumindo bastante seu output\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        272,
        1232
      ],
      "id": "4185f616-8791-4940-802b-ee2b065c6de0",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        272,
        1600
      ],
      "id": "8ba80996-7f66-470e-8032-3e7302e09683",
      "name": "OpenAI Chat Model3",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "RELATÓRIO CONTAS A PAGAR"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1376,
        2224
      ],
      "id": "a49ceb32-0d18-4e93-b1b8-cc1a997a770f",
      "name": "RELATÓRIO CONTAS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4O"
        },
        "text": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber uma imagem de algum tipo de documento financeiro ou talvez mais de 1 documento.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1 mesmo.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1, com o tipo de documento e informações relevantes.\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar.\n- Apenas informações mais relevantes, resumindo bastante seu output.\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Antes de gerar o output tenha certeza de que está passando todas informações corretamente, sem errar os números e informações.\n- Se houver uma folha em cima de outra, foque em passar as informações principais do documento que está por cima\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE.",
        "inputType": "base64",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -1616,
        -16
      ],
      "id": "a61bf8f4-a258-4ce8-8079-974cef3fb1db",
      "name": "Analyze image1",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "MV2sF6k5w8fkmTQI",
          "mode": "list",
          "cachedResultUrl": "/workflow/MV2sF6k5w8fkmTQI",
          "cachedResultName": "Faz OCR Arquivador"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
          },
          "matchingColumns": [
            "body_message_messageid"
          ],
          "schema": [
            {
              "id": "body_message_messageid",
              "displayName": "body_message_messageid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        160,
        -96
      ],
      "name": "Call Faz OCR Arquivador",
      "id": "047e48c8-4558-4ead-972f-923934f01796"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "cD9AOYpxNXPlrKl1",
          "mode": "list",
          "cachedResultUrl": "/workflow/cD9AOYpxNXPlrKl1",
          "cachedResultName": "Arquiva Boletos Loop"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "NomeGrupo": "={{ $json.NomeGrupo }}",
            "id": "={{ $('Upload file2').item.json.id }}",
            "DATA": "={{ $('AI Agent').item.json.output[0].DATA }}",
            "MES": "={{ $('AI Agent').item.json.output[0].MES }}",
            "ANO": "={{ $('AI Agent').item.json.output[0].ANO }}",
            "NOME_ARQUIVO": "={{ $('AI Agent').item.json.output[0].NOME_ARQUIVO }}",
            "CODIGO_BARRAS": "={{ $('AI Agent').item.json.output[0].CODIGO_BARRAS }}",
            "folder": "={{ $('Merge1').item.json.Folder }}"
          },
          "matchingColumns": [
            "NomeGrupo",
            "id"
          ],
          "schema": [
            {
              "id": "NomeGrupo",
              "displayName": "NomeGrupo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "MES",
              "displayName": "MES",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "ANO",
              "displayName": "ANO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "NOME_ARQUIVO",
              "displayName": "NOME_ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "CODIGO_BARRAS",
              "displayName": "CODIGO_BARRAS",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "folder",
              "displayName": "folder",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        2560,
        976
      ],
      "name": "Call Arquiva Boletos Loop",
      "id": "1d1caef0-46d6-40dc-a7b2-c2c6c5b60412"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "769b83ae-27f6-4bf0-a0c6-325e4cede6a7",
              "leftValue": "={{ $json.output[0].NOME_ARQUIVO }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "9362c41a-d7ff-4d67-9ae7-96c96be110a5",
              "leftValue": "={{ $json.output[0].ANO }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "ed9159ef-edf9-4379-a7d0-efaa2cb8f7c8",
              "leftValue": "={{ $json.output[0].MES }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "4ea17b1c-be7a-4ea3-baa1-1f8d74731ca3",
              "leftValue": "={{ $json.output[0].DATA }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2048,
        752
      ],
      "id": "94a4cbaa-eb2a-4f9c-995f-db50eea742ba",
      "name": "tem output?"
    },
    {
      "parameters": {
        "chatId": "5399986688",
        "text": "Desbloqueado com sucesso!",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        496,
        128
      ],
      "id": "392bc405-3f88-42b0-b80d-c04b3605b0e0",
      "name": "Send a text message1",
      "webhookId": "4b07c559-b2d5-4e8c-beff-8a10997611a0",
      "credentials": {
        "telegramApi": {
          "id": "ZgkuVjgKskJsBz1a",
          "name": "PASSWORD PDF"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "kbfwJBar3KrSSjmM",
          "mode": "list",
          "cachedResultUrl": "/workflow/kbfwJBar3KrSSjmM",
          "cachedResultName": "UNLOCK PASSWORD"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "body_message_senderName": "={{ $('Dados de Entrada').item.json.body.message.senderName }}",
            "Nome": "={{ $('Dados de Entrada').item.json.Nome }}",
            "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}",
            "senha": "={{ $json.data.text }}"
          },
          "matchingColumns": [
            "body_message_senderName",
            "Nome",
            "body_message_messageid"
          ],
          "schema": [
            {
              "id": "body_message_senderName",
              "displayName": "body_message_senderName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Nome",
              "displayName": "Nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "body_message_messageid",
              "displayName": "body_message_messageid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "senha",
              "displayName": "senha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        160,
        128
      ],
      "name": "Call UNLOCK PASSWORD",
      "id": "e1d1bd3e-7cb1-4063-b8d8-2d07ea99729c"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "chatId": "5399986688",
        "message": "=PDF com senha.\nDados:\n{{ $('Dados de Entrada').item.json.Nome }}\n{{ $('Dados de Entrada').item.json.body.message.senderName }}\n\n\nDigite a senha do PDF: ",
        "responseType": "freeText",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -80,
        128
      ],
      "id": "3a95ee4d-8b04-4c81-bff5-1975e7193d22",
      "name": "Send a text message",
      "webhookId": "238ca806-a5e4-4c8d-ae35-be35bfc59f14",
      "credentials": {
        "telegramApi": {
          "id": "ZgkuVjgKskJsBz1a",
          "name": "PASSWORD PDF"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "MV2sF6k5w8fkmTQI",
          "mode": "list",
          "cachedResultUrl": "/workflow/MV2sF6k5w8fkmTQI",
          "cachedResultName": "Faz OCR Arquivador"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
          },
          "matchingColumns": [
            "body_message_messageid"
          ],
          "schema": [
            {
              "id": "body_message_messageid",
              "displayName": "body_message_messageid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        -1520,
        240
      ],
      "name": "Call Faz OCR Arquivador1",
      "id": "d7b7325f-ab0f-4188-9678-b11715664e8c"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        160,
        1504
      ],
      "id": "5e7461cb-b08d-45c1-aea3-63668677a60d",
      "name": "OpenAI Chat Model4",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-image-sharp.imageSharp",
      "typeVersion": 1,
      "position": [
        -1840,
        -240
      ],
      "id": "8e5ff5ef-3bbc-4b95-bb69-e2f6821fd9ec",
      "name": "Image Sharp"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d0250d2a-d792-4061-a12e-e16b7a22cb47",
              "name": "Nome",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.from.first_name }} {{ $('BOT TESTE ARQUIVADOR').item.json.message.from.last_name }}",
              "type": "string"
            },
            {
              "id": "47ead40f-6450-40a6-affb-d998425b9118",
              "name": "message.message_id",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.message_id }}",
              "type": "number"
            },
            {
              "id": "fb2cff36-aa7c-4398-a400-366a5e1f9099",
              "name": "message.chat.id",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.chat.id }}",
              "type": "number"
            },
            {
              "id": "583cbd21-05ff-4dd4-849d-c947ce14efd5",
              "name": "message.document.mime_type",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data.mimeType }}",
              "type": "string"
            },
            {
              "id": "4d13bc24-8df5-475e-ae61-3f71e1d2c069",
              "name": "message.document.file_id",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.document.file_id }}",
              "type": "string"
            },
            {
              "id": "4cc13bd2-bd80-4855-8336-9b145c8b40d6",
              "name": "message.from.username",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.from.username }}",
              "type": "string"
            },
            {
              "id": "9c9fbbc3-dab9-49b6-b99f-4ac58dd0f593",
              "name": "message.text",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.text }}",
              "type": "string"
            },
            {
              "id": "468a70be-342a-4125-b609-8fb343157279",
              "name": "message.date",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.date }}",
              "type": "number"
            },
            {
              "id": "2de623e7-3c1d-418a-b50d-ee7e21baa13a",
              "name": "message.photo[0].file_id",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.photo[0].file_id }}",
              "type": "string"
            },
            {
              "id": "98f2627b-8233-44e8-86af-5ff5ba56ad41",
              "name": "idPasta",
              "value": "={{ $json.idPasta }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4096,
        -2048
      ],
      "id": "04b1e88d-7c5d-4562-b11c-57ceb1df3fb0",
      "name": "Dados de Entrada1",
      "executeOnce": true
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {
          "download": true
        }
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -4704,
        -2048
      ],
      "id": "03d0f711-1600-4118-a52d-71778ed8772a",
      "name": "BOT TESTE ARQUIVADOR",
      "webhookId": "f4d5e926-d817-4752-8352-ad09d45ae25c",
      "credentials": {
        "telegramApi": {
          "id": "hrz1IfYY7JE7R1Pj",
          "name": "ARQUIVADOR KYBERNAN"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "TvERETBAGi000bZb",
          "mode": "list",
          "cachedResultName": "DadosClienteKybernan",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "Folder",
              "keyValue": "={{ $json.idPasta }}"
            }
          ]
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -3680,
        -2048
      ],
      "id": "435c85b2-ede6-4d73-86fd-1c39e5061a20",
      "name": "Get row(s)2",
      "executeOnce": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c9d48431-6205-4d71-9d24-346dfe880a25",
              "name": "IdGroup",
              "value": "={{ $json.IdGroup }}",
              "type": "string"
            },
            {
              "id": "46b09227-842e-44df-95f7-4819cc47f958",
              "name": "phone1",
              "value": "={{ $json.phone1 }}",
              "type": "string"
            },
            {
              "id": "91d9c47f-3e9a-4344-86e6-f5124490957f",
              "name": "phone2",
              "value": "={{ $json.phone2 }}",
              "type": "string"
            },
            {
              "id": "0c9bc12c-ca1e-4f6c-ba7b-c33a6fa84fe6",
              "name": "phone3",
              "value": "={{ $json.phone3 }}",
              "type": "string"
            },
            {
              "id": "4b1803fd-3a6e-463d-b63e-8b37605cdc9e",
              "name": "email",
              "value": "={{ $json.email }}",
              "type": "string"
            },
            {
              "id": "a8310a6c-4a6f-4151-878f-edf87ef8f06e",
              "name": "Folder",
              "value": "={{ $json.Folder }}",
              "type": "string"
            },
            {
              "id": "f6f759e7-b7cf-4081-93d3-362cf3b2ffd8",
              "name": "apiERP",
              "value": "={{ $json.apiERP }}",
              "type": "string"
            },
            {
              "id": "61b97bff-04e1-4870-8c6e-0286ac545ed1",
              "name": "ERP",
              "value": "={{ $json.ERP }}",
              "type": "string"
            },
            {
              "id": "630f0159-3b5e-48c4-aa49-4eeb0af3b2de",
              "name": "NomeGrupo",
              "value": "={{ $json.NomeGrupo }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3312,
        -2048
      ],
      "id": "25f4cd3a-74c1-4b9e-9dcf-cea692b12689",
      "name": "DADOS USUÁRIO1",
      "executeOnce": true
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6dc571f3-1d8c-4784-8cfa-d29f807666f7",
                    "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PDF"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0136ec3e-63c4-40cb-ad13-4d36e1378ccf",
                    "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                    "rightValue": "=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "EXCEL"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7a88511a-7a3c-442d-bad5-fc9aa48d5a18",
                    "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                    "rightValue": "image/jpeg",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "IMAGEM"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -2944,
        -2064
      ],
      "id": "409019de-24a8-4d4f-87d7-902365f6f4ca",
      "name": "tipoMsg1",
      "executeOnce": true
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4O"
        },
        "text": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber uma imagem de algum tipo de documento financeiro ou talvez mais de 1 documento.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1 mesmo.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1, com o tipo de documento e informações relevantes.\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar.\n- Apenas informações mais relevantes, resumindo bastante seu output.\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Antes de gerar o output tenha certeza de que está passando todas informações corretamente, sem errar os números e informações.\n- Se houver uma folha em cima de outra, foque em passar as informações principais do documento que está por cima\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE.",
        "inputType": "base64",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -2096,
        -1872
      ],
      "id": "f1566b25-029c-48c3-8a6c-c2f57bfd789c",
      "name": "Analyze image2",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
              "name": "data",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
              "type": "binary"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2688,
        -1904
      ],
      "id": "c211f6e7-b1ed-4aa7-b862-29c3d6f8689e",
      "name": "Binario"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cc623d92-90a9-4c53-a977-960b80305e27",
              "name": "text",
              "value": "={{ $json.text || $json['0'].content[0].text || $json['0'].content[0].text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -816,
        -2048
      ],
      "id": "b86fd792-bd33-448c-adb1-4b004320a0dd",
      "name": "Edit Fields1",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1.1,
      "position": [
        -2320,
        -2528
      ],
      "id": "b1ead5dd-3491-400b-864b-cbf942cdf709",
      "name": "Extract from File2",
      "alwaysOutputData": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
              "leftValue": "={{ Number($json.text.length) }}",
              "rightValue": 20,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2176,
        -2688
      ],
      "id": "0d1b1ba9-355c-4e98-a1bf-c23256327f6f",
      "name": "Menos que 20 caracteres2"
    },
    {
      "parameters": {
        "chatId": "5399986688",
        "text": "Desbloqueado com sucesso!",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1296,
        -2512
      ],
      "id": "85da2b66-3a86-48e7-90ad-08d66e61deb5",
      "name": "Send a text message2",
      "webhookId": "4b07c559-b2d5-4e8c-beff-8a10997611a0",
      "credentials": {
        "telegramApi": {
          "id": "ZgkuVjgKskJsBz1a",
          "name": "PASSWORD PDF"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "kbfwJBar3KrSSjmM",
          "mode": "list",
          "cachedResultUrl": "/workflow/kbfwJBar3KrSSjmM",
          "cachedResultName": "UNLOCK PASSWORD"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "body_message_senderName": "={{ $('Dados de Entrada').item.json.body.message.senderName }}",
            "Nome": "={{ $('Dados de Entrada').item.json.Nome }}",
            "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}",
            "senha": "={{ $json.data.text }}"
          },
          "matchingColumns": [
            "body_message_senderName",
            "Nome",
            "body_message_messageid"
          ],
          "schema": [
            {
              "id": "body_message_senderName",
              "displayName": "body_message_senderName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Nome",
              "displayName": "Nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "body_message_messageid",
              "displayName": "body_message_messageid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "senha",
              "displayName": "senha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        -1600,
        -2512
      ],
      "name": "Call UNLOCK PASSWORD1",
      "id": "a5c3fe82-8ea3-40fe-b27f-b0379b8b0264"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "chatId": "5399986688",
        "message": "=PDF com senha.\nDados:\n{{ $('Dados de Entrada').item.json.Nome }}\n{{ $('Dados de Entrada').item.json.body.message.senderName }}\n\n\nDigite a senha do PDF: ",
        "responseType": "freeText",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1936,
        -2512
      ],
      "id": "d6b93091-c0c1-4436-8002-0b81bac4cd97",
      "name": "Send a text message3",
      "webhookId": "238ca806-a5e4-4c8d-ae35-be35bfc59f14",
      "credentials": {
        "telegramApi": {
          "id": "ZgkuVjgKskJsBz1a",
          "name": "PASSWORD PDF"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
              "name": "data",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
              "type": "binary"
            },
            {
              "id": "ebee3920-7f16-4264-9605-5e6066ad1638",
              "name": "",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2688,
        -2368
      ],
      "id": "3afb4290-a96f-427f-8c92-adb665c12c85",
      "name": "Binario1"
    },
    {
      "parameters": {
        "name": "arquivo",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0",
          "mode": "list",
          "cachedResultName": "ARQUIVOS RECEBIDOS KYBERNAN TESTE",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -800,
        -2240
      ],
      "id": "5d0f2870-c467-48d7-a99b-c8fefd4c9004",
      "name": "Upload file",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -320,
        -2144
      ],
      "id": "14b624f1-cd90-4fb3-9709-de52cf17ea41",
      "name": "Merge",
      "executeOnce": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://kybernan_gotenberg:3000/forms/libreoffice/convert",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "landscape",
              "value": "true"
            },
            {
              "parameterType": "formBinaryData",
              "name": "files",
              "inputDataFieldName": "data"
            },
            {
              "name": "addOriginalDocumentAsStream",
              "value": "false"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2480,
        -2224
      ],
      "id": "b4329e90-48fc-4807-bdea-99a156f3f4e2",
      "name": "HTTP Request7"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
              "name": "data",
              "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
              "type": "binary"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2672,
        -2112
      ],
      "id": "24fd2732-8ac3-439e-a7f5-974603230d75",
      "name": "Binario2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.ilovepdf.com/v1/auth",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "public_key",
              "value": "project_public_6e99f304b7b0f32194a219829ae0da16_1TjZUf8d65af7f20c2bb97ef86ef511d10f50"
            },
            {
              "name": "secret_key",
              "value": "secret_key_2b4e29231feda1bacf76a575828fdba7_8l_xca3740dd3253a8b56bbc5e54cd6c1664f"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2016,
        -2960
      ],
      "id": "99bd8f80-58cf-429e-b7ba-0df04fabe7b9",
      "name": "Gerar JWT"
    },
    {
      "parameters": {
        "url": "https://api.ilovepdf.com/v1/start/pdfocr",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $json.token }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1824,
        -2960
      ],
      "id": "4d314f38-57a9-4a86-903a-cf16a457052e",
      "name": "CriaTarefaOcr"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://{{ $json.server }}/v1/upload",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "task",
              "value": "={{ $json.task }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1584,
        -2960
      ],
      "id": "138cb363-35d8-44e3-b865-ee7e9c9d9e2d",
      "name": "UploadPdf"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://{{ $('CriaTarefaOcr').item.json.server }}/v1/process",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"task\": \"{{ $('CriaTarefaOcr').item.json.task }}\",\n  \"tool\": \"pdfocr\",\n  \"files\": [\n    {\n      \"server_filename\": \"{{ $json.server_filename }}\",\n      \"filename\": \"file\"\n    }\n  ],\n  \"ocr_languages\": [\n    \"por\"\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1424,
        -2960
      ],
      "id": "3c779c81-6129-4c3b-9773-9dcf8d7bca93",
      "name": "ProcessPdfToOcr"
    },
    {
      "parameters": {
        "url": "=https://{{ $('CriaTarefaOcr').item.json.server }}/v1/download/{{ $('CriaTarefaOcr').item.json.task }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1184,
        -2960
      ],
      "id": "47bc8f4f-8c4f-4930-b8df-8d1c359e629b",
      "name": "DownloadPdfOcr"
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1.1,
      "position": [
        -1088,
        -2512
      ],
      "id": "b39cd339-7a01-47e7-995f-a6916891951a",
      "name": "Extract from File3"
    },
    {
      "parameters": {
        "inputText": "={{ $json.output }}",
        "categories": {
          "categories": [
            {
              "category": "Boletos-Guias",
              "description": "Selecione esta opção se o texto contiver instrumentos de cobrança ou pagamento. Procure por \"Linha digitável\", \"Código de barras\", \"Boleto bancário\", \"Vencimento\", \"Pix copia e cola\", \"qr code\" ou \"Valor do documento\", não precisa ter todas estas informações, são apenas dicas de como entender que é um boleto ou guia. O objetivo principal é classificar boletos bancários ou guias como Boletos-Guias"
            },
            {
              "category": "Nota-Fiscal",
              "description": "Selecione esta opção se o texto contiver dados de uma Nota Fiscal, DANFE, Cupom ou NFS-e. Procure por termos como \"Chave de Acesso\", \"Natureza da Operação\", \"DANFE\", \"Conhecimento de Transporte Eletrônico (CT-e) – Modal Rodoviário\" ou detalhes de produtos e impostos. Marque como verdadeiro mesmo que haja um boleto junto."
            },
            {
              "category": "holerites",
              "description": "HOLERITES "
            },
            {
              "category": "recibos",
              "description": "RECIBOS"
            },
            {
              "category": "comprovantePagamento",
              "description": "comprovante de pagamento de boletos ou comprovantes de agendamento"
            },
            {
              "category": "cheque",
              "description": "CHEQUES"
            },
            {
              "category": "comprovantePixTransferencia",
              "description": "comprovante de transferência ou pix ou comprovante de agendamento de pix e ted"
            },
            {
              "category": "pedidoDeCompra",
              "description": "Pedido de compra"
            },
            {
              "category": "relatórioDiversasContasAPagar",
              "description": "Relatório de contas a pagar, não uma conta específica mas um relatório completo."
            }
          ]
        },
        "options": {
          "multiClass": true,
          "fallback": "other",
          "systemPromptTemplate": "=# Role\nVocê é um classificador especialista em triagem de documentos financeiros e contábeis. Sua prioridade é identificar corretamente instrumentos de cobrança e fiscais.\n\n# Input Analysis\nO texto de entrada é um resumo extraído de documentos via OCR.\nO input pode conter:\n1. Um único documento isolado.\n2. Múltiplos documentos concatenados (ex: Uma Nota Fiscal seguida do seu Boleto bancário).\n\n# Rules for Classification\n\n1. **REGRA DE OURO (BOLETOS):**\n   - Se o texto contiver a frase \"Boleto bancário\", \"Linha digitável\", \"Código de barras\" OU \"Nosso número\", classifique AUTOMATICAMENTE como \"Boletos-Guias\".\n   - **Atenção:** Não exija a presença de \"Pix\" ou \"QR Code\". Se tiver apenas a linha digitável, JÁ É um boleto.\n\n2. **DIFERENÇA CRÍTICA (A PAGAR vs PAGO):**\n   - Se tem \"Vencimento\" e é uma cobrança -> Classifique como \"Boletos-Guias\".\n   - Se tem \"Autenticação\", \"Comprovante de Operação\" ou \"Pagamento efetuado\" -> Classifique como \"comprovantePagamento\".\n\n3. **REGRA DO COMBO (MULTI-CLASS):**\n   - Se o texto contiver dados de Nota Fiscal (DANFE, Chave de acesso) **E** dados de Boleto (Linha digitável), você **DEVE** marcar AMBAS as categorias (\"Nota-Fiscal\" E \"Boletos-Guias\") como verdadeiras.\n   - Não escolha apenas um se os dois existirem no texto.\n\n4. **EVITAR \"OUTROS\":**\n   - Use a categoria \"Outros\" APENAS se o documento for ilegível ou não tiver nenhuma relação com finanças/contabilidade. Na dúvida entre \"Outros\" e \"Boletos-Guias\", escolha \"Boletos-Guias\".\n\n# Step-by-Step Thinking\n1. O texto diz explicitamente \"Tipo de documento: Boleto bancário\"? Se SIM -> Marque \"Boletos-Guias\" imediatamente.\n2. O texto possui uma linha digitável numérica longa? Se SIM -> Marque \"Boletos-Guias\".\n3. O texto possui chave de acesso de 44 dígitos ou diz \"DANFE\"? Se SIM -> Marque \"Nota-Fiscal\".\n4. Verificação final: É apenas um comprovante de que a conta já foi paga (tem autenticação bancária)? Se SIM, classifique como \"comprovantePagamento\" e ignore \"Boletos-Guias\". Se for a conta original para pagar, mantenha \"Boletos-Guias\".\n5. Se o tipo de documento for Boleto bancário, classifique como \"Boletos-Guias\"",
          "enableAutoFixing": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1.1,
      "position": [
        912,
        -2256
      ],
      "id": "b296af95-37b3-4d5e-b9fa-63310fa6c736",
      "name": "Text Classifier1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('AI Agent3').item.json.output }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=Analise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE o seguinte JSON:\n\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n1. Em \"NOME_ARQUIVO\", use o número do mês (ex: 01, 02) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n2. Priorize a data de VENCIMENTO encontrada.\n3. Não inclua markdown, apenas o JSON puro.\n4. Exemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico)\n5. Se tiver nota fiscal com boletos, ignore a nota fiscal e extraia os dados apenas dos boletos\n6. Se a data de vencimento for a mesma, não extrair mais de uma vez os dados, extrair 1 vez apenas e neste caso o nome do arquivo coloque \"DD.MM - DIVERSOS FORNECEDORES\" se houver mais de um na mesma data.\n7. Sempre que houver código de barras de um determinado boleto, também extraia o valor, só números, tenha certeza de que está informando o código inteiro e o número está correto.\n\nAnalise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE um ARRAY JSON contendo um ou mais objetos, no seguinte formato.\n\nSe for encontrada apenas UMA data de vencimento/pagamento (indicando um único boleto ou conta), o retorno DEVE ser um array contendo um único objeto.\nSe for encontrada MAIS DE UMA data de vencimento/pagamento (indicando múltiplos boletos ou contas), o retorno DEVE ser um array JSON contendo um objeto para cada boleto/conta individual.\n\nEstrutura do Objeto (dentro do Array):\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS_NUMÉRICO - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n\nEm \"NOME_ARQUIVO\", use o número do mês com dois dígitos (ex: 01, 02, ..., 12) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n\nPriorize a data de VENCIMENTO encontrada.\n\nExemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico).\n\nExemplo de Saída (Múltiplos Boletos):\n[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\nExemplo de Saída (Boleto Único):\n[\n{\n\"DATA\": \"15\",\n\"MES\": \"SET\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"15.09 - AGUA_LIMPA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\n## RULES\n- NUNCA, JAMAIS, erre informações, tenha certeza das datas, dia, mês e ANO\n- Se houver documentos que não sejam boletos ou contas a pagar, ignore, apenas siga com a extração de informações para contas a pagar, boletos, etc...\n- O nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE, utilize este nome para nomear o arquivo."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1744,
        -2624
      ],
      "id": "be1b5b8a-3e3a-4d6e-9cca-feab72c0c192",
      "name": "AI Agent2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5.1",
          "mode": "list",
          "cachedResultName": "gpt-5.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1728,
        -2384
      ],
      "id": "d94bd99a-e431-42f8-8b74-8339b81d2313",
      "name": "OpenAI Chat Model5",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1936,
        -2448
      ],
      "id": "0082d95c-4faf-4e8e-af79-c39e48c4b389",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "PEDIDO COMPRA"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1328
      ],
      "id": "66017642-c217-47a0-9449-1ad710946f4d",
      "name": "PEDIDO COMPRA1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "HOLERITES"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -2128
      ],
      "id": "6af268c6-9586-4def-81a7-9df5cfebf552",
      "name": "HOLERITES1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "RECIBOS"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1984
      ],
      "id": "3aa6280f-2b38-4420-9dd5-a5041b9691c5",
      "name": "RECIBOS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "COMPROVANTE PAGAMENTO"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1840
      ],
      "id": "182ee853-59fb-4e8a-aa65-88eaa2a2ee61",
      "name": "COMPROVANTE PAGAMENTO1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "CHEQUES"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1664
      ],
      "id": "547925f2-1675-4e09-a4d7-711521a31fe0",
      "name": "CHEQUES1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "TRANSFERENCIA PIX"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1504
      ],
      "id": "80a3777a-37cf-41a6-8530-ce58bebcbc7f",
      "name": "TRANSFERENCIA PIX1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "NÃO IDENTIFICADO"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -992
      ],
      "id": "ee062d76-1edc-43e2-89cc-5af283d85311",
      "name": "OUTROS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "content": "## Classificador",
        "height": 1504,
        "width": 752
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        656,
        -2336
      ],
      "id": "a2da1b57-17de-4879-926a-6aa60ff9aa58",
      "name": "Sticky Note13"
    },
    {
      "parameters": {
        "content": "## Boletos",
        "height": 544,
        "width": 1184
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1680,
        -2720
      ],
      "id": "be4a5baa-57a8-4955-b0f5-1927cacb1370",
      "name": "Sticky Note14"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1936,
        -2320
      ],
      "id": "6b4578cf-19ac-4da2-a89e-4fc23854e480",
      "name": "OpenAI Chat Model6",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "output",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2416,
        -2640
      ],
      "id": "7b0d448b-63c9-4949-b75f-c38126edb015",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "operation": "copy",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Upload file').item.json.id }}",
          "mode": "id"
        },
        "name": "={{ (new Date()).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }).replace(/\\//g, '.') }} - {{ $('DADOS USUÁRIO1').item.json.NomeGrupo }} - (SALVADO POR IA)",
        "sameFolder": false,
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "=12JepBiCyidTjZknzUgb8yVOFHZF-Q6Ro",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1936,
        -1840
      ],
      "id": "d15684eb-ff05-49a9-8e7f-173f785b9626",
      "name": "Copy file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "TIPO DE ARQUIVO": "NOTA FISCAL",
            "CAMINHO QUE FOI SALVO": "=PASTA DE NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -2272
      ],
      "id": "cdfa1f70-f813-48be-8c3a-3a92fde0b4f6",
      "name": "NOTA FISCAL1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        928,
        -1776
      ],
      "id": "3fc9f299-5408-42b3-a924-5f309f703f16",
      "name": "OpenAI Chat Model7",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.text }}",
        "needsFallback": true,
        "options": {
          "systemMessage": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber informações de algum tipo de documento financeiro, ou mais de 1 documento também, às vezes informações de vários documentos.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1 com o tipo de documento e informações relevantes\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar\n- Apenas informações mais relevantes, resumindo bastante seu output\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        320,
        -2144
      ],
      "id": "2b4946e9-1b0b-4fc8-b683-a02b05c2ff81",
      "name": "AI Agent3",
      "executeOnce": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        320,
        -1776
      ],
      "id": "c5da0635-720c-4797-ac3f-74aedee700b0",
      "name": "OpenAI Chat Model8",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('hh:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
            "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
            "TIPO DE ARQUIVO": "RELATÓRIO CONTAS A PAGAR"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1424,
        -1152
      ],
      "id": "2981dcc0-ba60-40cd-b4cb-606e3b18c8a5",
      "name": "RELATÓRIO CONTAS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "769b83ae-27f6-4bf0-a0c6-325e4cede6a7",
              "leftValue": "={{ $json.output[0].NOME_ARQUIVO }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "9362c41a-d7ff-4d67-9ae7-96c96be110a5",
              "leftValue": "={{ $json.output[0].ANO }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "ed9159ef-edf9-4379-a7d0-efaa2cb8f7c8",
              "leftValue": "={{ $json.output[0].MES }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "4ea17b1c-be7a-4ea3-baa1-1f8d74731ca3",
              "leftValue": "={{ $json.output[0].DATA }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2096,
        -2624
      ],
      "id": "cebe3a51-3379-428c-8168-515c71bf8643",
      "name": "tem output?1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        208,
        -1872
      ],
      "id": "716f729e-f3c6-4332-b844-cc79ef975c56",
      "name": "OpenAI Chat Model9",
      "credentials": {
        "openAiApi": {
          "id": "fRrIyxCKgTlReSWb",
          "name": "Kybernan-Arquivador"
        }
      }
    },
    {
      "parameters": {
        "dataTableId": {
          "__rl": true,
          "value": "hF9yxdAPWHZWy2CV",
          "mode": "list",
          "cachedResultName": "CODIGO DE BARRAS",
          "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/hF9yxdAPWHZWy2CV"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idPasta": "={{ $('idPastaDia').item.json.id }}",
            "codBarras": "={{ $('Loop Over Items').item.json.CODIGO_BARRAS }}",
            "nomeArquivo": "={{ $('Loop Over Items').item.json.NOME_ARQUIVO }} - COMPROVANTE (ARQUIVADO POR IA)"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "codBarras",
              "displayName": "codBarras",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "idPasta",
              "displayName": "idPasta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "nomeArquivo",
              "displayName": "nomeArquivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        6480,
        -2160
      ],
      "id": "cbefdc7c-44d4-4f11-b614-4e573bec1a09",
      "name": "Insert row"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
          "mode": "list",
          "cachedResultName": "LOG ARQUIVOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "DATA": "={{ $today.format('dd-MM-yyyy') }}",
            "HORA": "={{ $now.format('HH:mm') }}",
            "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
            "CAMINHO QUE FOI SALVO": "={{ $('Loop Over Items').item.json.ANO }} -> {{ $('Loop Over Items').item.json.MES }} -> {{ $('Loop Over Items').item.json.DATA }}",
            "LINK ARQUIVO": "=https://drive.google.com/file/d/{{ $json.id }}/view",
            "TIPO DE ARQUIVO": "BOLETO"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "DATA",
              "displayName": "DATA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "HORA",
              "displayName": "HORA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CLIENTE",
              "displayName": "CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TIPO DE ARQUIVO",
              "displayName": "TIPO DE ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LINK ARQUIVO",
              "displayName": "LINK ARQUIVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CAMINHO QUE FOI SALVO",
              "displayName": "CAMINHO QUE FOI SALVO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6256,
        -2176
      ],
      "id": "ef10ba0b-19ff-4f93-9a4a-06cb7ebad86f",
      "name": "log arquivos1",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "vwb992tcodcaklq5",
          "name": "KyberTech"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Loop Over Items').item.json.MES }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('idPastaAno').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "simplifyOutput": true
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        4976,
        -2176
      ],
      "id": "54b2bd79-4928-4e98-ba28-b4f2716c10ef",
      "name": "Cria Pasta Mes",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Loop Over Items').item.json.ANO }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('encontraControle').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "simplifyOutput": true
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        4112,
        -2240
      ],
      "id": "4e5d7e65-7b84-4ef7-b813-3d5969f2ab3e",
      "name": "Cria Pasta Ano",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Loop Over Items').item.json.DATA }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('idPastaMes').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "simplifyOutput": true
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        5856,
        -2192
      ],
      "id": "bbefe2ae-dd1c-4614-b254-0383398945bc",
      "name": "Cria Pasta Dia",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "name contains 'controle'",
        "returnAll": true,
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Dados de Entrada1').item.json.idPasta }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {
          "fields": [
            "id",
            "name"
          ]
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        3392,
        -2384
      ],
      "id": "a88e5964-6b4d-4e81-b709-e510548b5552",
      "name": "encontraControle",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "=name contains '{{ $('Loop Over Items').item.json.ANO }}'",
        "returnAll": true,
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {
          "fields": [
            "id",
            "name"
          ]
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        3680,
        -2384
      ],
      "id": "ecdc2c41-dc9f-45e4-a320-674a5746b50a",
      "name": "encontraAno",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3952,
        -2384
      ],
      "id": "ee4ac024-6782-41c0-85af-a21514dc63c9",
      "name": "PastaDiaExiste?2"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "=name contains '{{ $('Loop Over Items').item.json.MES }}'",
        "returnAll": true,
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {
          "fields": [
            "id",
            "name"
          ]
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        4544,
        -2400
      ],
      "id": "198d285b-e503-4d2f-a19b-630b5a04b273",
      "name": "encontraMês",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4832,
        -2400
      ],
      "id": "1bc971f3-b861-4399-88b1-7c9374f199db",
      "name": "PastaDiaExiste?1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4256,
        -2400
      ],
      "id": "abd5bdc7-b35c-4735-b977-fbee2675e7a4",
      "name": "idPastaAno",
      "executeOnce": true
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3072,
        -2400
      ],
      "id": "2f09c1f7-134e-46e8-8d01-c4f78924d7c9",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "=name contains '{{ $('Loop Over Items').item.json.DATA }}'",
        "returnAll": true,
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {
          "fields": [
            "id",
            "name"
          ]
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        5376,
        -2416
      ],
      "id": "24de48f0-3ee0-4900-ad8c-604a04ee83b5",
      "name": "encontraDia",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5664,
        -2416
      ],
      "id": "5f3022f0-dcbb-4522-8c40-0a24b15c9ce4",
      "name": "PastaDiaExiste?"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        5104,
        -2416
      ],
      "id": "1cf556c2-2030-4e12-96d1-faba52e61a4b",
      "name": "idPastaMes",
      "executeOnce": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        6000,
        -2416
      ],
      "id": "4a8af02a-6dea-4228-bb2f-fed044d33327",
      "name": "idPastaDia",
      "executeOnce": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        3376,
        -2688
      ],
      "id": "5ec946c3-c685-4ef8-8c48-cff4381f783d",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "operation": "copy",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Upload file').item.json.id }}",
          "mode": "id"
        },
        "name": "={{ $('Loop Over Items').item.json.NOME_ARQUIVO }} (ARQUIVADO POR IA)",
        "sameFolder": false,
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        6240,
        -2432
      ],
      "id": "98bf1c10-af63-41be-b880-0a74de955722",
      "name": "Copy file2",
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tHbNUSv81dsDoIWb",
          "name": "Kybernan-BPO"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5728,
        -2192
      ],
      "id": "b60e2b09-2233-4e09-9b1c-8d93813db524",
      "name": "Merge3",
      "executeOnce": true
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        4832,
        -2176
      ],
      "id": "3646a208-ead4-4995-a4ce-4a4ad24fa700",
      "name": "Merge4",
      "executeOnce": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9dade1e0-c87d-48f3-bac9-8c0c8952aa24",
              "name": "idPasta",
              "value": "147ox1Et8WQqYIPsDRdTVBDED2k93md3P",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4416,
        -2048
      ],
      "id": "5145a4ac-0b02-4325-b340-7a3f925b3553",
      "name": "Edit Fields2"
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Dados de Entrada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isGroup": {
      "main": [
        [
          {
            "node": "Get row(s)",
            "type": "main",
            "index": 0
          },
          {
            "node": "ExisteGrupoTabela False",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "normalizaNumero",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "tipoMsg": {
      "main": [
        [],
        [],
        [],
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ExisteGrupoTabela False": {
      "main": [
        [
          {
            "node": "Insere Novo Row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insere Novo Row": {
      "main": [
        [
          {
            "node": "DADOS USUÁRIO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)": {
      "main": [
        [
          {
            "node": "DADOS USUÁRIO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Menos que 20 caracteres1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "Convert to File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "Call Faz OCR Arquivador1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Analyze image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File2": {
      "main": [
        [
          {
            "node": "excel?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Text Classifier": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NOTA FISCAL",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HOLERITES",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RECIBOS",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "COMPROVANTE PAGAMENTO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CHEQUES",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TRANSFERENCIA PIX",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PEDIDO COMPRA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RELATÓRIO CONTAS",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OUTROS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "tem output?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DADOS USUÁRIO": {
      "main": [
        [
          {
            "node": "temPasta",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File1": {
      "main": [
        [
          {
            "node": "Menos que 20 caracteres",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "temPasta": {
      "main": [
        [
          {
            "node": "tipoMsg",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dados de Entrada": {
      "main": [
        [
          {
            "node": "Ana?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file2": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "excel?": {
      "main": [
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "excel?2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Upload file2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Structured Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Copy file1": {
      "main": [
        []
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "Call Arquiva Boletos Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5": {
      "main": [
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "Convert to File4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File4": {
      "main": [
        [
          {
            "node": "Analyze image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NOTA FISCAL": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OUTROS": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HOLERITES": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RECIBOS": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CHEQUES": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PEDIDO COMPRA": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menos que 20 caracteres": {
      "main": [
        [
          {
            "node": "Call Faz OCR Arquivador",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menos que 20 caracteres1": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Get row(s)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)1": {
      "main": [
        [
          {
            "node": "seNumeroExisteSegue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "normalizaNumero": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "seNumeroExisteSegue": {
      "main": [
        [
          {
            "node": "DADOS USUÁRIO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Text Classifier",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Ana?": {
      "main": [
        [
          {
            "node": "No Operation, do nothing1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "isGroup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "excel?2": {
      "main": [
        [],
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Text Classifier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RELATÓRIO CONTAS": {
      "main": [
        [
          {
            "node": "Copy file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TRANSFERENCIA PIX": {
      "main": [
        []
      ]
    },
    "Analyze image1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call Faz OCR Arquivador": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "tem output?": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OUTROS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call UNLOCK PASSWORD": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message": {
      "main": [
        [
          {
            "node": "Call UNLOCK PASSWORD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call Faz OCR Arquivador1": {
      "main": [
        [
          {
            "node": "Upload file2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "BOT TESTE ARQUIVADOR": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dados de Entrada1": {
      "main": [
        [
          {
            "node": "Get row(s)2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)2": {
      "main": [
        [
          {
            "node": "DADOS USUÁRIO1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DADOS USUÁRIO1": {
      "main": [
        [
          {
            "node": "tipoMsg1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "tipoMsg1": {
      "main": [
        [
          {
            "node": "Binario1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Binario2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Binario",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Binario": {
      "main": [
        [
          {
            "node": "Analyze image2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image2": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File2": {
      "main": [
        [
          {
            "node": "Menos que 20 caracteres2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menos que 20 caracteres2": {
      "main": [
        [
          {
            "node": "Gerar JWT",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call UNLOCK PASSWORD1": {
      "main": [
        [
          {
            "node": "Send a text message2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message3": {
      "main": [
        [
          {
            "node": "Call UNLOCK PASSWORD1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Binario1": {
      "main": [
        [
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "HTTP Request7": {
      "main": [
        [
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Binario2": {
      "main": [
        [
          {
            "node": "HTTP Request7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gerar JWT": {
      "main": [
        [
          {
            "node": "CriaTarefaOcr",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CriaTarefaOcr": {
      "main": [
        [
          {
            "node": "UploadPdf",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "UploadPdf": {
      "main": [
        [
          {
            "node": "ProcessPdfToOcr",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ProcessPdfToOcr": {
      "main": [
        [
          {
            "node": "DownloadPdfOcr",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DownloadPdfOcr": {
      "main": [
        [
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract from File3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File3": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message2": {
      "main": [
        [
          {
            "node": "Extract from File3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Text Classifier1": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NOTA FISCAL1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HOLERITES1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RECIBOS1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "COMPROVANTE PAGAMENTO1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CHEQUES1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TRANSFERENCIA PIX1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PEDIDO COMPRA1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RELATÓRIO CONTAS1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OUTROS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "tem output?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "PEDIDO COMPRA1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HOLERITES1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RECIBOS1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CHEQUES1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OUTROS1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "Structured Output Parser1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NOTA FISCAL1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "Text Classifier1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "Text Classifier1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model8": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "RELATÓRIO CONTAS1": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "tem output?1": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OUTROS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model9": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Insert row": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "log arquivos1": {
      "main": [
        [
          {
            "node": "Insert row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cria Pasta Mes": {
      "main": [
        [
          {
            "node": "idPastaMes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cria Pasta Ano": {
      "main": [
        [
          {
            "node": "idPastaAno",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cria Pasta Dia": {
      "main": [
        [
          {
            "node": "idPastaDia",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontraControle": {
      "main": [
        [
          {
            "node": "encontraAno",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontraAno": {
      "main": [
        [
          {
            "node": "PastaDiaExiste?2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PastaDiaExiste?2": {
      "main": [
        [
          {
            "node": "idPastaAno",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cria Pasta Ano",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontraMês": {
      "main": [
        [
          {
            "node": "PastaDiaExiste?1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge4",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "PastaDiaExiste?1": {
      "main": [
        [
          {
            "node": "idPastaMes",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "idPastaAno": {
      "main": [
        [
          {
            "node": "encontraMês",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "encontraControle",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontraDia": {
      "main": [
        [
          {
            "node": "PastaDiaExiste?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PastaDiaExiste?": {
      "main": [
        [
          {
            "node": "idPastaDia",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "idPastaMes": {
      "main": [
        [
          {
            "node": "encontraDia",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "idPastaDia": {
      "main": [
        [
          {
            "node": "Copy file2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Copy file2": {
      "main": [
        [
          {
            "node": "log arquivos1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Cria Pasta Dia",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge4": {
      "main": [
        [
          {
            "node": "Cria Pasta Mes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Dados de Entrada1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "errorWorkflow": "YIG6qfQJNEIBlPcM"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "kybernan-n8n-webhook.qdidmr.easypanel.host",
            "user-agent": "uazapiGO-Webhook/1.0",
            "content-length": "4338",
            "accept-encoding": "gzip",
            "content-type": "application/json",
            "x-forwarded-for": "187.45.178.254",
            "x-forwarded-host": "kybernan-n8n-webhook.qdidmr.easypanel.host",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "e0b582355b26",
            "x-real-ip": "187.45.178.254"
          },
          "params": {},
          "query": {},
          "body": {
            "BaseUrl": "https://kybernan.uazapi.com",
            "EventType": "messages",
            "chat": {
              "chatbot_agentResetMemoryAt": 0,
              "chatbot_disableUntil": 0,
              "chatbot_lastTriggerAt": 0,
              "chatbot_lastTrigger_id": "",
              "id": "r5179105d33b663",
              "image": "",
              "imagePreview": "",
              "lead_assignedAttendant_id": "",
              "lead_email": "",
              "lead_field01": "",
              "lead_field02": "",
              "lead_field03": "",
              "lead_field04": "",
              "lead_field05": "",
              "lead_field06": "",
              "lead_field07": "",
              "lead_field08": "",
              "lead_field09": "",
              "lead_field10": "",
              "lead_field11": "",
              "lead_field12": "",
              "lead_field13": "",
              "lead_field14": "",
              "lead_field15": "",
              "lead_field16": "",
              "lead_field17": "",
              "lead_field18": "",
              "lead_field19": "",
              "lead_field20": "",
              "lead_fullName": "",
              "lead_isTicketOpen": false,
              "lead_kanbanOrder": 0,
              "lead_name": "",
              "lead_notes": "",
              "lead_personalid": "",
              "lead_status": "",
              "lead_tags": [],
              "name": "LELEY FOODS - BPO/KY",
              "owner": "5519995586796",
              "phone": "",
              "wa_archived": false,
              "wa_chatid": "120363401866070546@g.us",
              "wa_chatlid": "",
              "wa_contactName": "",
              "wa_ephemeralExpiration": 0,
              "wa_fastid": "5519995586796:120363401866070546",
              "wa_isBlocked": false,
              "wa_isGroup": true,
              "wa_isGroup_admin": true,
              "wa_isGroup_announce": false,
              "wa_isGroup_community": false,
              "wa_isGroup_member": true,
              "wa_isPinned": false,
              "wa_label": [],
              "wa_lastMessageSender": "137499217248386@lid",
              "wa_lastMessageTextVote": "",
              "wa_lastMessageType": "DocumentMessage",
              "wa_lastMsgTimestamp": 1765404249000,
              "wa_muteEndTime": 0,
              "wa_name": "LELEY FOODS - BPO/KY",
              "wa_unreadCount": 310
            },
            "instanceName": "CelKybernan",
            "message": {
              "buttonOrListid": "",
              "chatid": "120363401866070546@g.us",
              "content": {
                "URL": "https://mmg.whatsapp.net/v/t62.7119-24/596041872_740118915191877_524731919314055991_n.enc?ccb=11-4&oh=01_Q5Aa3QHuxOvcFbIdxRxDQ8v0sPxzRHL4EKEppVAdDgwLsy2zRw&oe=69616C31&_nc_sid=5e03e0&mms3=true",
                "mimetype": "application/pdf",
                "fileSHA256": "YlfPVD4NRHRQo9w5BLt93T2hAo/bPBUCcR4KHsCEdv4=",
                "fileLength": 55347,
                "pageCount": 1,
                "mediaKey": "+DlqEMzk4d4rWwf45rzw4IWLyEcwLMbrjInwh/Ie8+Q=",
                "fileName": "SICOOB_2025_10_12_19_03_59_PIX.pdf",
                "fileEncSHA256": "VxJvfGaO6eIAtJwedvSqOOEdnybnUkUIcai0C44YDKc=",
                "directPath": "/v/t62.7119-24/596041872_740118915191877_524731919314055991_n.enc?ccb=11-4&oh=01_Q5Aa3QHuxOvcFbIdxRxDQ8v0sPxzRHL4EKEppVAdDgwLsy2zRw&oe=69616C31&_nc_sid=5e03e0",
                "mediaKeyTimestamp": 1765404248,
                "thumbnailDirectPath": "/v/t62.36145-24/595398157_837569569063598_3993298840133799711_n.enc?ccb=11-4&oh=01_Q5Aa3QFpL29gJBzxvDsN6N19AY9Jv8GgakMsBQIT4XGwx3-F1Q&oe=696179C9&_nc_sid=5e03e0",
                "thumbnailSHA256": "1G6Z4CcYbZSlZzy9jvba/LzIa0rAKmfB6nNFQWSqfaw=",
                "thumbnailEncSHA256": "Nj0xoVACwsRwT6kJgb1gFmGzKVHSsPaxx+f9dbIW/mw=",
                "JPEGThumbnail": "/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABERERESERMVFRMaHBkcGiYjICAjJjoqLSotKjpYN0A3N0A3WE5fTUhNX06MbmJiboyiiIGIosWwsMX46/j///8BERERERIRExUVExocGRwaJiMgICMmOiotKi0qOlg3QDc3QDdYTl9NSE1fToxuYmJujKKIgYiixbCwxfjr+P/////CABEIAGAAJgMBIgACEQEDEQH/xAAvAAADAQADAAAAAAAAAAAAAAAAAwQCAQUGAQEBAQEAAAAAAAAAAAAAAAABAgAD/9oADAMBAAIQAxAAAADw9E9jDobJlYBtM9PYMz4tRtg5CpnKrYlHrwwA6T2x0sJWxeKADpPXJaxLh6MUAHSeuK1jGdrZ2BPX/8QALxAAAgECBQEGBQUBAAAAAAAAAQIRAAMEEhMzciEQIjFxgZIUQVFh0RVEU5Ghsf/aAAgBAQABPwCrBwwDayseoiKH6VP7iPSr2jqto5tP5ZvGsFutw7Fl7TXMlmAYg+NaTETlw/lNXpVmtlbfiDK1gt1uFIYYH/omtS2end9lFgvzT2itRQOmX2CsFutwpACetW8LadAZMmjgrfXqavWbduAA01g95uJq2CWgRJpkuIJMf2DUmpNYLebiasxnEiRTLZ8cj+jD8Ufhx427vuH4pzbgZAwPzk1g95uJqz0cdY+9M4AGS+QfM07u5OZy3Zg95uJqwJuAQDVyzcYwttRH0prVxBLLAmOzB7zcTVqM4kTR0cveVhxK0+nPcDep7MHvNxNWSQ4hsp+tal4AD4hY86u5m7zXFY/Y9mD3m4mrTZXBo4gmZtLHma1U/gT/AGmdSpAtIPuJrB7zcTSeNHEfRU9RTXg0SiegimYEdFArB7zcTX//xAAYEQADAQEAAAAAAAAAAAAAAAABEBEAMP/aAAgBAgEBPwAuacw//8QAGhEAAgMBAQAAAAAAAAAAAAAAARAAERIxAv/aAAgBAwEBPwB6ozSLLPX67LX/2Q==",
                "thumbnailHeight": 480,
                "thumbnailWidth": 189
              },
              "convertOptions": "",
              "edited": "",
              "fromMe": false,
              "groupName": "LELEY FOODS - BPO/KY",
              "id": "5519995586796:A5FFDC397E47F431502756B61CB53285",
              "isGroup": true,
              "mediaType": "document",
              "messageTimestamp": 1765404249000,
              "messageType": "DocumentMessage",
              "messageid": "A5FFDC397E47F431502756B61CB53285",
              "owner": "5519995586796",
              "quoted": "",
              "reaction": "",
              "sender": "137499217248386@lid",
              "senderName": "Bruno P Ferreira",
              "sender_lid": "137499217248386@lid",
              "sender_pn": "553499969911@s.whatsapp.net",
              "source": "android",
              "status": "",
              "text": "",
              "track_id": "",
              "track_source": "",
              "type": "media",
              "vote": "",
              "wasSentByApi": false
            },
            "owner": "5519995586796",
            "token": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
          },
          "webhookUrl": "https://kybernan-n8n-webhook.qdidmr.easypanel.host/webhook/6ff257a0-6494-492b-af31-5214a9bd20a1",
          "executionMode": "production"
        }
      }
    ],
    "BOT TESTE ARQUIVADOR": [
      {
        "json": {
          "update_id": 875571167,
          "message": {
            "message_id": 15,
            "from": {
              "id": 5399986688,
              "is_bot": false,
              "first_name": "Bruno",
              "last_name": "Ferreira",
              "username": "brunopfer",
              "language_code": "pt-br"
            },
            "chat": {
              "id": 5399986688,
              "first_name": "Bruno",
              "last_name": "Ferreira",
              "username": "brunopfer",
              "type": "private"
            },
            "date": 1765807817,
            "document": {
              "file_name": "arquivo (621).pdf",
              "mime_type": "application/pdf",
              "file_id": "BQACAgEAAxkBAAMPaUAWyVtn7D5lLqlTsZYO8wUwD_UAAgEFAALpywFG_0I4jk14tRc2BA",
              "file_unique_id": "AgADAQUAAunLAUY",
              "file_size": 15260
            }
          }
        },
        "binary": {
          "data": {
            "mimeType": "application/pdf",
            "fileType": "pdf",
            "fileExtension": "pdf",
            "data": "JVBERi0xLjUKJeLjz9MKMyAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA1MC9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDEvTGVuZ3RoIDEyL0JpdHNQZXJDb21wb25lbnQgOD4+c3RyZWFtCnicY2AYjAAAAJYAAQplbmRzdHJlYW0KZW5kb2JqCjQgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgNTAvRmlsdGVyL0ZsYXRlRGVjb2RlL1R5cGUvWE9iamVjdC9XaWR0aCAxL0xlbmd0aCAxMi9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nPv/fzACABPtlWsKZW5kc3RyZWFtCmVuZG9iago1IDAgb2JqCjw8L0NvbG9yU3BhY2UvRGV2aWNlUkdCL1N1YnR5cGUvSW1hZ2UvSGVpZ2h0IDUwL0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggMy9MZW5ndGggMTQvQml0c1BlckNvbXBvbmVudCA4Pj5zdHJlYW0KeJxjYBgFQxsAAAHCAAEKZW5kc3RyZWFtCmVuZG9iago2IDAgb2JqCjw8L0NvbG9yU3BhY2UvRGV2aWNlUkdCL1N1YnR5cGUvSW1hZ2UvSGVpZ2h0IDUwL0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggMy9MZW5ndGggMTQvQml0c1BlckNvbXBvbmVudCA4Pj5zdHJlYW0KeJz7/38UDG0AAO91wE4KZW5kc3RyZWFtCmVuZG9iago4IDAgb2JqCjw8L0NvbG9yU3BhY2UvRGV2aWNlUkdCL1N1YnR5cGUvSW1hZ2UvSGVpZ2h0IDkvRmlsdGVyL0ZsYXRlRGVjb2RlL1R5cGUvWE9iamVjdC9XaWR0aCA3L0xlbmd0aCA1Ni9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nPv////fv3+rq6utra3v3bv3Hwxmz55tDAbIgv+xqaRc8M+fP8SohDsJAuzt7b9+/QoAUnmIvQplbmRzdHJlYW0KZW5kb2JqCjkgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDgvTGVuZ3RoIDEwNi9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nPv79291dbUxDNjb23/9+vX///9///5tbGyEsK9cuQKUys7O/vXr138k8Pv378DAQGtr63v37iGLP3/+3M3NDS7+798/iPjs2bMxzdmxYwfE6mPHjpEhCLELIm5kZARhrFy5EgA2ZJQ2CmVuZHN0cmVhbQplbmRvYmoKMTAgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDgvTGVuZ3RoIDEwOC9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nGWOwQ0AERBFezJuqlCPCpwUoAIqoAEVuE4lgv3JLhH7Ty8vk/9nzi+tNa01EYUQlpu9d2MMpBDi9N57pZRz7rxPKUEyM2D7Wiu4lALOOYNjjOC3FpFS0oq1doyxV9Bz7W5//fn3DzeKlJ8KZW5kc3RyZWFtCmVuZG9iagoxMSAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA5L0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggOC9MZW5ndGggMTIxL0JpdHNQZXJDb21wb25lbnQgOD4+c3RyZWFtCnicXY6xCUAhDER3UitttLF3DkdwAifSCZzA2tYJbBTJDwSC/KuS4+4lANB7F0IopaSUWusxBgDMOb331tq1Fs0xxnNOKQVjOWfM4BpCMMZgpdbK/r03pYRra426zjnkvD7GqMIiDjziu3tvNgmCDxOEmT/CB7nYiLcKZW5kc3RyZWFtCmVuZG9iagoxMiAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA5L0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggOC9MZW5ndGggOTMvQml0c1BlckNvbXBvbmVudCA4Pj5zdHJlYW0KeJy7cuWKMQZYuXLlfyTw+/fvoKAgoPixY8eQxWfPng0UzM7O/vXrF1zw+fPnbm5u1tbW9+7dw1Tc2dmJLIhL8axZszAVXwE7FU3x379/q6urgeIdHR3IigEihp23CmVuZHN0cmVhbQplbmRvYmoKMTMgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDgvTGVuZ3RoIDEwOC9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nHWOQREAIQwDPXEGsIAOHIACNKAAB2AABVjhU4b2MtcPj6OvNJNklpnHGM9xvXcRWWs556y1c85TI2yM8d7DZOYQglZqrRApJfku54y3lNJa+/VveYXBPhHtvWOMun/jQVcroDr5XwsngcEKZW5kc3RyZWFtCmVuZG9iagoxNCAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA5L0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggOC9MZW5ndGggMTE4L0JpdHNQZXJDb21wb25lbnQgOD4+c3RyZWFtCnicZY27DcAgDAV3wnQ0VPTMwQgswA6wAIswATUtE9DwEXFkKbKUV9kn+969b3rvxhgpJQA45+acCGutQogQwmVZa1lrlVKtNc7JACw5Z5J8zr03/uJaSuEcz2KM9EIerfUYA3lKifg5x3tPvXz+V1PvAx7PiHsKZW5kc3RyZWFtCmVuZG9iagoxNSAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA5L0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggNC9MZW5ndGggMTgvQml0c1BlckNvbXBvbmVudCA4Pj5zdHJlYW0KeJz7/x8E/v3795/2AADniWuSCmVuZHN0cmVhbQplbmRvYmoKMTYgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDgvTGVuZ3RoIDEyNC9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nE2OOw0AIQxAPXEjCwvM+MABSEEBDlCAAZhZwQALhPSaNNdcp35eXwsAc06t9fNFKQUAxhjGGCll7/3eG0KgvLWGjHNu741YjJFWzjnWWqXUWot4ZkglhCB/Sgmbf0+tlU/nnJlhP5Z/Hv3ee36VRhh4gp7E5gv3L4D1CmVuZHN0cmVhbQplbmRvYmoKMTcgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDMvTGVuZ3RoIDI4L0JpdHNQZXJDb21wb25lbnQgOD4+c3RyZWFtCnic+/+fIhAYGOjg4PD161cgw97eHsgAAI32R+MKZW5kc3RyZWFtCmVuZG9iagoxOCAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCA5L0ZpbHRlci9GbGF0ZURlY29kZS9UeXBlL1hPYmplY3QvV2lkdGggOC9MZW5ndGggMTA0L0JpdHNQZXJDb21wb25lbnQgOD4+c3RyZWFtCnicfY+xCQAhDEV3MnY2ruAcbmAmcDEnsHYLG2PUQDjw4LhXfd5PAplzhhAAwBhjrZXgve+9E5F4zfvi38ODc661tt/UWj+rtVZKSapSyu2ZGRHVy27O+b4TYxxjaFbkBZUycwCRIpMQCmVuZHN0cmVhbQplbmRvYmoKMTkgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgOS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDgvTGVuZ3RoIDExNS9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nF2OsQ3AIAwEdyIlBVT07ELHBCzGBNS0sAAUgCAvWbFQvrCs87/tWqsx5vmkte69n3NKKc65MQb6lBKNWmvnEjzIKqXA994gVMkfQmAnkR9kzTmttVLKnPPN11ree6RijNjAWbpL//BmSAjB/7+8P5euCmVuZHN0cmVhbQplbmRvYmoKMjAgMCBvYmoKPDwvQ29sb3JTcGFjZS9EZXZpY2VSR0IvU3VidHlwZS9JbWFnZS9IZWlnaHQgMzEvRmlsdGVyL0ZsYXRlRGVjb2RlL1R5cGUvWE9iamVjdC9XaWR0aCAyMzYvTGVuZ3RoIDM4NjMvQml0c1BlckNvbXBvbmVudCA4Pj5zdHJlYW0KeJzdm3uUjdUbx5FbqHRxSQkZoindKNMoRVFMaEI10kWRWXJrpFhlIt3WKqHkUi61iql+yTVSRA2FpCatoqgptyJCiaT5fZbv8qzde86cec9lZs44f5z1znv2++xnP/u7v8/32fudQ4cO5eXl/fPPP57vQ859u963b99vv/1mNw8FPBv4VFA7Plt67vAJvM6vfQQ+uPaDtvFvM5o4RGMzrBiG9WwELfPrK+j9cO2H1X7Lli2zZs3KyMhISUlp3rx5cnJyp06dRo4cuWTJkt27dx8+fDgCB/79998ifkp+Bl5HYy2aZ/PzJ1aWY+tbrKzFyk6IOfWsFFh33Lhx4LZixYply5YtVapUmTJl7PvUU09t06bNokWL/vzzz5i7V0jWCmTaaFg6tt4Wqk0/YymwTeF5GCvLmzZtSktLq1SpkoG2UaNGMHC/fv3g5F69erVu3bp27do1atQYMWLErl27CnVQoVlLq68wmNaPV4Vtv8CxB70uGq+KZew216F7z83Nvfbaa8uVKycAX3bZZVOnTt24cePBgwf/+usvNYZ+16xZM3z48MTExCFDhkhXxITxPMMpmhAVZV/RxKQos4Afz4u4Rz+44vG9e/d27979uOOOk2AYPHjwzz//HMLI2rVr+/Tps27durAYIz/m9NwvrnAVV79+Yli8vhVv737iw2fy5MknnniiAfjrr7+Gb1etWrV48eLs7OwVK1Zw5/vvv9+zZ8+BAwfiZFDx4EMEzOmTVSJrH58xKQJPNm/enJSU5GrgevXq1apV65RTTqlatSrYrlatGn82bNgwOTm5Z8+eEydOXL169c6dO+MqaD5Xaxz6HG/++K87QsfZj53ox75t27ZJkyZRtUkGG4yrVKnCneOPP7506dLly5e3+xIbFStWrF69ert27UaPHr1169a///47biciPr0Kl71LyiiK2DdUgfbQEhISTj75ZGE1LS0NUfHmm2/+7+gHyn3sscfS09Ovv/76884776STThKY1b5ChQpYyMrK+uOPP+I81OGyR/yPJf49jJixfbbfsWPHsGHDpk+f/tlnn6WmpkoJI33zCwUoRQ8jj4cOHdqiRQvtv4mfERuZmZnuHoVZoFScNWvW+vXrI9CNEV/n5OSUoGVVsgAZ5RyFWwv4t5+SkgIazz33XIDtR8PoFK9Vq1bwsMH4+eef97j67bff3nLLLSwN+LzIponkwkAuueQSOx8vufCIf28jY9rCGGPnzp2BYuvWrX///Xf/Xfzyyy8ZGRlSF+jkBg0a/PTTTy6Mb7vtNsnsmTNnxmolhr6zdOlSyk96FIZLKCRKtM/RzG9kz8q9vn37om+vuuoqnSD7DyNSoXfv3lboffjhh25LETWWEdhFMzVvv/22HdBo26REQ6IYPadcWr169QcffLBs2bIff/xRh1xqv2/fvo0bN27YsEHfKExdf/fddzpT4PPDDz/YfU8bkrhP0EKSK1eulA9Gj/lF4NVXXwVpF198MU+FG7ovvvhCJWHlypVXrFhhvzLSK664QgXgO++8E5a2CTpBfvxhsYj5IxtLfAI4YnaKLOZbt26dNGnS1VdfXbduXWb2jDPOaNKkSWZmZm5urloCqnPOOQfBVr9+/caNGyckJNg1ohRaA8B6PGib7t27ayMrxFyAWKQp+KlTp458uOiii5544gnhP6j/X331lRoDyHD3BqnXateurfS9efNm1zg8LFZ89tln0c8TJkxgsXz88cdSLGoJ88+ZM0d134EDB9asWTN79uzly5fz+JdffvnGG28wllGjRk2cOBGSl1z3+CBxPnnyZOwPGjRIPRJ2Vw8TVXp54YUXRo8erb48Rrjz1ltv8Svdvfbaa9S5+/fvd8cCKU2ZMkUN5s6di0F7lqBRGj/33HPjx49fuHDhr7/+GplKjOapWC3VTZs23XrrrdCR9p3sG2bo0aOHJo7qRtutnh1XS38YAXXus+51p06dXFYP9FNllPZ1PV0gGFSqB41Pz549EQNPP/10uAF56aWXypYtS+EGityWrMcrr7xSXdesWbNSpUryqlatWl27diW5yA7I1HgfeOCBRx55hKVKM5Q5+UuVpspGPd6xY0fQ5faSlZXVtGlTescHG7VnQc2fP//SSy+1ZIGp5OTkefPmuYuIZa739IjYCSeccOaZZ3700Ufqhfx4//3368THdhQhE9YIcyqfbU5R46xcrcEYQqvIskBOTo6mgCK9ZcuW2lC1US9evBj7q1atuuGGG4Bi+/btb7zxRnCr0DF24YfIp6WlMfvXXHONjOg1SCO00JH59NNPBYmqVasSzOuuu+6CCy6wrQN+zS9DrVu3rlGjRklJSZp6n2y8YMGCs88++7TTToPnTUurDRg2PWwO2N6ykg52wLBWPUZ0sEK4WrRoAYYFPGpGg58Kz23btmnIpDyh12PfCEH2SWq6SWSAotqT2pR0PvnkE3KQWTj99NP5ZhKhZXoBpffcc48esanEEygdMhk6dKjtMYJ8DUSqbO3atf4zWlxBfcaMGQDv9ddf1+kVOZrhuPDjpv4tQsJYLzpWr16dXw0DWuCkJF28++67AJLIIEJg6QIzjsQMhM9cS5kjQuQDP4WID4kewnzqqadcunb1CeNy75DfAXCzZs2mTp3qvtvm8rBApaMTOLNbt24GVGJFy0WLFuk9DRibn3r16vXiiy++//77RAP+hCH1zsaYMWNE5jyI2JA8qFevntnHeHZ29uDBgw2i6GGMtG3bVrkgPT2dJYw+ufvuu8XtCA/cHjt2rILToEED+lV3DE2ZAtlgyORBhD0Ojxs3DgGDKNKKwO3+/fvTOyKEaMjanXfeaaovmlogttc+F8j27dttQmkAEyrOL7/8stseAN9xxx3KwkyQ+4inlwEDBqhOUcz9eCUf8o7mStVW2h8IPUbwk5iYyFy48f/mm2/atGlDLiDdHz7yhhuSMjU1lfxLJkW95MftLCVNqPYl9KyRM3AVTxqVYY0GgcPRigYVLhsQNIET6Uu1m3dUNogtpYcRHvCDIE2iEXsoVUlvYBlrsiMMywHzASc1fUTAoirSIPWoL+3n6CZLSZgX4cQbx+b5kBNuLzQWhRIB9NXnn39uv+7atQtGstBRKYCToKRKrdGwYUPPIRoVIvyAcUSdyIprGCZofMiJSrh0JLyFYHIYGKp56KGHVNFQYbFwKKwkNZGF3CQF33vvvfLZFeeeCcKC6WHbH+b70UcfFRQ19cBGO8zgSvnX7MC0zzzzzO23346sQlMZ6z788MMsMW0+Y58G1q9cNT2s6kMMj5aWikONiPkFfrSEcK5p6ty5M95qX2737t046Umj1tfNN98sfyxcmhrLFytXrowhi8Zwd8L/UmJ2LrzwQnub0UPCJswUB7Qf5BZo2TId8ddLj3lH3pN0KxS9WtavX79A34A3Klc+SLL6j4k486yzzrLXMgGPad0CxZ4ed3lYZo0/RYPSw24VppYsHxULgVqaYMKHoFo0aBCia+0PS5GCQ5K+7V17KlxRpfZqJIpM9KJskQ2owR07dkDg7hDcQHXo0CEQ3qy7hIQEBRzVUaJ5GP8p6Ewa2X6L8fCwYcNAHfXC+eef70o4d4zAwObR0jEfbQW4MecaU574sCjE4YCEvoK+zxACyWDg8ssvr1GjxrRp05TuBw4c6H9ScN40jLs/7PIw82562MUwjW2HB/7UfpdAa0vppptukp0+ffqYD/Cwuz+sfW/aUKn17t0bYXDfffeRRPr27cv1k08+aTGhcsGsdicE9VGjRjFrcEsgUDUWSnItB0bk5g7tNJIOEMwxZ9GY2PEzg0yZ1i+zQKbz6CgXouRu7c0GPQughtI8gmR3u4BsDqkOHz6cWSCAul6wYIHn2fr164sQmDj971tYtABJMoOkeJS8YCY97N+I6WHV+B5yBnuSW1og4MdO1rR8lNxzcnJc8BuGdbbo2amQHnZJ3mSDarTQYFCRIvfat29P2urSpYu90YecdkeqvWg+iApLkUuWLFGK9KjHksXDaDASk02Twus6xh33uIFQJycnB9030HTDsY8//rj/jRq44pVXXiGGBmA7GghrF52nkpKSUHdYc/VwWDwspkKNMGrEJ0wuxCJBlWqlhz087ElAeMJit9pWGAautiHMKt6wYQP1GjWp0pPel4CKtbXIp0ePHnpvn+DrBTwlR21EcJPG3Onfv798FoaZEdELTo4fPx6Qw0gqPUxsE2r4Hydtc17az7PZWFLATPLSbiRDq1atGlKN8JKG+KZ2wCYx7Nq1a9u2bSdMmLB8+fKFCxfactZZrY2LTGTFjlV8fuKAZRPbXDDjHh9CEJFHDzdr1owJMj0sIep/OoyHGQKY1Oa5S8LuvoRHSxjNgnZUB2UdylzPyg0gqleVSh09mJO3pf67P2zOYw0L9NK0aVPtaasAQekxUwg/VpyOS2QhMzMz78gWojKCNHliYiIdodBmz55NakPn2CGOzCrsVChWxkZz+hb9s+EuHJAmPe85ZTPVlHe0HLOYoNOsVCFtuZIV2aafqC8sVRXoFaWQ5jHQB8KrTTyflO7qYUkajx4ucBW4/yVtxRTuZWRkmLYxPYxucUUXEksbeib7zc6IESMs4O6hpOGZ75YtWyr7aPfMU0HTHsvahX7wwQcDyz1I2MRbdna2LUb7Tk1NZQjr16+3vVOzQF86AYkAQsUuJFBudiKpUxud+OjajuGgIIkNtyhDNrsbXyhe1XqA/L333vMfDZhcB14VKlQwH3SNJxTgIWqBwOuRI0eSwZcuXZqeno5QnDNnTljMQJpGsd91110pKSlUZNAm8NOOk7WXwCDRu9sm+tYxih4nc5G/aElxp3cVbIcEStS/magNtRuKgrXsuoQ0pWSAJazN9OnTxRi5ubm0h407dOgAILt160Yisxpc38wanvBTu3btaEaOUCikuFjj5iSZF8Xi2e0vQWCGuIgn0kj/y0Mho+usrCyuIRazDNoRV4OOfJjlZcuWGS/lHd1mNCMeWRWaRaEyCkO3X9cf/T9FBBnKTQRhrQJd87j+Ido9OvFvR+cO7ulhYBsVXJ6yKzBTAC07xQjsZf+RTwh/7G2lQBDyU2gP4xm67h3rJejecmTXx0AcYq4JQ5e0x0zQYhW3Yykax9JYjr3hHJMjihWTB17/HzLx42YKZW5kc3RyZWFtCmVuZG9iagoyMSAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZUdyYXkvU3VidHlwZS9JbWFnZS9IZWlnaHQgMjEvRmlsdGVyL0ZsYXRlRGVjb2RlL1R5cGUvWE9iamVjdC9XaWR0aCA3MTQvTGVuZ3RoIDE1MC9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nO3WMQ6DMAxA0dz/0q5EoTRtFKQypLbeGyzI5OEL0hpkFIfVi8AtSqYGJVPDlrCSye7ZsJLJLtwuqCCUTAWhZEoQMSUImYz2bOPrBFLpLsXRhExSMbR6K/jBOGZFk9IkZz2TxFHrvGbD+P+xOZ8G1u9oGNNx6t+6s9V/DbjySvZ47o/3llduCHd8fJohrfeSHxq+hbMKZW5kc3RyZWFtCmVuZG9iagoyMiAwIG9iago8PC9Db2xvclNwYWNlL0RldmljZVJHQi9TdWJ0eXBlL0ltYWdlL0hlaWdodCAyMS9GaWx0ZXIvRmxhdGVEZWNvZGUvVHlwZS9YT2JqZWN0L1dpZHRoIDcxNC9TTWFzayAyMSAwIFIvTGVuZ3RoIDU1OS9CaXRzUGVyQ29tcG9uZW50IDg+PnN0cmVhbQp4nO3dMW7CMBjFcUZGrpCRkTFX6MiYK2T0yJqRMSMrY46QtUdg5AqMGekTT/1kiQpaqhKi/n+KUD47pWZ7cuzkfAYAALjjNAyrspx9eluv1TL2oAAAwITVKSlR9BeOGZumGXtQAABgqk7DoCxxOB6jLIplVVXjjgoAAEyXckXf91E6bHBzBAAAPGzfdfl9EIUNRYtVWY44JAAAMGlVVc0Xi91ur1yhpOFS6YK5CwAA8ADFiaJYKksoUThUVBd1SrESAwAA4Ju8EVXHpmmUKDx9oUZ/jj06AAAwPXVKMV/BTAUAAPilvu/jbgjRAgAAXPvpvYxt2xbFcjab5dtRAQAAFCoUD/Zdp0Mnh+PRqyZuhw31tt17ndJut3/aUAEAwFQ4S3g/6bZtdSgz3A4bihY6WLoJAADucsxQrlDA0OGwsWkanTtsuEuNThcOGPknAADAl2I2Q3HCAcMZw+dOHe6NvOFA4sboyidAxv5NAADghTgheHlGZIw6Jb8dtSiWfqaWztXiLj9WSy1+MHjsWvVb2v218dJ2SkpKSkpKyn9YzhcLRQjPReQP5FSW8NZUHW7RZUoUjhM61Kg04j9R+SI/h5KSkpKSkvKvy0gI171+MZmnI/L5B/eehkHtq7L0i9cjP+T/SF/ra9i+CgAAzp/vWJcbO1XjFWZ+MLinOPLrVapr27ZPHDgAAJi2WAiar7vwDZSY3FDv2MMEAAAT48kKr7jw5pHYS+LZjA+EeRU7CmVuZHN0cmVhbQplbmRvYmoKMjMgMCBvYmoKPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0xlbmd0aCA0Njg1Pj5zdHJlYW0KeJztXEuTG8eRvuNX9GEPUqzYU89+0CdwZqylQpyhhiPtYeVDDwak4QAGQwDDdey/tXVQ0BE+KXzxyVVdj67KrmokJK7D4VDoIDQn68v88lld3cD72YvbGSkaQcumKW7vZ5e3s29m72ekJLyWxf/OWPGV+vsfZpQUr2b/8ztS3M94VTREavnNTMq2ZI27XrtrXpVEqEslGnz0Ur+f/ffsYUYL/d/uXQSoPlPGykYOYPA6gHmrDG3aRimA/zewteBlxbWdFXUXa3vBDEgvxQLAQv+nlktZl0wWNWlKbi2zn80iykrao1k5d61BBtnNjDZkWKgvKkZLbkCCj17EOEcHAfjFeRL4eOwVvb4HJ6WU1gJ7YSyQbVXamAQfvcinscA7sifXauf0ppS1dNfr2DmxF94CYb84ouI8GAEFi70TQoKB50MMu2xQyGlTymqwltO6bGgUTWNgoDde4zEG3QbDRx5ABhDZ+Ble0XpIIVobejuyF2AZ3dYea77g1FSBhRBcAQchc2wD8+MlHsIzMBBOKQAMAIbQOY7ehdY/IUKCBAQI4hhbDQCNDcYsy8E3gzYueofgOQc0rIy3wtnp3WBZGqVeGtoA1geRoCkTIj84ThsY6iil4tp/G8v6pbKVZQU7SIQTrLXCG9Ni7MKg3YQYQ84afSAaMPqwC0QVEyEMig2E73UAMUDwdhsDB8aGVLQe2h+tDRwNe1YIFWWrMR7EEWQNbCdRvUQA3nqD4DQCvGD9EDPHz7vP+iZESDCAAEMEYQuM8MJUNwxALcSFtB41lKDYvAnOSO8DS9Go9NLQArB+CAJsYRSu98m9geixaeuoJELT6z4zTMmYz0a2pqUMYOxlsFK0authV9rPa/NZlu2w0l321ra6aXA1wRnTC0WlR7e9XrtrVrmI9eLg0kt/oh2L0aE925tUGxPM9dpd06ota+ZtAJde+lNvYaTeOWrftjY3lJS5NPVAeeh5bYq/dMnlVwwAlYwAqmoo2BAwROiXbJxBFsBqhOvddR/wYMEm4jMyGKA57XRwgE6oYL2UlWNHnf4GeCBaMiBUMkJwOiFiiGApeJKDD1MIKRYAIQhjikXKi9XQJJqU4+OwDGUXL/AAvKUmiy0AVzaIegwYQNglLpQeweiEAP56IAEAPIfYaAAXedFy8HGBngeBGSjEKzyC52ARvFaAGEB4Ep5n4MgERIoIxIiiOSaSdGX/T2rwcx6J6GuaCI697DcO0ZIBQimNICrbayFkiGHW+JRwEFYrRKh8934br9jEtEZmAzxnAQ0cwUSMwISI8tyzDljEawYMR8NhOL0QM8RwRDzXwJspjBQXiBEGNcUlxPC2WS5czRURJAYnoqyDKHruAZd4zYDhw2oxnF6IGWI4Lp6v96n1F8BIcYEYQ2xj2yGmscPa5rhIVnIa+ENSvSMcUsxxD7lEawYM7w+L4bkAzBDDJ7rj631q/QUwUlwgxhDb2HaIaeywtlkusLfAdua5B1ziNQOG4+IwnF6IGWIMhW/5ep9afwGMFBeIMcQ2th1iRq3YcvHtHbZv2N4DLvGaAcNxcRhOL8QMMRwXzzfwaQojxQVihLFNcUn1Y7s9hy0GtjXXkeUwmeIlA4TaJ0cQ6rqtE5Ahhlnjx4KDsFohgrsOeAAAX12x2QAv6sWORS3iWVbzKMZwevYY0ZoBw3vCYngeADPEcEQCrt6bTTPGSHGBGGFQ4eRvoD+cbZYL7LWwv3vuAZd4zYDhuDgMpxdihhiey8DX+lREsYSYIReIMcQ2th1iRrPJ3cfC/g36O9xTRDMSYPg0txhOL8QMMRyXgC8LZyLESHGBGENs4X5IjnIsnt+bUa8d9Xewp4hmJMDw/rAYngvADDF84Q98WTgTIUaKC8QYYgv3QzFmNJssF9hrYX+He4poRgIMx8VhOL0QM8QYGqHny8KZCDFSXCDGEFu4H4oxo9lkufh5B+cZnHcBl3jNgOG4OAynF2KGGI5LwJeFMxFipLhAjDC2KS7p+dTWcWhhGMDEi6b9sMRDMC6i7NDXScgAw65xY9JDGK0QwV8PPADAUF2x2QAP+LKt45hC/8P4eBbxGo/haVgMrxdiBhieSMA11AsxUlwgRhTUBJeMP2FQYQiAR1MxDSGoPkwIIKjK1polIAMMu8aF1UMYrRDBXw88AICnAcwGeMCXMKbQ/9CXqZiGGJ6GxfB6IWaA4Yl4rjKKKcRIcYEYUVATXCKMF7ezs9/Soi1u1f6lPxymhRBVKURB1bim6g+b2Wfzp8Py4bBadD/+sC1eLRd/flCfP7/9g3654n3Rn+zrpbwupU5D94LDYlOcrTbvSHGxLb5JCDb6ED+WpU6W6b8FshUQZDlQOQEKZUUJRUlOPxvD8hwsRcOydgIWytZIF7AK71cmsKAc71cllHUAFKX6GglLkV6lzRg0FyzaIC2lNd6rFArmvErFCaAsBwoESYunT7LFCkGrE0BhseZ8SqaKFRrAkT4liVLNghIcKGsThZrJU9Y22PpnbaJUM15lrcRWFWsFuqqULNbWRKlmehVr2pGtmWxlTaKusrDIumLNVF1BWY72a8Pwfm1guWZBKTpfWQ3LNefVGl+uShZpaY2fraxGz1ZWT81WKIst2OqEgq3wBVudULAVvmCrEwq2yhYsFJwa2ZAXnK1ZvxK8X+W4C+T8Kk/oAhLbBSR+ujKJnK5MTE1XKFuj26BI1FYuscREbUFRjk8sASdsFnRqwkLZic0wFCUTtgJ38XHJ5jzLTyhZji9ZPlWy0ITxhjiXsxy/IVayyOpi+A0xY9kNMQSVJ4BivcpOKFmWLVkIesKEpdgJS0+YsBQ7YekJE5biuwA9oQvQbBeADkiUa9YBcGznQEmN765kXKy5DCAnFCvBFys5oVgJslhpiy9WJYvLANri715pi6RPW3yx0hY5X2mDv3tVskj6zdRRE5QdD+0sbKIHZGGzPQA6IFGsWQcgRzZt8CObNujzK1rjz69ojTy/ojX+/IrWyPMr/SwWD4rcDNMavxnW7/Vi06pKdIAsLHJc61NidFpV2PhXiRviXPz1u9bIHiAT5ZqDlciTYSrxs5VK9Gylcmq2QlvHlZVzgZiqLGCCmLh/haKJ+ZpzgoAFmwU9oWBFtmChIP64ifKJ4yZgKz+htji2tvgJtcWxoeL4Myz9Zg22ZHliM5y1dVyyOWtZYmzncoBN3BZD2KkJC2HHRZtLLoZ/nEMZ+g6Wsqk72JEsEpTiT7IoRZ9kUTp1WwxlsUVLTyhagi9ackLREuyWmExtiaFshc4BkugFWVhssMjUnIWg2YPnGLTFH2S16IJt8fXaTpQrAMXfvrbIDXGLf0jUZo+cY7lm6tY11t4gJ2szNViB6MTJFbAzsRPOxL1BboQb/D64Rp8J1/gj4ZHfM3bW+BvWGnm4VE+dLQFR9DStpoYpFMV5s8IfV1XI06oK//S2yj68BXJTZ0qxqJw4AY7tlPg9r8wWJlCeOE/KeFMiH9dI/AsWEv1+hZw6oIopCfQ4FvhpLJDDWOBnsZgYxYBRotozySSw71ac8GoF9jUo/NGU37seB8UfTI3erLKQ/ZthrOiBgpfDdBMTBWO8VD7T74a9mb+a38yLi8vi9fzbr+fF7c3Lq4u5vnx59eW1fUlsGoyKktgXzT4sH1b3XcG+UDsJilpsjnb1YnVrRcgzQWlx8/K6OP96fnNdvHmtWDYlUSoa0jwjEoNJW1kKath1i+5+uzubf+jWq/2he15cvnpxMz+/virmF69eXr18c3szv7g2DlD/+ub65lwpf3M2t4rAl8B1G26Hb3XbS+VN3n851QiDy0/7FfB/f4NIH8zdu1yQHYYoW5PCr7t3OsjPbcj+5Qj9UoNih9CRQyhlZUVVsyYu7V90D4tt8WLX3S/36sObcl5OF46DqJkuIOvUP31YrovH3fLtcrd8WKy69Wb5cFgWy03x/qlbv39a7oru3V/0X7yqMiob0bTmdyAooaX+/QdzvfbXajep9qjObfDSSX/KPP13NwlXPKJRyKbrfr1ddOviflnoKtIB3n7SMvqX8vf7QrrtQO8XKVkhSV22bnYKN2OrQEhUsZBMCpFYqEoJcREL1SkhZXYk1CSFGMImCgxvk0IEIUTEcSHRNhghYDglKammOu4o0ZCMD+Igi1oYDqk481COjuQoTQma5zsZwdBC83glHc0QULZIzbJCapZkLMhSgmLsnGTceIJzMnR8zDmtmSW4kEwI+zPcdARZLGlOW2NUnlJP+UgwSdwcMyLkKEqOt3Ikl8pu3oyJyERKcHPGdDx3eDMmnMwdXo8ZU5EODK8RDZRXVQ4tkkI0Ii5FppxCIdHk8i9OFi7kOAVTycL5uEBTDZ5zPpJLdWbOalTV2a9XHJejCSIklQQ0UZ3JbCFTLSlUTcaUU0Fh7ZhyyjX2NfWjlFkzppyqI1YniMh0PrC6hm0mmQ6sHrUjmuTSv0F83MT+PdvjHpQcp1WMWHgx/RKHFmTMnByIttU/LeTgfE7L/kXKfscoTXGqLUckai2EtybxF9HUuGpVwUp1p1Ylv4jWBV9ESyPUZdUWtbLXItxcnr98cV1cXBev51/qO3f/NTbPre9z/Q/i9ps/QM7ui803d8I7IG5+QLPtf+Sgv4narpeH4S7K3dn8+ku6v/5YHzZOvzBTjt/MFZWqYGLzdfmwfLtarP60W22fx0WVWtg0pVk3cSKGQFEbTXNgkDo9m7Bb9UbCT9GfhlENwn7JddD/9e3FHLFUtO4e+Pzq9VfP9RMJqnaFDWVnhBD6jHEMiBoF5sxlvla3z/ddcfm02z52X6jOSRDr1Y6hqvv1t93mbrv7iFjDVJoJe7z5cOgeOnP7vnvo/nrXfaK792OpZ19zDNJvbo6Czs6392U2FROEWP+rEQHQRXfoGV1uVvv9D0dT2a736UzlmYogI+zIWbEwL+gkFH+nT7vCo5CMaqm6qphU/ctb9UQa0P6OI3EAOlGuhOjvlqPP/f9ZWTRQudru99vi6u+b5e5Y5N3igROrVOWWTD/gUnZQ1j7juOQL9Pea1VZh8dRnADL7BhsIUfqVeqUdl3+D7u+69XY3qD6SfLTuk2/QfPMfaj9bt+ILduTJi0oEqW4bbfO70ee7fekezx+pxqgtlsv9obtbrpe2UvAPVoqzYlBZ3G+L18v71b0COMFz/R5NNP1jr59buaQ1x931SV3DnkuqnW01GrrH3NevVHsjzo7NvZNmaQ/LGn2aioZFjUgDrNoR+2VTssfRDxjanz0oewgiXLyxs9L8TGhdEnpkXB7JNB9uO+RUDp//dL96t9X5m0uBrEEqb+3D1z5vkQVf1f0mu+5/DfiUlKXcbM8HtVdYnfZV9kApukh1F9a/vjNovdw/flysllp3Oa1W3zi3baj2+umwO+ZctXcWEc35Yrk6LI81cNXRqlDV1RE1Uva/YgWC+Hq3XSz3+w7hVK5/N47/nEjadAwjGYzLaa2ipXpfEWg9fVqa9FXFQE3T/HZvCkA/bcTl4LD2fPV4JPeUYfpnkoT+tWO9oqmOJXpdAwPPu91hudp1R9LNbFoGTazC5fagyOX2q63qbMeSuymJDLTdLLs1LrUHfd88qVa2uu/ul7hsHVb2mwxcmoFFOtQnbE7UfA04jvYm/w9nCJODV5+5CmPMy4f9Yff049+W++L7z26Xfzxs9UTYLfeP24d9d7da947VdO+C1v7956jqoHo+2uRb/bF7Xjz8sFXYi+Wdflz++NO+UPPHblc+JLcrWWj9GrWJx5e7p8etutPSL7QQUjPRPhOVGtP/tdofftqtFtvCROzV0/rQnX2lBu2+uFh+WOndFkaV/r0UYW4xF+uz17vu/7b93uqwLW8uz1/cXpfqruHGh7QgXxASXLH6TA/1o9tQo4qUxl+mCUr34kH4msFd/z5Dd/jonbcNnFcWqD0S02cVZozrMIQIxX67VmE+dLviYftBxd0c/akQLbZ3u+7hx67UA78sXh4tOKOqpq5DqzJVGaRvz4rHbqem/cc7hbV9MKEjtRS8FbX6xOuGqJ5H1C1UcYNSUjH33lUfEx2S80t1K6f8/xttu4rBP+k+znUMtQu1tL//7Nn3n6uc2y8U1e3Z/K47YDLdAdHWUTNAev53Oofv+7rFgZhnGAbkPxXIq+2uO+tLArnev09j1vebkH0xX+w+7lXibHFm6CcapA5gTGme68S6P+YO+026xp8S/Xa1+H3fO863m8elalc//vDryfSvJ9OnmaTXfzP7B88xOIMKZW5kc3RyZWFtCmVuZG9iagoxIDAgb2JqCjw8L0NvbnRlbnRzIDIzIDAgUi9UeXBlL1BhZ2UvUmVzb3VyY2VzPDwvRm9udDw8L0YxIDIgMCBSL0YyIDcgMCBSPj4vWE9iamVjdDw8L2ltZzkgMTMgMCBSL2ltZzggMTIgMCBSL2ltZzcgMTEgMCBSL2ltZzYgMTAgMCBSL2ltZzUgOSAwIFIvaW1nNCA4IDAgUi9pbWcxNyAyMSAwIFIvaW1nMTggMjIgMCBSL2ltZzE1IDE5IDAgUi9pbWcxNiAyMCAwIFIvaW1nMyA2IDAgUi9pbWcxMyAxNyAwIFIvaW1nMiA1IDAgUi9pbWcxNCAxOCAwIFIvaW1nMSA0IDAgUi9pbWcxMSAxNSAwIFIvaW1nMCAzIDAgUi9pbWcxMiAxNiAwIFIvaW1nMTAgMTQgMCBSPj4+Pi9QYXJlbnQgMjQgMCBSL01lZGlhQm94WzAgMCA1OTUuMjggODQxLjg4XT4+CmVuZG9iagoyNyAwIG9iago8PC9EZXN0WzEgMCBSL1hZWiAwIDIzMS4yMiAwXS9UaXRsZShGaWNoYSBkZSBDb21wZW5zYefjbykvUGFyZW50IDI2IDAgUj4+CmVuZG9iagoyNiAwIG9iago8PC9EZXN0WzEgMCBSL0ZpdEggODQxLjg4XS9Db3VudCAxL1RpdGxlKEJvbGV0byBCcmFkZXNjbykvUGFyZW50IDI1IDAgUi9GaXJzdCAyNyAwIFIvTGFzdCAyNyAwIFI+PgplbmRvYmoKMjUgMCBvYmoKPDwvVHlwZS9PdXRsaW5lcy9Db3VudCAyL0ZpcnN0IDI2IDAgUi9MYXN0IDI2IDAgUj4+CmVuZG9iagoyIDAgb2JqCjw8L1N1YnR5cGUvVHlwZTEvVHlwZS9Gb250L0Jhc2VGb250L0hlbHZldGljYS1Cb2xkL0VuY29kaW5nL1dpbkFuc2lFbmNvZGluZz4+CmVuZG9iago3IDAgb2JqCjw8L1N1YnR5cGUvVHlwZTEvVHlwZS9Gb250L0Jhc2VGb250L0hlbHZldGljYS9FbmNvZGluZy9XaW5BbnNpRW5jb2Rpbmc+PgplbmRvYmoKMjQgMCBvYmoKPDwvS2lkc1sxIDAgUl0vVHlwZS9QYWdlcy9Db3VudCAxPj4KZW5kb2JqCjI4IDAgb2JqCjw8L1BhZ2VNb2RlL1VzZU91dGxpbmVzL1R5cGUvQ2F0YWxvZy9PdXRsaW5lcyAyNSAwIFIvUGFnZXMgMjQgMCBSPj4KZW5kb2JqCjI5IDAgb2JqCjw8L01vZERhdGUoRDoyMDI1MTIxNTA4NTk1OC0wMycwMCcpL0NyZWF0aW9uRGF0ZShEOjIwMjUxMjE1MDg1OTU4LTAzJzAwJykvUHJvZHVjZXIoT3BlblBERiAxLjMuMzApL1RpdGxlKEJyYWRlc2NvIENvbelyY2lvIEVsZXRy9G5pY28pPj4KZW5kb2JqCnhyZWYKMCAzMAowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMTMzOTQgMDAwMDAgbiAKMDAwMDAxNDAzOSAwMDAwMCBuIAowMDAwMDAwMDE1IDAwMDAwIG4gCjAwMDAwMDAxNzggMDAwMDAgbiAKMDAwMDAwMDM0MSAwMDAwMCBuIAowMDAwMDAwNTA2IDAwMDAwIG4gCjAwMDAwMTQxMzIgMDAwMDAgbiAKMDAwMDAwMDY3MSAwMDAwMCBuIAowMDAwMDAwODc3IDAwMDAwIG4gCjAwMDAwMDExMzQgMDAwMDAgbiAKMDAwMDAwMTM5NCAwMDAwMCBuIAowMDAwMDAxNjY3IDAwMDAwIG4gCjAwMDAwMDE5MTEgMDAwMDAgbiAKMDAwMDAwMjE3MSAwMDAwMCBuIAowMDAwMDAyNDQxIDAwMDAwIG4gCjAwMDAwMDI2MTAgMDAwMDAgbiAKMDAwMDAwMjg4NiAwMDAwMCBuIAowMDAwMDAzMDY1IDAwMDAwIG4gCjAwMDAwMDMzMjEgMDAwMDAgbiAKMDAwMDAwMzU4OCAwMDAwMCBuIAowMDAwMDA3NjA3IDAwMDAwIG4gCjAwMDAwMDc5MTMgMDAwMDAgbiAKMDAwMDAwODY0MCAwMDAwMCBuIAowMDAwMDE0MjIwIDAwMDAwIG4gCjAwMDAwMTM5NzEgMDAwMDAgbiAKMDAwMDAxMzg1NiAwMDAwMCBuIAowMDAwMDEzNzY2IDAwMDAwIG4gCjAwMDAwMTQyNzIgMDAwMDAgbiAKMDAwMDAxNDM1NiAwMDAwMCBuIAp0cmFpbGVyCjw8L0luZm8gMjkgMCBSL0lEIFs8ZmUyNmNjMjdmMWI4OTQ2YTM3YTNlYTRiNTU2NTdiNDc+PGQ4ZDk3ZGQ0N2Y4MzczNjMyNTg1ZDgyN2RjZjNlNDdjPl0vUm9vdCAyOCAwIFIvU2l6ZSAzMD4+CnN0YXJ0eHJlZgoxNDUwOQolJUVPRgo=",
            "fileName": "file_12.pdf",
            "fileSize": "15.3 kB"
          }
        }
      }
    ]
  },
  "versionId": "f5d22955-a533-42eb-9a26-54c6afd2cafb",
  "activeVersionId": "f5d22955-a533-42eb-9a26-54c6afd2cafb",
  "triggerCount": 2,
  "shared": [
    {
      "updatedAt": "2025-11-26T10:17:15.840Z",
      "createdAt": "2025-11-26T10:17:15.840Z",
      "role": "workflow:owner",
      "workflowId": "xbiM1JT5KjJBCrxu",
      "projectId": "72MghKyBe7pL4bex"
    }
  ],
  "activeVersion": {
    "updatedAt": "2025-12-16T10:40:18.086Z",
    "createdAt": "2025-12-16T10:40:18.086Z",
    "versionId": "f5d22955-a533-42eb-9a26-54c6afd2cafb",
    "workflowId": "xbiM1JT5KjJBCrxu",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "6ff257a0-6494-492b-af31-5214a9bd20a1",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -4560,
          128
        ],
        "id": "02e65664-256c-4dbb-9aca-7f8cb2fe9832",
        "name": "Webhook",
        "webhookId": "6ff257a0-6494-492b-af31-5214a9bd20a1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "16ffaaef-fe33-426d-a0ff-e2dac2b106e9",
                "leftValue": "={{ $json.body.message.isGroup }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3872,
          144
        ],
        "id": "27f5f0f3-677b-404d-b04a-fd415490c8e0",
        "name": "isGroup",
        "executeOnce": true
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "1d8f7b82-de27-4f28-afe4-9f073754da5b",
                      "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                      "rightValue": "ExtendedTextMessage",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "ExtendedTextMessage"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "8e75be5f-38f7-4db9-8ebe-c2f0e4580de1",
                      "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                      "rightValue": "=Conversation",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "Conversation"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                      "rightValue": "AudioMessage",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "e9de78c4-def0-4385-92ae-f3d8db4668ef"
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "AudioMessage"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "6dc571f3-1d8c-4784-8cfa-d29f807666f7",
                      "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                      "rightValue": "ImageMessage",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "ImageMessage"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "7a88511a-7a3c-442d-bad5-fc9aa48d5a18",
                      "leftValue": "={{ $('Dados de Entrada').item.json.TipoDeMensagem }}",
                      "rightValue": "DocumentMessage",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "DocumentMessage"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.3,
        "position": [
          -2560,
          64
        ],
        "id": "271e1181-ddcd-4143-a6a6-79e35c53c17b",
        "name": "tipoMsg"
      },
      {
        "parameters": {
          "operation": "rowNotExists",
          "dataTableId": {
            "__rl": true,
            "value": "TvERETBAGi000bZb",
            "mode": "list",
            "cachedResultName": "DadosClienteKybernan",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
          },
          "filters": {
            "conditions": [
              {
                "keyName": "IdGroup",
                "keyValue": "={{ $json.body.message.chatid }}"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          -3392,
          -192
        ],
        "id": "e7150fda-84b5-4a1d-ace4-d2d974f070a7",
        "name": "ExisteGrupoTabela False",
        "executeOnce": true
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "TvERETBAGi000bZb",
            "mode": "list",
            "cachedResultName": "DadosClienteKybernan",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
          },
          "filters": {
            "conditions": [
              {
                "keyName": "IdGroup",
                "keyValue": "={{ $('Dados de Entrada').item.json.body.message.chatid }}"
              }
            ]
          },
          "returnAll": true
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          -3392,
          16
        ],
        "id": "c4e81850-1e79-4f18-89b6-c46f34c3aaa3",
        "name": "Get row(s)"
      },
      {
        "parameters": {
          "dataTableId": {
            "__rl": true,
            "value": "TvERETBAGi000bZb",
            "mode": "list",
            "cachedResultName": "DadosClienteKybernan",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "IdGroup": "={{ $('Dados de Entrada').item.json.body.message.chatid }}",
              "NomeGrupo": "={{ $('Dados de Entrada').item.json.Nome }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "NomeGrupo",
                "displayName": "NomeGrupo",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "IdGroup",
                "displayName": "IdGroup",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "phone1",
                "displayName": "phone1",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "phone2",
                "displayName": "phone2",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "phone3",
                "displayName": "phone3",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "email",
                "displayName": "email",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Folder",
                "displayName": "Folder",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "apiERP",
                "displayName": "apiERP",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "ERP",
                "displayName": "ERP",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          -3200,
          -192
        ],
        "id": "fbb4a44a-71e6-4f63-a7f9-95e9c4c308e6",
        "name": "Insere Novo Row"
      },
      {
        "parameters": {
          "content": "## BANCO DE DADOS\n\ntratamento de BD para identificar usuário e pasta correta, etc..\n",
          "height": 480,
          "width": 656,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3456,
          -320
        ],
        "id": "e2b4180f-4460-443c-a34d-979ffd64ab8b",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "c9d48431-6205-4d71-9d24-346dfe880a25",
                "name": "IdGroup",
                "value": "={{ $json.IdGroup }}",
                "type": "string"
              },
              {
                "id": "46b09227-842e-44df-95f7-4819cc47f958",
                "name": "phone1",
                "value": "={{ $json.phone1 }}",
                "type": "string"
              },
              {
                "id": "91d9c47f-3e9a-4344-86e6-f5124490957f",
                "name": "phone2",
                "value": "={{ $json.phone2 }}",
                "type": "string"
              },
              {
                "id": "0c9bc12c-ca1e-4f6c-ba7b-c33a6fa84fe6",
                "name": "phone3",
                "value": "={{ $json.phone3 }}",
                "type": "string"
              },
              {
                "id": "4b1803fd-3a6e-463d-b63e-8b37605cdc9e",
                "name": "email",
                "value": "={{ $json.email }}",
                "type": "string"
              },
              {
                "id": "a8310a6c-4a6f-4151-878f-edf87ef8f06e",
                "name": "Folder",
                "value": "={{ $json.Folder }}",
                "type": "string"
              },
              {
                "id": "f6f759e7-b7cf-4081-93d3-362cf3b2ffd8",
                "name": "apiERP",
                "value": "={{ $json.apiERP }}",
                "type": "string"
              },
              {
                "id": "61b97bff-04e1-4870-8c6e-0286ac545ed1",
                "name": "ERP",
                "value": "={{ $json.ERP }}",
                "type": "string"
              },
              {
                "id": "630f0159-3b5e-48c4-aa49-4eeb0af3b2de",
                "name": "NomeGrupo",
                "value": "={{ $json.NomeGrupo }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3184,
          16
        ],
        "id": "c7008e17-9448-4747-8b4e-a3e3692e6e56",
        "name": "DADOS USUÁRIO"
      },
      {
        "parameters": {
          "operation": "pdf",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1.1,
        "position": [
          -640,
          1328
        ],
        "id": "1d71cb53-dd9b-475e-9230-5a186ec0a31d",
        "name": "Extract from File"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://kybernan.uazapi.com/message/download",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "token",
                "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "id",
                "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
              },
              {
                "name": "return_base64",
                "value": "true"
              },
              {
                "name": "generate_mp3",
                "value": "false"
              },
              {
                "name": "transcribe",
                "value": "false"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2080,
          32
        ],
        "id": "023fa18a-cac6-4e2a-8dc2-78bd53dc51be",
        "name": "HTTP Request2"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "base64Data",
          "options": {
            "mimeType": "={{ $json.mimetype }}"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -1872,
          32
        ],
        "id": "2351b7f9-ae4d-456f-a70d-6c9e8c67460b",
        "name": "Convert to File1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://kybernan.uazapi.com/message/download",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "token",
                "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "id",
                "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
              },
              {
                "name": "return_base64",
                "value": "true"
              },
              {
                "name": "generate_mp3",
                "value": "false"
              },
              {
                "name": "transcribe",
                "value": "false"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2080,
          528
        ],
        "id": "da62ecd9-2e16-42b7-b050-ef61e44eb982",
        "name": "HTTP Request3"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "base64Data",
          "options": {
            "mimeType": "={{ $json.mimetype }}"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -1872,
          544
        ],
        "id": "f548f8d3-b350-4c20-a701-1b74efd7c4ff",
        "name": "Convert to File2"
      },
      {
        "parameters": {
          "inputText": "={{ $json.output }}",
          "categories": {
            "categories": [
              {
                "category": "Boletos-Guias",
                "description": "Selecione esta opção se o texto contiver instrumentos de cobrança ou pagamento. Procure por \"Linha digitável\", \"Código de barras\", \"Boleto bancário\", \"Vencimento\", \"Pix copia e cola\", \"qr code\" ou \"Valor do documento\", não precisa ter todas estas informações, são apenas dicas de como entender que é um boleto ou guia. O objetivo principal é classificar boletos bancários ou guias como Boletos-Guias"
              },
              {
                "category": "Nota-Fiscal",
                "description": "Selecione esta opção se o texto contiver dados de uma Nota Fiscal, DANFE, Cupom ou NFS-e. Procure por termos como \"Chave de Acesso\", \"Natureza da Operação\", \"DANFE\", \"Conhecimento de Transporte Eletrônico (CT-e) – Modal Rodoviário\" ou detalhes de produtos e impostos. Marque como verdadeiro mesmo que haja um boleto junto."
              },
              {
                "category": "holerites",
                "description": "HOLERITES "
              },
              {
                "category": "recibos",
                "description": "RECIBOS"
              },
              {
                "category": "comprovantePagamento",
                "description": "comprovante de pagamento de boletos ou comprovantes de agendamento"
              },
              {
                "category": "cheque",
                "description": "CHEQUES"
              },
              {
                "category": "comprovantePixTransferencia",
                "description": "comprovante de transferência ou pix ou comprovante de agendamento de pix e ted"
              },
              {
                "category": "pedidoDeCompra",
                "description": "Pedido de compra"
              },
              {
                "category": "relatórioDiversasContasAPagar",
                "description": "Relatório de contas a pagar, não uma conta específica mas um relatório completo."
              }
            ]
          },
          "options": {
            "multiClass": true,
            "fallback": "other",
            "systemPromptTemplate": "=# Role\nVocê é um classificador especialista em triagem de documentos financeiros e contábeis. Sua prioridade é identificar corretamente instrumentos de cobrança e fiscais.\n\n# Input Analysis\nO texto de entrada é um resumo extraído de documentos via OCR.\nO input pode conter:\n1. Um único documento isolado.\n2. Múltiplos documentos concatenados (ex: Uma Nota Fiscal seguida do seu Boleto bancário).\n\n# Rules for Classification\n\n1. **REGRA DE OURO (BOLETOS):**\n   - Se o texto contiver a frase \"Boleto bancário\", \"Linha digitável\", \"Código de barras\" OU \"Nosso número\", classifique AUTOMATICAMENTE como \"Boletos-Guias\".\n   - **Atenção:** Não exija a presença de \"Pix\" ou \"QR Code\". Se tiver apenas a linha digitável, JÁ É um boleto.\n\n2. **DIFERENÇA CRÍTICA (A PAGAR vs PAGO):**\n   - Se tem \"Vencimento\" e é uma cobrança -> Classifique como \"Boletos-Guias\".\n   - Se tem \"Autenticação\", \"Comprovante de Operação\" ou \"Pagamento efetuado\" -> Classifique como \"comprovantePagamento\".\n\n3. **REGRA DO COMBO (MULTI-CLASS):**\n   - Se o texto contiver dados de Nota Fiscal (DANFE, Chave de acesso) **E** dados de Boleto (Linha digitável), você **DEVE** marcar AMBAS as categorias (\"Nota-Fiscal\" E \"Boletos-Guias\") como verdadeiras.\n   - Não escolha apenas um se os dois existirem no texto.\n\n4. **EVITAR \"OUTROS\":**\n   - Use a categoria \"Outros\" APENAS se o documento for ilegível ou não tiver nenhuma relação com finanças/contabilidade. Na dúvida entre \"Outros\" e \"Boletos-Guias\", escolha \"Boletos-Guias\".\n\n# Step-by-Step Thinking\n1. O texto diz explicitamente \"Tipo de documento: Boleto bancário\"? Se SIM -> Marque \"Boletos-Guias\" imediatamente.\n2. O texto possui uma linha digitável numérica longa? Se SIM -> Marque \"Boletos-Guias\".\n3. O texto possui chave de acesso de 44 dígitos ou diz \"DANFE\"? Se SIM -> Marque \"Nota-Fiscal\".\n4. Verificação final: É apenas um comprovante de que a conta já foi paga (tem autenticação bancária)? Se SIM, classifique como \"comprovantePagamento\" e ignore \"Boletos-Guias\". Se for a conta original para pagar, mantenha \"Boletos-Guias\".\n5. Se o tipo de documento for Boleto bancário, classifique como \"Boletos-Guias\"",
            "enableAutoFixing": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.textClassifier",
        "typeVersion": 1.1,
        "position": [
          864,
          1120
        ],
        "id": "9e05b0c8-d3f2-49a0-a84c-bace19459f3e",
        "name": "Text Classifier"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "cc623d92-90a9-4c53-a977-960b80305e27",
                "name": "text",
                "value": "={{ $json.text || $json['0'].content[0].text || $json['0'].content[0].text }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -224,
          1168
        ],
        "id": "4ba8a991-1a84-40c6-aacd-10b6f73f032b",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "name": "arquivo",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0",
            "mode": "list",
            "cachedResultName": "ARQUIVOS RECEBIDOS KYBERNAN TESTE",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          -624,
          1120
        ],
        "id": "9bc951fe-d887-4954-b199-363c66a2d85b",
        "name": "Upload file2",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $('AI Agent1').item.json.output }}",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=Analise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE o seguinte JSON:\n\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n1. Em \"NOME_ARQUIVO\", use o número do mês (ex: 01, 02) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n2. Priorize a data de VENCIMENTO encontrada.\n3. Não inclua markdown, apenas o JSON puro.\n4. Exemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico)\n5. Se tiver nota fiscal com boletos, ignore a nota fiscal e extraia os dados apenas dos boletos\n6. Se a data de vencimento for a mesma, não extrair mais de uma vez os dados, extrair 1 vez apenas e neste caso o nome do arquivo coloque \"DD.MM - DIVERSOS FORNECEDORES\" se houver mais de um na mesma data.\n7. Sempre que houver código de barras de um determinado boleto, também extraia o valor, só números, tenha certeza de que está informando o código inteiro e o número está correto.\n\nAnalise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE um ARRAY JSON contendo um ou mais objetos, no seguinte formato.\n\nSe for encontrada apenas UMA data de vencimento/pagamento (indicando um único boleto ou conta), o retorno DEVE ser um array contendo um único objeto.\nSe for encontrada MAIS DE UMA data de vencimento/pagamento (indicando múltiplos boletos ou contas), o retorno DEVE ser um array JSON contendo um objeto para cada boleto/conta individual.\n\nEstrutura do Objeto (dentro do Array):\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS_NUMÉRICO - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n\nEm \"NOME_ARQUIVO\", use o número do mês com dois dígitos (ex: 01, 02, ..., 12) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n\nPriorize a data de VENCIMENTO encontrada.\n\nExemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico).\n\nExemplo de Saída (Múltiplos Boletos):\n[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\nExemplo de Saída (Boleto Único):\n[\n{\n\"DATA\": \"15\",\n\"MES\": \"SET\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"15.09 - AGUA_LIMPA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\n## RULES\n- NUNCA, JAMAIS, erre informações, tenha certeza das datas, dia, mês e ANO\n- Se houver documentos que não sejam boletos ou contas a pagar, ignore, apenas siga com a extração de informações para contas a pagar, boletos, etc...\n- O nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE, utilize este nome para nomear o arquivo."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          1696,
          752
        ],
        "id": "fee0a4a4-dc7a-4c9d-8313-2cb40fef7eb0",
        "name": "AI Agent",
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-5.1",
            "mode": "list",
            "cachedResultName": "gpt-5.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          1680,
          992
        ],
        "id": "2eebaf89-ee86-4e10-afb7-6fd57143d3d4",
        "name": "OpenAI Chat Model2",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "jsonSchemaExample": "[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]",
          "autoFix": true
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          1888,
          928
        ],
        "id": "918eadd9-256b-4061-b8cc-0061a3cd26cb",
        "name": "Structured Output Parser"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineByPosition",
          "numberInputs": 3,
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          0,
          1056
        ],
        "id": "c4438367-3efd-4b04-ae7a-a1dd06e1d31f",
        "name": "Merge1",
        "executeOnce": true
      },
      {
        "parameters": {
          "operation": "pdf",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1.1,
        "position": [
          -608,
          224
        ],
        "id": "feeecb04-34b4-4e4a-b886-013d8a5c4fce",
        "name": "Extract from File1",
        "alwaysOutputData": false,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "content": "## Imagem para PDF",
          "height": 304,
          "width": 688,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -2160,
          -80
        ],
        "id": "6bd77148-c4c2-4a94-9b49-c1bd6853e36f",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "b6a152ef-f1f0-47ca-bd32-db9737dff1ae",
                "leftValue": "={{ $json.Folder }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -2944,
          16
        ],
        "id": "4d4f66fe-732f-4ec1-ba67-e849af83f79b",
        "name": "temPasta"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "d0250d2a-d792-4061-a12e-e16b7a22cb47",
                "name": "Nome",
                "value": "={{ $json.body.chat.name }}",
                "type": "string"
              },
              {
                "id": "ad1db2aa-736d-4164-9683-87654e150161",
                "name": "body.message.senderName",
                "value": "={{ $json.body.message.senderName }}",
                "type": "string"
              },
              {
                "id": "9c67e34d-811b-4ff2-87ad-6075a508463b",
                "name": "TipoDeMensagem",
                "value": "={{ $json.body.message.messageType }}",
                "type": "string"
              },
              {
                "id": "cb9a1539-beeb-407b-a17d-23985944eed0",
                "name": "body.message.content.URL",
                "value": "={{ $json.body.message.content.URL }}",
                "type": "string"
              },
              {
                "id": "1d589f28-545f-455a-995b-15fe80092f32",
                "name": "body.message.isGroup",
                "value": "={{ $json.body.message.isGroup }}",
                "type": "boolean"
              },
              {
                "id": "2fcecf85-6540-41a7-987f-bd25c45a5a8f",
                "name": "body.message.sender_pn",
                "value": "={{ $json.body.message.sender_pn ? $json.body.message.sender_pn.replace(/[^0-9]/g, '').slice(2) : null }}",
                "type": "string"
              },
              {
                "id": "2d522b05-d083-432a-af3e-292a2baf080a",
                "name": "body.message.text",
                "value": "={{ $json.body.message.text }}",
                "type": "string"
              },
              {
                "id": "4159e7cd-a733-47b5-8a3d-0786c19be8cd",
                "name": "body.message.chatid",
                "value": "={{ $json.body.message.chatid }}",
                "type": "string"
              },
              {
                "id": "b9b4a916-acb6-4032-be80-0bdd78b1033f",
                "name": "body.message.messageid",
                "value": "={{ $json.body.message.messageid }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -4272,
          128
        ],
        "id": "58174c50-92b5-4c4d-98bc-9adaa7f9448b",
        "name": "Dados de Entrada"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "PEDIDO COMPRA"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          2048
        ],
        "id": "a788e0f5-192b-469f-8839-d77e39419903",
        "name": "PEDIDO COMPRA",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "HOLERITES"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1248
        ],
        "id": "bec0d12d-bb21-4e3a-827f-96a9d72e2783",
        "name": "HOLERITES",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "RECIBOS"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1392
        ],
        "id": "4f58faf7-9116-4eaf-9a0b-d2908cc31675",
        "name": "RECIBOS",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "COMPROVANTE PAGAMENTO"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1536
        ],
        "id": "0128b1d7-95e2-4dd8-be43-f97c951e6e64",
        "name": "COMPROVANTE PAGAMENTO",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "CHEQUES"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1712
        ],
        "id": "f6e8c582-1a4d-4cbd-a7f4-d5b8f73075f6",
        "name": "CHEQUES",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "TRANSFERENCIA PIX"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "MOTIVO DO ERRO",
                "displayName": "MOTIVO DO ERRO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "CORRIGIDO",
                "displayName": "CORRIGIDO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1872
        ],
        "id": "3eef9de4-a311-4090-b780-1e642fca1f2f",
        "name": "TRANSFERENCIA PIX",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "NÃO IDENTIFICADO"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          2384
        ],
        "id": "1a0c29e1-8240-41e5-a7e4-f0979f4eac02",
        "name": "OUTROS",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "0ca53349-4a2f-410c-9b0f-d37dbd8379fa",
                "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
                "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              },
              {
                "id": "d05a2206-6355-43ae-9547-75bfa0b9be41",
                "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
                "rightValue": "application/vnd.ms-excel",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -1632,
          464
        ],
        "id": "7fc622cc-02c9-4fc9-86a5-fea2e1727f78",
        "name": "excel?"
      },
      {
        "parameters": {
          "content": "## É excel?\n",
          "height": 240,
          "width": 624
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -2128,
          448
        ],
        "id": "7157356b-c417-48a6-91ba-6df915f79b96",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "content": "## Excel para PDF\n",
          "height": 288,
          "width": 272,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -1200,
          416
        ],
        "id": "9f458b65-0915-4ac1-b27b-39fb7f3e3d9d",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "content": "## Puxa o texto e vê quantidade caracteres",
          "height": 304,
          "width": 448
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -656,
          64
        ],
        "id": "c364bf06-b91a-4fd7-82d0-95954a009f45",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {
            "includeBinaries": true
          }
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          -592,
          752
        ],
        "id": "23d5b8ff-9511-48fe-9440-c67dc1dfc963",
        "name": "Aggregate"
      },
      {
        "parameters": {
          "content": "## ARQUIVO PDF FINAL",
          "height": 224,
          "width": 400
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -656,
          688
        ],
        "id": "87ac175d-99db-461d-82d5-f2a376386816",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://kybernan.uazapi.com/message/download",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "token",
                "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "id",
                "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
              },
              {
                "name": "return_base64",
                "value": "true"
              },
              {
                "name": "generate_mp3",
                "value": "false"
              },
              {
                "name": "transcribe",
                "value": "false"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -592,
          464
        ],
        "id": "deff2226-0703-40bb-b934-2c8334254ec5",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "base64Data",
          "options": {
            "mimeType": "={{ $json.mimetype }}"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -384,
          464
        ],
        "id": "c3e60bc5-4d76-47b7-a178-b15e257b837c",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "content": "## PDF com padrão OCR",
          "height": 224,
          "width": 672
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -656,
          400
        ],
        "id": "f250a6f8-4a7f-4e30-8601-34eec3ff019c",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "content": "## Junta texto, arquivo e dados",
          "height": 528,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -704,
          992
        ],
        "id": "bbbacf82-a592-42d0-bb59-d43ce181a372",
        "name": "Sticky Note8"
      },
      {
        "parameters": {
          "content": "## Classificador",
          "height": 1504,
          "width": 752
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          816,
          1040
        ],
        "id": "65f438e5-747a-4e11-a0a6-0b3f8dab987f",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "content": "## Boletos",
          "height": 544,
          "width": 1184
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1632,
          640
        ],
        "id": "a04f1d7a-762b-4f4f-9010-783f4131bd8d",
        "name": "Sticky Note10"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1",
            "mode": "list",
            "cachedResultName": "gpt-4.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          1888,
          1056
        ],
        "id": "d3cd5c1f-6e1a-4a3d-a37b-1849ef108daa",
        "name": "OpenAI Chat Model",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "fieldToSplitOut": "output",
          "options": {}
        },
        "type": "n8n-nodes-base.splitOut",
        "typeVersion": 1,
        "position": [
          2304,
          672
        ],
        "id": "efbc1974-6b5e-4797-9ab2-394a1942c724",
        "name": "Split Out"
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "={{ $('Upload file2').item.json.id }}",
            "mode": "id"
          },
          "name": "={{ (new Date()).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }).replace(/\\//g, '.') }} - {{ $('Dados de Entrada').item.json.Nome }} - (SALVADO POR IA)",
          "sameFolder": false,
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "=12JepBiCyidTjZknzUgb8yVOFHZF-Q6Ro",
            "mode": "id"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          1888,
          1536
        ],
        "id": "84a0ba27-92bb-4c18-b81d-ab7a3bbaa9ed",
        "name": "Copy file1",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          2560,
          672
        ],
        "id": "0aea1eea-ccb4-4ac0-a8df-5ff069084138",
        "name": "Merge2"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "http://kybernan_gotenberg:3000/forms/libreoffice/convert",
          "sendBody": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "landscape",
                "value": "true"
              },
              {
                "parameterType": "formBinaryData",
                "name": "files",
                "inputDataFieldName": "data"
              },
              {
                "name": "addOriginalDocumentAsStream",
                "value": "false"
              }
            ]
          },
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -1104,
          528
        ],
        "id": "1a00927b-11cf-44c2-9d1c-da346e0bc0ec",
        "name": "HTTP Request5"
      },
      {
        "parameters": {
          "resource": "image",
          "operation": "analyze",
          "modelId": {
            "__rl": true,
            "value": "gpt-4o",
            "mode": "list",
            "cachedResultName": "GPT-4O"
          },
          "text": "Transcreva o que tem nesta imagem, tudo o que exatamente está escrito nela de forma organizada.",
          "inputType": "base64",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -336,
          1664
        ],
        "id": "ece7a3fb-81d7-497f-b483-f69cac4c79a1",
        "name": "Analyze image",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "content": "## Se fizer OCR e tiver sem texto",
          "height": 208,
          "width": 528
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -720,
          1600
        ],
        "id": "91beb6ad-6576-4e6c-914f-1023277a46f0",
        "name": "Sticky Note12"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://kybernan.uazapi.com/message/download",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "token",
                "value": "4d8e979d-0339-417a-89c6-9e56bc0cead7"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "id",
                "value": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
              },
              {
                "name": "return_base64",
                "value": "true"
              },
              {
                "name": "generate_mp3",
                "value": "false"
              },
              {
                "name": "transcribe",
                "value": "false"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -688,
          1680
        ],
        "id": "da57fbe7-a982-400e-8874-66b836589420",
        "name": "HTTP Request6"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "base64Data",
          "options": {
            "mimeType": "={{ $json.mimetype }}"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -512,
          1680
        ],
        "id": "66f8b565-7646-4207-a74e-1b6bce6054bc",
        "name": "Convert to File4"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "TIPO DE ARQUIVO": "NOTA FISCAL",
              "CAMINHO QUE FOI SALVO": "=PASTA DE NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          1104
        ],
        "id": "663cb474-45c6-4261-9f2c-a58136864172",
        "name": "NOTA FISCAL",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
                "leftValue": "={{ Number($json.text.length) }}",
                "rightValue": 20,
                "operator": {
                  "type": "number",
                  "operation": "lt"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -416,
          112
        ],
        "id": "04f93ae5-335a-4881-b2b2-74007cddfc3d",
        "name": "Menos que 20 caracteres"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
                "leftValue": "={{ Number($json.text.length) }}",
                "rightValue": 20,
                "operator": {
                  "type": "number",
                  "operation": "lt"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -496,
          1344
        ],
        "id": "2b625636-5b90-42e9-95de-072ff02a2623",
        "name": "Menos que 20 caracteres1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          -3840,
          704
        ],
        "id": "acddbb94-728b-4409-a75f-1097a677dfad",
        "name": "Loop Over Items1"
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "TvERETBAGi000bZb",
            "mode": "list",
            "cachedResultName": "DadosClienteKybernan",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
          },
          "filters": {
            "conditions": [
              {
                "keyName": "IdGroup",
                "keyValue": "={{ $('Dados de Entrada').item.json.body.message.chatid }}"
              },
              {
                "keyName": "phone1",
                "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
              },
              {
                "keyName": "phone2",
                "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
              },
              {
                "keyName": "phone3",
                "keyValue": "={{ $json.telefone_10_digitos || $json.telefone_11_digitos }}"
              }
            ]
          },
          "returnAll": true
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          -3632,
          736
        ],
        "id": "6465a5b5-be23-4e89-8776-4a474aa9a1f6",
        "name": "Get row(s)1",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "jsCode": "// O código deve retornar um array de itens.\n// Como precisamos de 2 saídas, retornaremos um array com 2 objetos de item.\n\n// 1. Obter o número de telefone de entrada\n// A entrada está no formato do primeiro item (index 0)\nconst numeroCompleto = $input.first().json.body.message.sender_pn;\n\n// 2. Definir o DDD (os primeiros 2 dígitos)\nconst ddd = numeroCompleto.substring(0, 2);\n\n// 3. Definir o número original sem o DDD\nconst numeroSemDdd = numeroCompleto.substring(2);\n\n// 4. Inicializar as variáveis para as saídas\nlet numero10Digitos;\nlet numero11Digitos;\n\n// 5. Normalizar o número\nif (numeroSemDdd.length === 8) {\n    // Caso de entrada com 10 dígitos (Ex: 1188888888)\n    // Saída de 10 dígitos: Mantém como está\n    numero10Digitos = ddd + numeroSemDdd;\n    \n    // Saída de 11 dígitos: Adiciona o '9' após o DDD\n    numero11Digitos = ddd + '9' + numeroSemDdd;\n    \n} else if (numeroSemDdd.length === 9) {\n    // Caso de entrada com 11 dígitos (Ex: 11988888888)\n    // Saída de 11 dígitos: Mantém como está\n    numero11Digitos = ddd + numeroSemDdd;\n    \n    // Saída de 10 dígitos: Remove o primeiro dígito do número (que deve ser o '9')\n    // Usamos `slice(1)` para remover o primeiro caractere da string.\n    const numeroSemNove = numeroSemDdd.slice(1);\n    numero10Digitos = ddd + numeroSemNove;\n    \n} else {\n    // Caso de erro ou formato inesperado\n    console.error(\"Número de telefone com formato inesperado:\", numeroCompleto);\n    // Para evitar que o workflow pare, vamos apenas usar o número original em ambas as saídas\n    numero10Digitos = numeroCompleto;\n    numero11Digitos = numeroCompleto;\n}\n\n// 6. Criar os dois itens de output\nconst outputItem1 = {\n    json: {\n        telefone_10_digitos: numero10Digitos\n    }\n};\n\nconst outputItem2 = {\n    json: {\n        telefone_11_digitos: numero11Digitos\n    }\n};\n\n// 7. Retornar o array de itens\nreturn [outputItem1, outputItem2];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -3840,
          480
        ],
        "id": "939bacb5-4fc1-408b-8b14-e76b13dea785",
        "name": "normalizaNumero"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "7fa82878-e3a3-4b6f-9533-8352ea7d4ea0",
                "leftValue": "={{ $json }}",
                "rightValue": "",
                "operator": {
                  "type": "object",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3456,
          736
        ],
        "id": "038c3e36-bc0f-4db3-9170-cec274ccad28",
        "name": "seNumeroExisteSegue"
      },
      {
        "parameters": {
          "content": "## Normaliza numero 10 ou 11 digitos, tenta encontrar com ambos no banco de dados",
          "height": 560,
          "width": 592
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3904,
          384
        ],
        "id": "5e686850-6293-41e6-8d9b-12f758a69e63",
        "name": "Sticky Note11"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          880,
          1600
        ],
        "id": "3beb4822-f5df-4b4d-841d-6041c9035b66",
        "name": "OpenAI Chat Model1",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "a5fc9645-25d9-4077-988f-beeb8aff47c3",
                "leftValue": "={{ $json.body.message.sender_pn }}",
                "rightValue": "19989413439",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -4048,
          128
        ],
        "id": "f1cd29ad-a0f3-47e8-833b-d28f3e96aee8",
        "name": "Ana?"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.noOp",
        "typeVersion": 1,
        "position": [
          -3824,
          -16
        ],
        "id": "df4684bc-bee0-4a97-b224-5c276aa4054e",
        "name": "No Operation, do nothing1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "0ca53349-4a2f-410c-9b0f-d37dbd8379fa",
                "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
                "rightValue": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              },
              {
                "id": "d05a2206-6355-43ae-9547-75bfa0b9be41",
                "leftValue": "={{ $('HTTP Request3').item.json.mimetype }}",
                "rightValue": "application/vnd.ms-excel",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -176,
          464
        ],
        "id": "053e7e9a-37b9-49a8-b3c0-d8332cb3acc7",
        "name": "excel?2"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.text }}",
          "needsFallback": true,
          "options": {
            "systemMessage": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber informações de algum tipo de documento financeiro, ou mais de 1 documento também, às vezes informações de vários documentos.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1 com o tipo de documento e informações relevantes\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar\n- Apenas informações mais relevantes, resumindo bastante seu output\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          272,
          1232
        ],
        "id": "4185f616-8791-4940-802b-ee2b065c6de0",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1",
            "mode": "list",
            "cachedResultName": "gpt-4.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          272,
          1600
        ],
        "id": "8ba80996-7f66-470e-8032-3e7302e09683",
        "name": "OpenAI Chat Model3",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('Merge1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file2').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "RELATÓRIO CONTAS A PAGAR"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1376,
          2224
        ],
        "id": "a49ceb32-0d18-4e93-b1b8-cc1a997a770f",
        "name": "RELATÓRIO CONTAS",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "resource": "image",
          "operation": "analyze",
          "modelId": {
            "__rl": true,
            "value": "gpt-4o",
            "mode": "list",
            "cachedResultName": "GPT-4O"
          },
          "text": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber uma imagem de algum tipo de documento financeiro ou talvez mais de 1 documento.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1 mesmo.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1, com o tipo de documento e informações relevantes.\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar.\n- Apenas informações mais relevantes, resumindo bastante seu output.\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Antes de gerar o output tenha certeza de que está passando todas informações corretamente, sem errar os números e informações.\n- Se houver uma folha em cima de outra, foque em passar as informações principais do documento que está por cima\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE.",
          "inputType": "base64",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -1616,
          -16
        ],
        "id": "a61bf8f4-a258-4ce8-8079-974cef3fb1db",
        "name": "Analyze image1",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "MV2sF6k5w8fkmTQI",
            "mode": "list",
            "cachedResultUrl": "/workflow/MV2sF6k5w8fkmTQI",
            "cachedResultName": "Faz OCR Arquivador"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            "matchingColumns": [
              "body_message_messageid"
            ],
            "schema": [
              {
                "id": "body_message_messageid",
                "displayName": "body_message_messageid",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.2,
        "position": [
          160,
          -96
        ],
        "name": "Call Faz OCR Arquivador",
        "id": "047e48c8-4558-4ead-972f-923934f01796"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "cD9AOYpxNXPlrKl1",
            "mode": "list",
            "cachedResultUrl": "/workflow/cD9AOYpxNXPlrKl1",
            "cachedResultName": "Arquiva Boletos Loop"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "NomeGrupo": "={{ $json.NomeGrupo }}",
              "id": "={{ $('Upload file2').item.json.id }}",
              "DATA": "={{ $('AI Agent').item.json.output[0].DATA }}",
              "MES": "={{ $('AI Agent').item.json.output[0].MES }}",
              "ANO": "={{ $('AI Agent').item.json.output[0].ANO }}",
              "NOME_ARQUIVO": "={{ $('AI Agent').item.json.output[0].NOME_ARQUIVO }}",
              "CODIGO_BARRAS": "={{ $('AI Agent').item.json.output[0].CODIGO_BARRAS }}",
              "folder": "={{ $('Merge1').item.json.Folder }}"
            },
            "matchingColumns": [
              "NomeGrupo",
              "id"
            ],
            "schema": [
              {
                "id": "NomeGrupo",
                "displayName": "NomeGrupo",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              },
              {
                "id": "MES",
                "displayName": "MES",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              },
              {
                "id": "ANO",
                "displayName": "ANO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              },
              {
                "id": "NOME_ARQUIVO",
                "displayName": "NOME_ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              },
              {
                "id": "CODIGO_BARRAS",
                "displayName": "CODIGO_BARRAS",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              },
              {
                "id": "folder",
                "displayName": "folder",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.2,
        "position": [
          2560,
          976
        ],
        "name": "Call Arquiva Boletos Loop",
        "id": "1d1caef0-46d6-40dc-a7b2-c2c6c5b60412"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "769b83ae-27f6-4bf0-a0c6-325e4cede6a7",
                "leftValue": "={{ $json.output[0].NOME_ARQUIVO }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "9362c41a-d7ff-4d67-9ae7-96c96be110a5",
                "leftValue": "={{ $json.output[0].ANO }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "ed9159ef-edf9-4379-a7d0-efaa2cb8f7c8",
                "leftValue": "={{ $json.output[0].MES }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "4ea17b1c-be7a-4ea3-baa1-1f8d74731ca3",
                "leftValue": "={{ $json.output[0].DATA }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2048,
          752
        ],
        "id": "94a4cbaa-eb2a-4f9c-995f-db50eea742ba",
        "name": "tem output?"
      },
      {
        "parameters": {
          "chatId": "5399986688",
          "text": "Desbloqueado com sucesso!",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          496,
          128
        ],
        "id": "392bc405-3f88-42b0-b80d-c04b3605b0e0",
        "name": "Send a text message1",
        "webhookId": "4b07c559-b2d5-4e8c-beff-8a10997611a0",
        "credentials": {
          "telegramApi": {
            "id": "ZgkuVjgKskJsBz1a",
            "name": "PASSWORD PDF"
          }
        }
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "kbfwJBar3KrSSjmM",
            "mode": "list",
            "cachedResultUrl": "/workflow/kbfwJBar3KrSSjmM",
            "cachedResultName": "UNLOCK PASSWORD"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "body_message_senderName": "={{ $('Dados de Entrada').item.json.body.message.senderName }}",
              "Nome": "={{ $('Dados de Entrada').item.json.Nome }}",
              "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}",
              "senha": "={{ $json.data.text }}"
            },
            "matchingColumns": [
              "body_message_senderName",
              "Nome",
              "body_message_messageid"
            ],
            "schema": [
              {
                "id": "body_message_senderName",
                "displayName": "body_message_senderName",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Nome",
                "displayName": "Nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "body_message_messageid",
                "displayName": "body_message_messageid",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "senha",
                "displayName": "senha",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.2,
        "position": [
          160,
          128
        ],
        "name": "Call UNLOCK PASSWORD",
        "id": "e1d1bd3e-7cb1-4063-b8d8-2d07ea99729c"
      },
      {
        "parameters": {
          "operation": "sendAndWait",
          "chatId": "5399986688",
          "message": "=PDF com senha.\nDados:\n{{ $('Dados de Entrada').item.json.Nome }}\n{{ $('Dados de Entrada').item.json.body.message.senderName }}\n\n\nDigite a senha do PDF: ",
          "responseType": "freeText",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -80,
          128
        ],
        "id": "3a95ee4d-8b04-4c81-bff5-1975e7193d22",
        "name": "Send a text message",
        "webhookId": "238ca806-a5e4-4c8d-ae35-be35bfc59f14",
        "credentials": {
          "telegramApi": {
            "id": "ZgkuVjgKskJsBz1a",
            "name": "PASSWORD PDF"
          }
        }
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "MV2sF6k5w8fkmTQI",
            "mode": "list",
            "cachedResultUrl": "/workflow/MV2sF6k5w8fkmTQI",
            "cachedResultName": "Faz OCR Arquivador"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}"
            },
            "matchingColumns": [
              "body_message_messageid"
            ],
            "schema": [
              {
                "id": "body_message_messageid",
                "displayName": "body_message_messageid",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.2,
        "position": [
          -1520,
          240
        ],
        "name": "Call Faz OCR Arquivador1",
        "id": "d7b7325f-ab0f-4188-9678-b11715664e8c"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          160,
          1504
        ],
        "id": "5e7461cb-b08d-45c1-aea3-63668677a60d",
        "name": "OpenAI Chat Model4",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-image-sharp.imageSharp",
        "typeVersion": 1,
        "position": [
          -1840,
          -240
        ],
        "id": "8e5ff5ef-3bbc-4b95-bb69-e2f6821fd9ec",
        "name": "Image Sharp"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "d0250d2a-d792-4061-a12e-e16b7a22cb47",
                "name": "Nome",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.from.first_name }} {{ $('BOT TESTE ARQUIVADOR').item.json.message.from.last_name }}",
                "type": "string"
              },
              {
                "id": "47ead40f-6450-40a6-affb-d998425b9118",
                "name": "message.message_id",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.message_id }}",
                "type": "number"
              },
              {
                "id": "fb2cff36-aa7c-4398-a400-366a5e1f9099",
                "name": "message.chat.id",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.chat.id }}",
                "type": "number"
              },
              {
                "id": "583cbd21-05ff-4dd4-849d-c947ce14efd5",
                "name": "message.document.mime_type",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data.mimeType }}",
                "type": "string"
              },
              {
                "id": "4d13bc24-8df5-475e-ae61-3f71e1d2c069",
                "name": "message.document.file_id",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.document.file_id }}",
                "type": "string"
              },
              {
                "id": "4cc13bd2-bd80-4855-8336-9b145c8b40d6",
                "name": "message.from.username",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.from.username }}",
                "type": "string"
              },
              {
                "id": "9c9fbbc3-dab9-49b6-b99f-4ac58dd0f593",
                "name": "message.text",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.text }}",
                "type": "string"
              },
              {
                "id": "468a70be-342a-4125-b609-8fb343157279",
                "name": "message.date",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.date }}",
                "type": "number"
              },
              {
                "id": "2de623e7-3c1d-418a-b50d-ee7e21baa13a",
                "name": "message.photo[0].file_id",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.json.message.photo[0].file_id }}",
                "type": "string"
              },
              {
                "id": "98f2627b-8233-44e8-86af-5ff5ba56ad41",
                "name": "idPasta",
                "value": "={{ $json.idPasta }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -4096,
          -2048
        ],
        "id": "04b1e88d-7c5d-4562-b11c-57ceb1df3fb0",
        "name": "Dados de Entrada1",
        "executeOnce": true
      },
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {
            "download": true
          }
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.2,
        "position": [
          -4704,
          -2048
        ],
        "id": "03d0f711-1600-4118-a52d-71778ed8772a",
        "name": "BOT TESTE ARQUIVADOR",
        "webhookId": "f4d5e926-d817-4752-8352-ad09d45ae25c",
        "credentials": {
          "telegramApi": {
            "id": "hrz1IfYY7JE7R1Pj",
            "name": "ARQUIVADOR KYBERNAN"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "TvERETBAGi000bZb",
            "mode": "list",
            "cachedResultName": "DadosClienteKybernan",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/TvERETBAGi000bZb"
          },
          "filters": {
            "conditions": [
              {
                "keyName": "Folder",
                "keyValue": "={{ $json.idPasta }}"
              }
            ]
          },
          "returnAll": true
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          -3680,
          -2048
        ],
        "id": "435c85b2-ede6-4d73-86fd-1c39e5061a20",
        "name": "Get row(s)2",
        "executeOnce": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "c9d48431-6205-4d71-9d24-346dfe880a25",
                "name": "IdGroup",
                "value": "={{ $json.IdGroup }}",
                "type": "string"
              },
              {
                "id": "46b09227-842e-44df-95f7-4819cc47f958",
                "name": "phone1",
                "value": "={{ $json.phone1 }}",
                "type": "string"
              },
              {
                "id": "91d9c47f-3e9a-4344-86e6-f5124490957f",
                "name": "phone2",
                "value": "={{ $json.phone2 }}",
                "type": "string"
              },
              {
                "id": "0c9bc12c-ca1e-4f6c-ba7b-c33a6fa84fe6",
                "name": "phone3",
                "value": "={{ $json.phone3 }}",
                "type": "string"
              },
              {
                "id": "4b1803fd-3a6e-463d-b63e-8b37605cdc9e",
                "name": "email",
                "value": "={{ $json.email }}",
                "type": "string"
              },
              {
                "id": "a8310a6c-4a6f-4151-878f-edf87ef8f06e",
                "name": "Folder",
                "value": "={{ $json.Folder }}",
                "type": "string"
              },
              {
                "id": "f6f759e7-b7cf-4081-93d3-362cf3b2ffd8",
                "name": "apiERP",
                "value": "={{ $json.apiERP }}",
                "type": "string"
              },
              {
                "id": "61b97bff-04e1-4870-8c6e-0286ac545ed1",
                "name": "ERP",
                "value": "={{ $json.ERP }}",
                "type": "string"
              },
              {
                "id": "630f0159-3b5e-48c4-aa49-4eeb0af3b2de",
                "name": "NomeGrupo",
                "value": "={{ $json.NomeGrupo }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3312,
          -2048
        ],
        "id": "25f4cd3a-74c1-4b9e-9dcf-cea692b12689",
        "name": "DADOS USUÁRIO1",
        "executeOnce": true
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "6dc571f3-1d8c-4784-8cfa-d29f807666f7",
                      "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                      "rightValue": "application/pdf",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "PDF"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "0136ec3e-63c4-40cb-ad13-4d36e1378ccf",
                      "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                      "rightValue": "=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "EXCEL"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "7a88511a-7a3c-442d-bad5-fc9aa48d5a18",
                      "leftValue": "={{ $('Dados de Entrada1').item.json.message.document.mime_type }}",
                      "rightValue": "image/jpeg",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "IMAGEM"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.3,
        "position": [
          -2944,
          -2064
        ],
        "id": "409019de-24a8-4d4f-87d7-902365f6f4ca",
        "name": "tipoMsg1",
        "executeOnce": true
      },
      {
        "parameters": {
          "resource": "image",
          "operation": "analyze",
          "modelId": {
            "__rl": true,
            "value": "gpt-4o",
            "mode": "list",
            "cachedResultName": "GPT-4O"
          },
          "text": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber uma imagem de algum tipo de documento financeiro ou talvez mais de 1 documento.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1 mesmo.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1, com o tipo de documento e informações relevantes.\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar.\n- Apenas informações mais relevantes, resumindo bastante seu output.\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Antes de gerar o output tenha certeza de que está passando todas informações corretamente, sem errar os números e informações.\n- Se houver uma folha em cima de outra, foque em passar as informações principais do documento que está por cima\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE.",
          "inputType": "base64",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -2096,
          -1872
        ],
        "id": "f1566b25-029c-48c3-8a6c-c2f57bfd789c",
        "name": "Analyze image2",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
                "name": "data",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
                "type": "binary"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -2688,
          -1904
        ],
        "id": "c211f6e7-b1ed-4aa7-b862-29c3d6f8689e",
        "name": "Binario"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "cc623d92-90a9-4c53-a977-960b80305e27",
                "name": "text",
                "value": "={{ $json.text || $json['0'].content[0].text || $json['0'].content[0].text }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -816,
          -2048
        ],
        "id": "b86fd792-bd33-448c-adb1-4b004320a0dd",
        "name": "Edit Fields1",
        "executeOnce": true
      },
      {
        "parameters": {
          "operation": "pdf",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1.1,
        "position": [
          -2320,
          -2528
        ],
        "id": "b1ead5dd-3491-400b-864b-cbf942cdf709",
        "name": "Extract from File2",
        "alwaysOutputData": false,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "75f8e189-a085-4dad-9650-bc8f10936fc0",
                "leftValue": "={{ Number($json.text.length) }}",
                "rightValue": 20,
                "operator": {
                  "type": "number",
                  "operation": "lt"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -2176,
          -2688
        ],
        "id": "0d1b1ba9-355c-4e98-a1bf-c23256327f6f",
        "name": "Menos que 20 caracteres2"
      },
      {
        "parameters": {
          "chatId": "5399986688",
          "text": "Desbloqueado com sucesso!",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -1296,
          -2512
        ],
        "id": "85da2b66-3a86-48e7-90ad-08d66e61deb5",
        "name": "Send a text message2",
        "webhookId": "4b07c559-b2d5-4e8c-beff-8a10997611a0",
        "credentials": {
          "telegramApi": {
            "id": "ZgkuVjgKskJsBz1a",
            "name": "PASSWORD PDF"
          }
        }
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "kbfwJBar3KrSSjmM",
            "mode": "list",
            "cachedResultUrl": "/workflow/kbfwJBar3KrSSjmM",
            "cachedResultName": "UNLOCK PASSWORD"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "body_message_senderName": "={{ $('Dados de Entrada').item.json.body.message.senderName }}",
              "Nome": "={{ $('Dados de Entrada').item.json.Nome }}",
              "body_message_messageid": "={{ $('Dados de Entrada').item.json.body.message.messageid }}",
              "senha": "={{ $json.data.text }}"
            },
            "matchingColumns": [
              "body_message_senderName",
              "Nome",
              "body_message_messageid"
            ],
            "schema": [
              {
                "id": "body_message_senderName",
                "displayName": "body_message_senderName",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Nome",
                "displayName": "Nome",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "body_message_messageid",
                "displayName": "body_message_messageid",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "senha",
                "displayName": "senha",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "string",
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.2,
        "position": [
          -1600,
          -2512
        ],
        "name": "Call UNLOCK PASSWORD1",
        "id": "a5c3fe82-8ea3-40fe-b27f-b0379b8b0264"
      },
      {
        "parameters": {
          "operation": "sendAndWait",
          "chatId": "5399986688",
          "message": "=PDF com senha.\nDados:\n{{ $('Dados de Entrada').item.json.Nome }}\n{{ $('Dados de Entrada').item.json.body.message.senderName }}\n\n\nDigite a senha do PDF: ",
          "responseType": "freeText",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -1936,
          -2512
        ],
        "id": "d6b93091-c0c1-4436-8002-0b81bac4cd97",
        "name": "Send a text message3",
        "webhookId": "238ca806-a5e4-4c8d-ae35-be35bfc59f14",
        "credentials": {
          "telegramApi": {
            "id": "ZgkuVjgKskJsBz1a",
            "name": "PASSWORD PDF"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
                "name": "data",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
                "type": "binary"
              },
              {
                "id": "ebee3920-7f16-4264-9605-5e6066ad1638",
                "name": "",
                "value": "",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -2688,
          -2368
        ],
        "id": "3afb4290-a96f-427f-8c92-adb665c12c85",
        "name": "Binario1"
      },
      {
        "parameters": {
          "name": "arquivo",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0",
            "mode": "list",
            "cachedResultName": "ARQUIVOS RECEBIDOS KYBERNAN TESTE",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1kNfMrXJtz3jlu9lXqhDxa1nXuLa4b0v0"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          -800,
          -2240
        ],
        "id": "5d0f2870-c467-48d7-a99b-c8fefd4c9004",
        "name": "Upload file",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -320,
          -2144
        ],
        "id": "14b624f1-cd90-4fb3-9709-de52cf17ea41",
        "name": "Merge",
        "executeOnce": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "http://kybernan_gotenberg:3000/forms/libreoffice/convert",
          "sendBody": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "landscape",
                "value": "true"
              },
              {
                "parameterType": "formBinaryData",
                "name": "files",
                "inputDataFieldName": "data"
              },
              {
                "name": "addOriginalDocumentAsStream",
                "value": "false"
              }
            ]
          },
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2480,
          -2224
        ],
        "id": "b4329e90-48fc-4807-bdea-99a156f3f4e2",
        "name": "HTTP Request7"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "f304a52c-28f5-4730-86c4-9eea659f913e",
                "name": "data",
                "value": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}",
                "type": "binary"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -2672,
          -2112
        ],
        "id": "24fd2732-8ac3-439e-a7f5-974603230d75",
        "name": "Binario2"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.ilovepdf.com/v1/auth",
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "public_key",
                "value": "project_public_6e99f304b7b0f32194a219829ae0da16_1TjZUf8d65af7f20c2bb97ef86ef511d10f50"
              },
              {
                "name": "secret_key",
                "value": "secret_key_2b4e29231feda1bacf76a575828fdba7_8l_xca3740dd3253a8b56bbc5e54cd6c1664f"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -2016,
          -2960
        ],
        "id": "99bd8f80-58cf-429e-b7ba-0df04fabe7b9",
        "name": "Gerar JWT"
      },
      {
        "parameters": {
          "url": "https://api.ilovepdf.com/v1/start/pdfocr",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $json.token }}"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {}
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1824,
          -2960
        ],
        "id": "4d314f38-57a9-4a86-903a-cf16a457052e",
        "name": "CriaTarefaOcr"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://{{ $json.server }}/v1/upload",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
              }
            ]
          },
          "sendBody": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "task",
                "value": "={{ $json.task }}"
              },
              {
                "parameterType": "formBinaryData",
                "name": "file",
                "inputDataFieldName": "={{ $('BOT TESTE ARQUIVADOR').item.binary.data }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1584,
          -2960
        ],
        "id": "138cb363-35d8-44e3-b865-ee7e9c9d9e2d",
        "name": "UploadPdf"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://{{ $('CriaTarefaOcr').item.json.server }}/v1/process",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"task\": \"{{ $('CriaTarefaOcr').item.json.task }}\",\n  \"tool\": \"pdfocr\",\n  \"files\": [\n    {\n      \"server_filename\": \"{{ $json.server_filename }}\",\n      \"filename\": \"file\"\n    }\n  ],\n  \"ocr_languages\": [\n    \"por\"\n  ]\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1424,
          -2960
        ],
        "id": "3c779c81-6129-4c3b-9773-9dcf8d7bca93",
        "name": "ProcessPdfToOcr"
      },
      {
        "parameters": {
          "url": "=https://{{ $('CriaTarefaOcr').item.json.server }}/v1/download/{{ $('CriaTarefaOcr').item.json.task }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Gerar JWT').item.json.token }}"
              }
            ]
          },
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1184,
          -2960
        ],
        "id": "47bc8f4f-8c4f-4930-b8df-8d1c359e629b",
        "name": "DownloadPdfOcr"
      },
      {
        "parameters": {
          "operation": "pdf",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1.1,
        "position": [
          -1088,
          -2512
        ],
        "id": "b39cd339-7a01-47e7-995f-a6916891951a",
        "name": "Extract from File3"
      },
      {
        "parameters": {
          "inputText": "={{ $json.output }}",
          "categories": {
            "categories": [
              {
                "category": "Boletos-Guias",
                "description": "Selecione esta opção se o texto contiver instrumentos de cobrança ou pagamento. Procure por \"Linha digitável\", \"Código de barras\", \"Boleto bancário\", \"Vencimento\", \"Pix copia e cola\", \"qr code\" ou \"Valor do documento\", não precisa ter todas estas informações, são apenas dicas de como entender que é um boleto ou guia. O objetivo principal é classificar boletos bancários ou guias como Boletos-Guias"
              },
              {
                "category": "Nota-Fiscal",
                "description": "Selecione esta opção se o texto contiver dados de uma Nota Fiscal, DANFE, Cupom ou NFS-e. Procure por termos como \"Chave de Acesso\", \"Natureza da Operação\", \"DANFE\", \"Conhecimento de Transporte Eletrônico (CT-e) – Modal Rodoviário\" ou detalhes de produtos e impostos. Marque como verdadeiro mesmo que haja um boleto junto."
              },
              {
                "category": "holerites",
                "description": "HOLERITES "
              },
              {
                "category": "recibos",
                "description": "RECIBOS"
              },
              {
                "category": "comprovantePagamento",
                "description": "comprovante de pagamento de boletos ou comprovantes de agendamento"
              },
              {
                "category": "cheque",
                "description": "CHEQUES"
              },
              {
                "category": "comprovantePixTransferencia",
                "description": "comprovante de transferência ou pix ou comprovante de agendamento de pix e ted"
              },
              {
                "category": "pedidoDeCompra",
                "description": "Pedido de compra"
              },
              {
                "category": "relatórioDiversasContasAPagar",
                "description": "Relatório de contas a pagar, não uma conta específica mas um relatório completo."
              }
            ]
          },
          "options": {
            "multiClass": true,
            "fallback": "other",
            "systemPromptTemplate": "=# Role\nVocê é um classificador especialista em triagem de documentos financeiros e contábeis. Sua prioridade é identificar corretamente instrumentos de cobrança e fiscais.\n\n# Input Analysis\nO texto de entrada é um resumo extraído de documentos via OCR.\nO input pode conter:\n1. Um único documento isolado.\n2. Múltiplos documentos concatenados (ex: Uma Nota Fiscal seguida do seu Boleto bancário).\n\n# Rules for Classification\n\n1. **REGRA DE OURO (BOLETOS):**\n   - Se o texto contiver a frase \"Boleto bancário\", \"Linha digitável\", \"Código de barras\" OU \"Nosso número\", classifique AUTOMATICAMENTE como \"Boletos-Guias\".\n   - **Atenção:** Não exija a presença de \"Pix\" ou \"QR Code\". Se tiver apenas a linha digitável, JÁ É um boleto.\n\n2. **DIFERENÇA CRÍTICA (A PAGAR vs PAGO):**\n   - Se tem \"Vencimento\" e é uma cobrança -> Classifique como \"Boletos-Guias\".\n   - Se tem \"Autenticação\", \"Comprovante de Operação\" ou \"Pagamento efetuado\" -> Classifique como \"comprovantePagamento\".\n\n3. **REGRA DO COMBO (MULTI-CLASS):**\n   - Se o texto contiver dados de Nota Fiscal (DANFE, Chave de acesso) **E** dados de Boleto (Linha digitável), você **DEVE** marcar AMBAS as categorias (\"Nota-Fiscal\" E \"Boletos-Guias\") como verdadeiras.\n   - Não escolha apenas um se os dois existirem no texto.\n\n4. **EVITAR \"OUTROS\":**\n   - Use a categoria \"Outros\" APENAS se o documento for ilegível ou não tiver nenhuma relação com finanças/contabilidade. Na dúvida entre \"Outros\" e \"Boletos-Guias\", escolha \"Boletos-Guias\".\n\n# Step-by-Step Thinking\n1. O texto diz explicitamente \"Tipo de documento: Boleto bancário\"? Se SIM -> Marque \"Boletos-Guias\" imediatamente.\n2. O texto possui uma linha digitável numérica longa? Se SIM -> Marque \"Boletos-Guias\".\n3. O texto possui chave de acesso de 44 dígitos ou diz \"DANFE\"? Se SIM -> Marque \"Nota-Fiscal\".\n4. Verificação final: É apenas um comprovante de que a conta já foi paga (tem autenticação bancária)? Se SIM, classifique como \"comprovantePagamento\" e ignore \"Boletos-Guias\". Se for a conta original para pagar, mantenha \"Boletos-Guias\".\n5. Se o tipo de documento for Boleto bancário, classifique como \"Boletos-Guias\"",
            "enableAutoFixing": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.textClassifier",
        "typeVersion": 1.1,
        "position": [
          912,
          -2256
        ],
        "id": "b296af95-37b3-4d5e-b9fa-63310fa6c736",
        "name": "Text Classifier1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $('AI Agent3').item.json.output }}",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=Analise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE o seguinte JSON:\n\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n1. Em \"NOME_ARQUIVO\", use o número do mês (ex: 01, 02) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n2. Priorize a data de VENCIMENTO encontrada.\n3. Não inclua markdown, apenas o JSON puro.\n4. Exemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico)\n5. Se tiver nota fiscal com boletos, ignore a nota fiscal e extraia os dados apenas dos boletos\n6. Se a data de vencimento for a mesma, não extrair mais de uma vez os dados, extrair 1 vez apenas e neste caso o nome do arquivo coloque \"DD.MM - DIVERSOS FORNECEDORES\" se houver mais de um na mesma data.\n7. Sempre que houver código de barras de um determinado boleto, também extraia o valor, só números, tenha certeza de que está informando o código inteiro e o número está correto.\n\nAnalise o texto financeiro fornecido e extraia os dados para retornar EXATAMENTE um ARRAY JSON contendo um ou mais objetos, no seguinte formato.\n\nSe for encontrada apenas UMA data de vencimento/pagamento (indicando um único boleto ou conta), o retorno DEVE ser um array contendo um único objeto.\nSe for encontrada MAIS DE UMA data de vencimento/pagamento (indicando múltiplos boletos ou contas), o retorno DEVE ser um array JSON contendo um objeto para cada boleto/conta individual.\n\nEstrutura do Objeto (dentro do Array):\n{\n  \"DATA\": \"Dia com 2 dígitos (DD)\",\n  \"MES\": \"Mês abreviado em maiúsculo (JAN, FEV, MAR, ABR, MAI, JUN, JUL, AGO, SET, OUT, NOV, DEZ)\",\n  \"ANO\": \"Ano com 4 dígitos (AAAA)\",\n  \"NOME_ARQUIVO\": \"DIA.MÊS_NUMÉRICO - NOME_DO_FORNECEDOR_CENDETE\",\n  \"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n\nRegras:\n\nEm \"NOME_ARQUIVO\", use o número do mês com dois dígitos (ex: 01, 02, ..., 12) e o nome da empresa que irá receber os valores, ou seja, nome do beneficiário em maiúsculo.\n\nPriorize a data de VENCIMENTO encontrada.\n\nExemplo para NOME_ARQUIVO: \"10.11 - ALIBRA\" (Sendo 10 o DIA e 11 o MÊS numérico).\n\nExemplo de Saída (Múltiplos Boletos):\n[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\nExemplo de Saída (Boleto Único):\n[\n{\n\"DATA\": \"15\",\n\"MES\": \"SET\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"15.09 - AGUA_LIMPA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]\n\n## RULES\n- NUNCA, JAMAIS, erre informações, tenha certeza das datas, dia, mês e ANO\n- Se houver documentos que não sejam boletos ou contas a pagar, ignore, apenas siga com a extração de informações para contas a pagar, boletos, etc...\n- O nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE, utilize este nome para nomear o arquivo."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          1744,
          -2624
        ],
        "id": "be1b5b8a-3e3a-4d6e-9cca-feab72c0c192",
        "name": "AI Agent2",
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-5.1",
            "mode": "list",
            "cachedResultName": "gpt-5.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          1728,
          -2384
        ],
        "id": "d94bd99a-e431-42f8-8b74-8339b81d2313",
        "name": "OpenAI Chat Model5",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "jsonSchemaExample": "[\n{\n\"DATA\": \"10\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"10.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n},\n{\n\"DATA\": \"17\",\n\"MES\": \"NOV\",\n\"ANO\": \"2025\",\n\"NOME_ARQUIVO\": \"17.11 - ALIBRA\",\n\"CODIGO_BARRAS\": \"número completo exato do código só números\"\n}\n]",
          "autoFix": true
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          1936,
          -2448
        ],
        "id": "0082d95c-4faf-4e8e-af79-c39e48c4b389",
        "name": "Structured Output Parser1"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "PEDIDO COMPRA"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1328
        ],
        "id": "66017642-c217-47a0-9449-1ad710946f4d",
        "name": "PEDIDO COMPRA1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "HOLERITES"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -2128
        ],
        "id": "6af268c6-9586-4def-81a7-9df5cfebf552",
        "name": "HOLERITES1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "RECIBOS"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1984
        ],
        "id": "3aa6280f-2b38-4420-9dd5-a5041b9691c5",
        "name": "RECIBOS1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "COMPROVANTE PAGAMENTO"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1840
        ],
        "id": "182ee853-59fb-4e8a-aa65-88eaa2a2ee61",
        "name": "COMPROVANTE PAGAMENTO1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "CHEQUES"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1664
        ],
        "id": "547925f2-1675-4e09-a4d7-711521a31fe0",
        "name": "CHEQUES1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NÃO SALVO",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "TRANSFERENCIA PIX"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1504
        ],
        "id": "80a3777a-37cf-41a6-8530-ce58bebcbc7f",
        "name": "TRANSFERENCIA PIX1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "NÃO IDENTIFICADO"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -992
        ],
        "id": "ee062d76-1edc-43e2-89cc-5af283d85311",
        "name": "OUTROS1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "content": "## Classificador",
          "height": 1504,
          "width": 752
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          656,
          -2336
        ],
        "id": "a2da1b57-17de-4879-926a-6aa60ff9aa58",
        "name": "Sticky Note13"
      },
      {
        "parameters": {
          "content": "## Boletos",
          "height": 544,
          "width": 1184
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1680,
          -2720
        ],
        "id": "be4a5baa-57a8-4955-b0f5-1927cacb1370",
        "name": "Sticky Note14"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1",
            "mode": "list",
            "cachedResultName": "gpt-4.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          1936,
          -2320
        ],
        "id": "6b4578cf-19ac-4da2-a89e-4fc23854e480",
        "name": "OpenAI Chat Model6",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "fieldToSplitOut": "output",
          "options": {}
        },
        "type": "n8n-nodes-base.splitOut",
        "typeVersion": 1,
        "position": [
          2416,
          -2640
        ],
        "id": "7b0d448b-63c9-4949-b75f-c38126edb015",
        "name": "Split Out1"
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "={{ $('Upload file').item.json.id }}",
            "mode": "id"
          },
          "name": "={{ (new Date()).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }).replace(/\\//g, '.') }} - {{ $('DADOS USUÁRIO1').item.json.NomeGrupo }} - (SALVADO POR IA)",
          "sameFolder": false,
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "=12JepBiCyidTjZknzUgb8yVOFHZF-Q6Ro",
            "mode": "id"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          1936,
          -1840
        ],
        "id": "d15684eb-ff05-49a9-8e7f-173f785b9626",
        "name": "Copy file",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "TIPO DE ARQUIVO": "NOTA FISCAL",
              "CAMINHO QUE FOI SALVO": "=PASTA DE NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -2272
        ],
        "id": "cdfa1f70-f813-48be-8c3a-3a92fde0b4f6",
        "name": "NOTA FISCAL1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          928,
          -1776
        ],
        "id": "3fc9f299-5408-42b3-a924-5f309f703f16",
        "name": "OpenAI Chat Model7",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.text }}",
          "needsFallback": true,
          "options": {
            "systemMessage": "=# Roles:\n- Você é um limpador de informações desnecessárias, extraindo apenas o mais importante e classificando o tipo de documento.\n\n## Context:\n- Você irá receber informações de algum tipo de documento financeiro, ou mais de 1 documento também, às vezes informações de vários documentos.\n\n## Task:\n\n### Etapa 1:\n- Entenda e identifique se existe mais de 1 documento ou apenas 1.\n\n### Etapa 2:\n- Entenda e identifique cada tipo de documento, exemplos: Boletos, Contas a pagar, Contas a receber, Nota fiscal, Cupom fiscal, Holerites, Comprovantes, Cheques, Transferencias, entre outros...\n\n### Etapa 3:\n- Extraia as informações mais importantes para cada documento, exemplo, para cada boleto as informações principais são, data de vencimento, codigo de barras, nome do beneficiário (recebedor)...\n- Gere um relatório informando as informações mais relevantes para cada documento.\n\n## Rules:\n- Não informe as etapas, apenas crie o relatório extraindo as informações para cada documento se houver mais de 1 com o tipo de documento e informações relevantes\n- Se for um único documento com várias contas à pagar juntas, apenas faça um resumo simples informando que é um relatório de contas a pagar completo e que deve ser classificado como relatório de contas a pagar\n- Apenas informações mais relevantes, resumindo bastante seu output\n- Sempre que houver código de barras no boleto é obrigatório informar.\n- Quando for boleto, o nome do fornecedor é o que emitiu e está cobrando o boleto, normalmente está como CEDENTE."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          320,
          -2144
        ],
        "id": "2b4946e9-1b0b-4fc8-b683-a02b05c2ff81",
        "name": "AI Agent3",
        "executeOnce": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1",
            "mode": "list",
            "cachedResultName": "gpt-4.1"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          320,
          -1776
        ],
        "id": "c5da0635-720c-4797-ac3f-74aedee700b0",
        "name": "OpenAI Chat Model8",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('hh:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "=NOTAS FISCAIS",
              "LINK ARQUIVO": "={{ $('Upload file').item.json.webViewLink }}",
              "TIPO DE ARQUIVO": "RELATÓRIO CONTAS A PAGAR"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1424,
          -1152
        ],
        "id": "2981dcc0-ba60-40cd-b4cb-606e3b18c8a5",
        "name": "RELATÓRIO CONTAS1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "769b83ae-27f6-4bf0-a0c6-325e4cede6a7",
                "leftValue": "={{ $json.output[0].NOME_ARQUIVO }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "9362c41a-d7ff-4d67-9ae7-96c96be110a5",
                "leftValue": "={{ $json.output[0].ANO }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "ed9159ef-edf9-4379-a7d0-efaa2cb8f7c8",
                "leftValue": "={{ $json.output[0].MES }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              },
              {
                "id": "4ea17b1c-be7a-4ea3-baa1-1f8d74731ca3",
                "leftValue": "={{ $json.output[0].DATA }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2096,
          -2624
        ],
        "id": "cebe3a51-3379-428c-8168-515c71bf8643",
        "name": "tem output?1"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          208,
          -1872
        ],
        "id": "716f729e-f3c6-4332-b844-cc79ef975c56",
        "name": "OpenAI Chat Model9",
        "credentials": {
          "openAiApi": {
            "id": "fRrIyxCKgTlReSWb",
            "name": "Kybernan-Arquivador"
          }
        }
      },
      {
        "parameters": {
          "dataTableId": {
            "__rl": true,
            "value": "hF9yxdAPWHZWy2CV",
            "mode": "list",
            "cachedResultName": "CODIGO DE BARRAS",
            "cachedResultUrl": "/projects/72MghKyBe7pL4bex/datatables/hF9yxdAPWHZWy2CV"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "idPasta": "={{ $('idPastaDia').item.json.id }}",
              "codBarras": "={{ $('Loop Over Items').item.json.CODIGO_BARRAS }}",
              "nomeArquivo": "={{ $('Loop Over Items').item.json.NOME_ARQUIVO }} - COMPROVANTE (ARQUIVADO POR IA)"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "codBarras",
                "displayName": "codBarras",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "idPasta",
                "displayName": "idPasta",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "nomeArquivo",
                "displayName": "nomeArquivo",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          6480,
          -2160
        ],
        "id": "cbefdc7c-44d4-4f11-b614-4e573bec1a09",
        "name": "Insert row"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ",
            "mode": "list",
            "cachedResultName": "LOG ARQUIVOS",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Página1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-MrdPnHE7cmjj_D7spbWq2u0CkatoBgCqvja3aHv4BQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "DATA": "={{ $today.format('dd-MM-yyyy') }}",
              "HORA": "={{ $now.format('HH:mm') }}",
              "CLIENTE": "={{ $('DADOS USUÁRIO1').item.json.NomeGrupo }}",
              "CAMINHO QUE FOI SALVO": "={{ $('Loop Over Items').item.json.ANO }} -> {{ $('Loop Over Items').item.json.MES }} -> {{ $('Loop Over Items').item.json.DATA }}",
              "LINK ARQUIVO": "=https://drive.google.com/file/d/{{ $json.id }}/view",
              "TIPO DE ARQUIVO": "BOLETO"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "DATA",
                "displayName": "DATA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "HORA",
                "displayName": "HORA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CLIENTE",
                "displayName": "CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "TIPO DE ARQUIVO",
                "displayName": "TIPO DE ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "LINK ARQUIVO",
                "displayName": "LINK ARQUIVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "CAMINHO QUE FOI SALVO",
                "displayName": "CAMINHO QUE FOI SALVO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          6256,
          -2176
        ],
        "id": "ef10ba0b-19ff-4f93-9a4a-06cb7ebad86f",
        "name": "log arquivos1",
        "executeOnce": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vwb992tcodcaklq5",
            "name": "KyberTech"
          }
        }
      },
      {
        "parameters": {
          "resource": "folder",
          "name": "={{ $('Loop Over Items').item.json.MES }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "={{ $('idPastaAno').item.json.id }}",
            "mode": "id"
          },
          "options": {
            "simplifyOutput": true
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4976,
          -2176
        ],
        "id": "54b2bd79-4928-4e98-ba28-b4f2716c10ef",
        "name": "Cria Pasta Mes",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "resource": "folder",
          "name": "={{ $('Loop Over Items').item.json.ANO }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "={{ $('encontraControle').item.json.id }}",
            "mode": "id"
          },
          "options": {
            "simplifyOutput": true
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4112,
          -2240
        ],
        "id": "4e5d7e65-7b84-4ef7-b813-3d5969f2ab3e",
        "name": "Cria Pasta Ano",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "resource": "folder",
          "name": "={{ $('Loop Over Items').item.json.DATA }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "={{ $('idPastaMes').item.json.id }}",
            "mode": "id"
          },
          "options": {
            "simplifyOutput": true
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          5856,
          -2192
        ],
        "id": "bbefe2ae-dd1c-4614-b254-0383398945bc",
        "name": "Cria Pasta Dia",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "resource": "fileFolder",
          "searchMethod": "query",
          "queryString": "name contains 'controle'",
          "returnAll": true,
          "filter": {
            "folderId": {
              "__rl": true,
              "value": "={{ $('Dados de Entrada1').item.json.idPasta }}",
              "mode": "id"
            },
            "whatToSearch": "folders"
          },
          "options": {
            "fields": [
              "id",
              "name"
            ]
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          3392,
          -2384
        ],
        "id": "a88e5964-6b4d-4e81-b709-e510548b5552",
        "name": "encontraControle",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "resource": "fileFolder",
          "searchMethod": "query",
          "queryString": "=name contains '{{ $('Loop Over Items').item.json.ANO }}'",
          "returnAll": true,
          "filter": {
            "folderId": {
              "__rl": true,
              "value": "={{ $json.id }}",
              "mode": "id"
            },
            "whatToSearch": "folders"
          },
          "options": {
            "fields": [
              "id",
              "name"
            ]
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          3680,
          -2384
        ],
        "id": "ecdc2c41-dc9f-45e4-a320-674a5746b50a",
        "name": "encontraAno",
        "alwaysOutputData": true,
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
                "leftValue": "={{ $json }}",
                "rightValue": "",
                "operator": {
                  "type": "object",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3952,
          -2384
        ],
        "id": "ee4ac024-6782-41c0-85af-a21514dc63c9",
        "name": "PastaDiaExiste?2"
      },
      {
        "parameters": {
          "resource": "fileFolder",
          "searchMethod": "query",
          "queryString": "=name contains '{{ $('Loop Over Items').item.json.MES }}'",
          "returnAll": true,
          "filter": {
            "folderId": {
              "__rl": true,
              "value": "={{ $json.id }}",
              "mode": "id"
            },
            "whatToSearch": "folders"
          },
          "options": {
            "fields": [
              "id",
              "name"
            ]
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4544,
          -2400
        ],
        "id": "198d285b-e503-4d2f-a19b-630b5a04b273",
        "name": "encontraMês",
        "alwaysOutputData": true,
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
                "leftValue": "={{ $json }}",
                "rightValue": "",
                "operator": {
                  "type": "object",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          4832,
          -2400
        ],
        "id": "1bc971f3-b861-4399-88b1-7c9374f199db",
        "name": "PastaDiaExiste?1"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
                "name": "id",
                "value": "={{ $json.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          4256,
          -2400
        ],
        "id": "abd5bdc7-b35c-4735-b977-fbee2675e7a4",
        "name": "idPastaAno",
        "executeOnce": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3072,
          -2400
        ],
        "id": "2f09c1f7-134e-46e8-8d01-c4f78924d7c9",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "resource": "fileFolder",
          "searchMethod": "query",
          "queryString": "=name contains '{{ $('Loop Over Items').item.json.DATA }}'",
          "returnAll": true,
          "filter": {
            "folderId": {
              "__rl": true,
              "value": "={{ $json.id }}",
              "mode": "id"
            },
            "whatToSearch": "folders"
          },
          "options": {
            "fields": [
              "id",
              "name"
            ]
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          5376,
          -2416
        ],
        "id": "24de48f0-3ee0-4900-ad8c-604a04ee83b5",
        "name": "encontraDia",
        "alwaysOutputData": true,
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "ea5837ba-5aa9-42b0-bfda-da89345ec33e",
                "leftValue": "={{ $json }}",
                "rightValue": "",
                "operator": {
                  "type": "object",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          5664,
          -2416
        ],
        "id": "5f3022f0-dcbb-4522-8c40-0a24b15c9ce4",
        "name": "PastaDiaExiste?"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
                "name": "id",
                "value": "={{ $json.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          5104,
          -2416
        ],
        "id": "1cf556c2-2030-4e12-96d1-faba52e61a4b",
        "name": "idPastaMes",
        "executeOnce": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "bbdfcb0e-b11a-4cb9-ae83-00547a243bf0",
                "name": "id",
                "value": "={{ $json.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          6000,
          -2416
        ],
        "id": "4a8af02a-6dea-4228-bb2f-fed044d33327",
        "name": "idPastaDia",
        "executeOnce": true
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.noOp",
        "typeVersion": 1,
        "position": [
          3376,
          -2688
        ],
        "id": "5ec946c3-c685-4ef8-8c48-cff4381f783d",
        "name": "No Operation, do nothing"
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "={{ $('Upload file').item.json.id }}",
            "mode": "id"
          },
          "name": "={{ $('Loop Over Items').item.json.NOME_ARQUIVO }} (ARQUIVADO POR IA)",
          "sameFolder": false,
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          6240,
          -2432
        ],
        "id": "98bf1c10-af63-41be-b880-0a74de955722",
        "name": "Copy file2",
        "executeOnce": true,
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "tHbNUSv81dsDoIWb",
            "name": "Kybernan-BPO"
          }
        }
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          5728,
          -2192
        ],
        "id": "b60e2b09-2233-4e09-9b1c-8d93813db524",
        "name": "Merge3",
        "executeOnce": true
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          4832,
          -2176
        ],
        "id": "3646a208-ead4-4995-a4ce-4a4ad24fa700",
        "name": "Merge4",
        "executeOnce": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "9dade1e0-c87d-48f3-bac9-8c0c8952aa24",
                "name": "idPasta",
                "value": "147ox1Et8WQqYIPsDRdTVBDED2k93md3P",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -4416,
          -2048
        ],
        "id": "5145a4ac-0b02-4325-b340-7a3f925b3553",
        "name": "Edit Fields2"
      }
    ],
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "Dados de Entrada",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "isGroup": {
        "main": [
          [
            {
              "node": "Get row(s)",
              "type": "main",
              "index": 0
            },
            {
              "node": "ExisteGrupoTabela False",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "normalizaNumero",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "tipoMsg": {
        "main": [
          [],
          [],
          [],
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ExisteGrupoTabela False": {
        "main": [
          [
            {
              "node": "Insere Novo Row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Insere Novo Row": {
        "main": [
          [
            {
              "node": "DADOS USUÁRIO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)": {
        "main": [
          [
            {
              "node": "DADOS USUÁRIO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File": {
        "main": [
          [
            {
              "node": "Menos que 20 caracteres1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Convert to File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Convert to File2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File1": {
        "main": [
          [
            {
              "node": "Call Faz OCR Arquivador1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Analyze image1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File2": {
        "main": [
          [
            {
              "node": "excel?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Text Classifier": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "NOTA FISCAL",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HOLERITES",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RECIBOS",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "COMPROVANTE PAGAMENTO",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "CHEQUES",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "TRANSFERENCIA PIX",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "PEDIDO COMPRA",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RELATÓRIO CONTAS",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "OUTROS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "tem output?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DADOS USUÁRIO": {
        "main": [
          [
            {
              "node": "temPasta",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File1": {
        "main": [
          [
            {
              "node": "Menos que 20 caracteres",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send a text message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "temPasta": {
        "main": [
          [
            {
              "node": "tipoMsg",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Dados de Entrada": {
        "main": [
          [
            {
              "node": "Ana?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload file2": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "excel?": {
        "main": [
          [
            {
              "node": "HTTP Request5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Extract from File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "excel?2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Upload file2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract from File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Structured Output Parser",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Merge2",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Copy file1": {
        "main": [
          []
        ]
      },
      "Merge2": {
        "main": [
          [
            {
              "node": "Call Arquiva Boletos Loop",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request5": {
        "main": [
          [
            {
              "node": "Extract from File1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze image": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request6": {
        "main": [
          [
            {
              "node": "Convert to File4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File4": {
        "main": [
          [
            {
              "node": "Analyze image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "NOTA FISCAL": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OUTROS": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HOLERITES": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RECIBOS": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "CHEQUES": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "PEDIDO COMPRA": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Menos que 20 caracteres": {
        "main": [
          [
            {
              "node": "Call Faz OCR Arquivador",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Menos que 20 caracteres1": {
        "main": [
          [
            {
              "node": "HTTP Request6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [],
          [
            {
              "node": "Get row(s)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)1": {
        "main": [
          [
            {
              "node": "seNumeroExisteSegue",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "normalizaNumero": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "seNumeroExisteSegue": {
        "main": [
          [
            {
              "node": "DADOS USUÁRIO",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Text Classifier",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Ana?": {
        "main": [
          [
            {
              "node": "No Operation, do nothing1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "isGroup",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "excel?2": {
        "main": [
          [],
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Text Classifier",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RELATÓRIO CONTAS": {
        "main": [
          [
            {
              "node": "Copy file1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "TRANSFERENCIA PIX": {
        "main": [
          []
        ]
      },
      "Analyze image1": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call Faz OCR Arquivador": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "tem output?": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "OUTROS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call UNLOCK PASSWORD": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send a text message1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a text message": {
        "main": [
          [
            {
              "node": "Call UNLOCK PASSWORD",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call Faz OCR Arquivador1": {
        "main": [
          [
            {
              "node": "Upload file2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "BOT TESTE ARQUIVADOR": {
        "main": [
          [
            {
              "node": "Edit Fields2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Dados de Entrada1": {
        "main": [
          [
            {
              "node": "Get row(s)2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)2": {
        "main": [
          [
            {
              "node": "DADOS USUÁRIO1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DADOS USUÁRIO1": {
        "main": [
          [
            {
              "node": "tipoMsg1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "tipoMsg1": {
        "main": [
          [
            {
              "node": "Binario1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Binario2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Binario",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Binario": {
        "main": [
          [
            {
              "node": "Analyze image2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze image2": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File2": {
        "main": [
          [
            {
              "node": "Menos que 20 caracteres2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send a text message3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Menos que 20 caracteres2": {
        "main": [
          [
            {
              "node": "Gerar JWT",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call UNLOCK PASSWORD1": {
        "main": [
          [
            {
              "node": "Send a text message2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a text message3": {
        "main": [
          [
            {
              "node": "Call UNLOCK PASSWORD1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Binario1": {
        "main": [
          [
            {
              "node": "Extract from File2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload file": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "HTTP Request7": {
        "main": [
          [
            {
              "node": "Extract from File2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Binario2": {
        "main": [
          [
            {
              "node": "HTTP Request7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gerar JWT": {
        "main": [
          [
            {
              "node": "CriaTarefaOcr",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "CriaTarefaOcr": {
        "main": [
          [
            {
              "node": "UploadPdf",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "UploadPdf": {
        "main": [
          [
            {
              "node": "ProcessPdfToOcr",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ProcessPdfToOcr": {
        "main": [
          [
            {
              "node": "DownloadPdfOcr",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DownloadPdfOcr": {
        "main": [
          [
            {
              "node": "Upload file",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract from File3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File3": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a text message2": {
        "main": [
          [
            {
              "node": "Extract from File3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "AI Agent3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Text Classifier1": {
        "main": [
          [
            {
              "node": "AI Agent2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "NOTA FISCAL1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HOLERITES1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RECIBOS1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "COMPROVANTE PAGAMENTO1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "CHEQUES1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "TRANSFERENCIA PIX1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "PEDIDO COMPRA1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RELATÓRIO CONTAS1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "OUTROS1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent2": {
        "main": [
          [
            {
              "node": "tem output?1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "PEDIDO COMPRA1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HOLERITES1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RECIBOS1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "CHEQUES1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OUTROS1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "Structured Output Parser1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Split Out1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "NOTA FISCAL1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model7": {
        "ai_languageModel": [
          [
            {
              "node": "Text Classifier1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent3": {
        "main": [
          [
            {
              "node": "Text Classifier1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "RELATÓRIO CONTAS1": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "tem output?1": {
        "main": [
          [
            {
              "node": "Split Out1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "OUTROS1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model9": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Insert row": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "log arquivos1": {
        "main": [
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Cria Pasta Mes": {
        "main": [
          [
            {
              "node": "idPastaMes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Cria Pasta Ano": {
        "main": [
          [
            {
              "node": "idPastaAno",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Cria Pasta Dia": {
        "main": [
          [
            {
              "node": "idPastaDia",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "encontraControle": {
        "main": [
          [
            {
              "node": "encontraAno",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "encontraAno": {
        "main": [
          [
            {
              "node": "PastaDiaExiste?2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "PastaDiaExiste?2": {
        "main": [
          [
            {
              "node": "idPastaAno",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Cria Pasta Ano",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "encontraMês": {
        "main": [
          [
            {
              "node": "PastaDiaExiste?1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge4",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "PastaDiaExiste?1": {
        "main": [
          [
            {
              "node": "idPastaMes",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Merge4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "idPastaAno": {
        "main": [
          [
            {
              "node": "encontraMês",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "encontraControle",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "encontraDia": {
        "main": [
          [
            {
              "node": "PastaDiaExiste?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "PastaDiaExiste?": {
        "main": [
          [
            {
              "node": "idPastaDia",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Merge3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "idPastaMes": {
        "main": [
          [
            {
              "node": "encontraDia",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge3",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "idPastaDia": {
        "main": [
          [
            {
              "node": "Copy file2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Copy file2": {
        "main": [
          [
            {
              "node": "log arquivos1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge3": {
        "main": [
          [
            {
              "node": "Cria Pasta Dia",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge4": {
        "main": [
          [
            {
              "node": "Cria Pasta Mes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields2": {
        "main": [
          [
            {
              "node": "Dados de Entrada1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Kybernan Tech",
    "name": null,
    "description": null
  },
  "tags": []
}